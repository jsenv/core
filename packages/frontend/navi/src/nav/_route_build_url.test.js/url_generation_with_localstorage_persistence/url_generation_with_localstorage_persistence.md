# [url generation with localStorage persistence](../../route_build_url.test.js#L297)

```js
const localStorageMock = {
  storage: new Map(),
  getItem(key) {
    return this.storage.get(key) || null;
  },
  setItem(key, value) {
    this.storage.set(key, String(value));
  },
  removeItem(key) {
    this.storage.delete(key);
  },
  clear() {
    this.storage.clear();
  },
};
globalThis.window = {
  localStorage: localStorageMock,
};

try {
  localStorageMock.setItem("section_deepest", "analytics");
  localStorageMock.setItem("analytics_tab_deepest", "details");

  const sectionSignal = stateSignal("settings", {
    id: "section_deepest",
    persists: true,
    type: "string",
  });
  const analyticsTabSignal = stateSignal("overview", {
    id: "analytics_tab_deepest",
    persists: true,
    type: "string",
  });

  const { ROOT_ROUTE, ADMIN_ROUTE, ADMIN_ANALYTICS_ROUTE } = setupRoutes({
    ROOT_ROUTE: "/",
    ADMIN_ROUTE: `/admin/:section=${sectionSignal}/`,
    ADMIN_ANALYTICS_ROUTE: `/admin/analytics?tab=${analyticsTabSignal}`,
  });

  return {
    admin_route_url: ADMIN_ROUTE.buildUrl({}),
    analytics_route_url: ADMIN_ANALYTICS_ROUTE.buildUrl({}),
    root_route_url: ROOT_ROUTE.buildUrl({}),
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
  delete globalThis.window;
}
```

```js
{
  "admin_route_url": "http://127.0.0.1/admin/analytics?tab=details",
  "analytics_route_url": "http://127.0.0.1/admin/analytics?tab=details",
  "root_route_url": "http://127.0.0.1/admin/analytics?tab=details"
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
