# [parameter value update in URL should sync to signal values](../../route_url_sync.test.js)

```js
try {
  const zoneSignal = stateSignal("london");
  const lonSignal = stateSignal(3);
  const isochroneLongitudeSignal = stateSignal(2);
  const isochroneTimeModeSignal = stateSignal("walk");
  
  const { MAP_ISOCHRONE_TIME_ROUTE } = setupRoutes({
    MAP_ROUTE: `/map/?zone=${zoneSignal}&lon=${lonSignal}`,
    MAP_ISOCHRONE_ROUTE: `/map/isochrone/?iso_lon=${isochroneLongitudeSignal}`,
    MAP_ISOCHRONE_TIME_ROUTE: `/map/isochrone/time/:mode=${isochroneTimeModeSignal}/`,
  });

  // Set initial URL state: /map/isochrone/time?zone=london&lon=3&iso_lon=2
  updateRoutes(`${baseUrl}/map/isochrone/time?zone=london&lon=3&iso_lon=2`);

  // Capture initial state
  const initialState = {
    zone: zoneSignal.value,
    lon: lonSignal.value,
    iso_lon: isochroneLongitudeSignal.value,
    url: MAP_ISOCHRONE_TIME_ROUTE.buildUrl(),
    matching: MAP_ISOCHRONE_TIME_ROUTE.matching,
  };

  // Update URL to /map/isochrone/time?zone=longon&lon=3&iso_lon=2 (zone typo: london -> longon)
  updateRoutes(`${baseUrl}/map/isochrone/time?zone=longon&lon=3&iso_lon=2`);

  // Capture state after URL update
  const finalState = {
    zone: zoneSignal.value,
    lon: lonSignal.value,
    iso_lon: isochroneLongitudeSignal.value,
    url: MAP_ISOCHRONE_TIME_ROUTE.buildUrl(),
    matching: MAP_ISOCHRONE_TIME_ROUTE.matching,
  };

  return {
    initial_state: initialState,
    final_state: finalState,
    signal_updates: {
      zone_changed: initialState.zone !== finalState.zone,
      zone_old_value: initialState.zone,
      zone_new_value: finalState.zone,
      lon_changed: initialState.lon !== finalState.lon,
      iso_lon_changed: initialState.iso_lon !== finalState.iso_lon,
    },
    url_updates: {
      url_changed: initialState.url !== finalState.url,
      initial_url: initialState.url,
      final_url: finalState.url,
    },
    route_matching: {
      initially_matching: initialState.matching,
      finally_matching: finalState.matching,
      matching_changed: initialState.matching !== finalState.matching,
    },
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
}
```

```js
{
  "initial_state": {
    "zone": "london",
    "lon": "3",
    "iso_lon": "2",
    "url": "http://127.0.0.1/map/isochrone/time?lon=3&iso_lon=2",
    "matching": true
  },
  "final_state": {
    "zone": "longon",
    "lon": "3",
    "iso_lon": "2",
    "url": "http://127.0.0.1/map/isochrone/time?zone=longon&lon=3&iso_lon=2",
    "matching": true
  },
  "signal_updates": {
    "zone_changed": true,
    "zone_old_value": "london",
    "zone_new_value": "longon",
    "lon_changed": false,
    "iso_lon_changed": false
  },
  "url_updates": {
    "url_changed": true,
    "initial_url": "http://127.0.0.1/map/isochrone/time?lon=3&iso_lon=2",
    "final_url": "http://127.0.0.1/map/isochrone/time?zone=longon&lon=3&iso_lon=2"
  },
  "route_matching": {
    "initially_matching": true,
    "finally_matching": true,
    "matching_changed": false
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
