# [route.params with dynamic defaults](../../route_params.test.js)

```js
try {
  const zoneSignal = stateSignal(undefined);
  const mapLonSignal = stateSignal(zoneSignal, {
    default: -1, // static fallback
    type: "number",
  });

  const routes = setupRoutes({
    HOME_ROUTE: "/",
    MAP_ROUTE: `/map/?lon=${mapLonSignal}`,
  });

  // Test initial state (should use static default)
  updateRoutes("http://localhost:3000/map");
  
  const initialState = {
    zone_signal_value: zoneSignal.value,
    maplon_signal_value: mapLonSignal.value,
    route_params: routes.MAP_ROUTE.params,
    route_matching: routes.MAP_ROUTE.matching,
  };

  // Change dynamic default source
  zoneSignal.value = 5;
  
  const afterDynamicChange = {
    zone_signal_value: zoneSignal.value,
    maplon_signal_value: mapLonSignal.value,
    route_params: routes.MAP_ROUTE.params,
    route_matching: routes.MAP_ROUTE.matching,
  };

  // Test with explicit URL parameter that differs from dynamic default
  updateRoutes("http://localhost:3000/map?lon=10");
  
  const withUrlParam = {
    zone_signal_value: zoneSignal.value,
    maplon_signal_value: mapLonSignal.value,
    route_params: routes.MAP_ROUTE.params,
    route_matching: routes.MAP_ROUTE.matching,
  };

  // Remove URL parameter (should revert to dynamic default)
  updateRoutes("http://localhost:3000/map");
  
  const backToDynamic = {
    zone_signal_value: zoneSignal.value,
    maplon_signal_value: mapLonSignal.value,
    route_params: routes.MAP_ROUTE.params,
    route_matching: routes.MAP_ROUTE.matching,
  };

  return {
    initial_state_static_default: initialState,
    after_dynamic_default_change: afterDynamicChange,
    with_explicit_url_param: withUrlParam,
    back_to_dynamic_default: backToDynamic,
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
}
```

```js
{
  "initial_state_static_default": {
    "zone_signal_value": undefined,
    "maplon_signal_value": -1,
    "route_params": {
      "lon": -1
    },
    "route_matching": true
  },
  "after_dynamic_default_change": {
    "zone_signal_value": 5,
    "maplon_signal_value": 5,
    "route_params": {
      "lon": 5
    },
    "route_matching": true
  },
  "with_explicit_url_param": {
    "zone_signal_value": 5,
    "maplon_signal_value": 10,
    "route_params": {
      "lon": 10
    },
    "route_matching": true
  },
  "back_to_dynamic_default": {
    "zone_signal_value": 5,
    "maplon_signal_value": 5,
    "route_params": {
      "lon": 5
    },
    "route_matching": true
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
