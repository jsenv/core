# [route.params with multiple signals and dynamic defaults](../../route_params.test.js)

```js
try {
  const zoneSignal = stateSignal(undefined);
  const mapLonSignal = stateSignal(zoneSignal, {
    default: -1,
    type: "number",
  });
  const mapLatSignal = stateSignal(zoneSignal, {
    default: -2,
    type: "number",
  });

  const routes = setupRoutes({
    HOME_ROUTE: "/",
    MAP_ROUTE: `/map/?lon=${mapLonSignal}&lat=${mapLatSignal}`,
  });

  // Test initial state
  updateRoutes("http://localhost:3000/map");

  const initialState = {
    zone_signal: zoneSignal.value,
    lon_signal: mapLonSignal.value,
    lat_signal: mapLatSignal.value,
    route_params: routes.MAP_ROUTE.params,
  };

  // Change dynamic default source
  zoneSignal.value = 42;

  const afterDynamicChange = {
    zone_signal: zoneSignal.value,
    lon_signal: mapLonSignal.value,
    lat_signal: mapLatSignal.value,
    route_params: routes.MAP_ROUTE.params,
  };

  // Test with partial URL parameters
  updateRoutes("http://localhost:3000/map?lon=100");

  const withPartialUrl = {
    zone_signal: zoneSignal.value,
    lon_signal: mapLonSignal.value,
    lat_signal: mapLatSignal.value,
    route_params: routes.MAP_ROUTE.params,
  };

  // Test with full URL parameters
  updateRoutes("http://localhost:3000/map?lon=200&lat=300");

  const withFullUrl = {
    zone_signal: zoneSignal.value,
    lon_signal: mapLonSignal.value,
    lat_signal: mapLatSignal.value,
    route_params: routes.MAP_ROUTE.params,
  };

  return {
    initial_state: initialState,
    after_dynamic_change: afterDynamicChange,
    with_partial_url: withPartialUrl,
    with_full_url: withFullUrl,
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
}
```

```js
{
  "initial_state": {
    "zone_signal": undefined,
    "lon_signal": -1,
    "lat_signal": -2,
    "route_params": {
      "lon": -1,
      "lat": -2
    }
  },
  "after_dynamic_change": {
    "zone_signal": 42,
    "lon_signal": 42,
    "lat_signal": 42,
    "route_params": {
      "lon": 42,
      "lat": 42
    }
  },
  "with_partial_url": {
    "zone_signal": 42,
    "lon_signal": 100,
    "lat_signal": 42,
    "route_params": {
      "lon": 100,
      "lat": 42
    }
  },
  "with_full_url": {
    "zone_signal": 42,
    "lon_signal": 200,
    "lat_signal": 300,
    "route_params": {
      "lon": 200,
      "lat": 300
    }
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
