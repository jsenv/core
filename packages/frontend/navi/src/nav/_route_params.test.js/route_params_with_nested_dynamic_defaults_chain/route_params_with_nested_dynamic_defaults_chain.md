# [route.params with nested dynamic defaults chain](../../route_params.test.js)

```js
try {
  const rootSignal = stateSignal(undefined);
  const middleSignal = stateSignal(rootSignal, { default: "middle_default" });
  const leafSignal = stateSignal(middleSignal, { default: "leaf_default" });

  const routes = setupRoutes({
    HOME_ROUTE: "/",
    NESTED_ROUTE: `/nested/?root=${rootSignal}&middle=${middleSignal}&leaf=${leafSignal}`,
  });

  // Test initial state (all using static defaults)
  updateRoutes("http://localhost:3000/nested");
  
  const initialState = {
    root_signal: rootSignal.value,
    middle_signal: middleSignal.value,
    leaf_signal: leafSignal.value,
    route_params: routes.NESTED_ROUTE.params,
  };

  // Change root signal (should cascade)
  rootSignal.value = "root_changed";
  
  const afterRootChange = {
    root_signal: rootSignal.value,
    middle_signal: middleSignal.value,
    leaf_signal: leafSignal.value,
    route_params: routes.NESTED_ROUTE.params,
  };

  // Change middle signal (should affect only leaf)
  middleSignal.value = "middle_changed";
  
  const afterMiddleChange = {
    root_signal: rootSignal.value,
    middle_signal: middleSignal.value,
    leaf_signal: leafSignal.value,
    route_params: routes.NESTED_ROUTE.params,
  };

  // Test with URL parameters that override signals
  updateRoutes("http://localhost:3000/nested?root=url_root&middle=url_middle&leaf=url_leaf");
  
  const withUrlOverrides = {
    root_signal: rootSignal.value,
    middle_signal: middleSignal.value,
    leaf_signal: leafSignal.value,
    route_params: routes.NESTED_ROUTE.params,
  };

  return {
    initial_state: initialState,
    after_root_change: afterRootChange,
    after_middle_change: afterMiddleChange,
    with_url_overrides: withUrlOverrides,
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
}
```

```js
{
  "initial_state": {
    "root_signal": undefined,
    "middle_signal": "middle_default",
    "leaf_signal": "middle_default",
    "route_params": {
      "middle": "middle_default",
      "leaf": "middle_default"
    }
  },
  "after_root_change": {
    "root_signal": "root_changed",
    "middle_signal": "root_changed",
    "leaf_signal": "root_changed",
    "route_params": {
      "root": "root_changed",
      "middle": "root_changed",
      "leaf": "root_changed"
    }
  },
  "after_middle_change": {
    "root_signal": "root_changed",
    "middle_signal": "middle_changed",
    "leaf_signal": "middle_changed",
    "route_params": {
      "root": "root_changed",
      "middle": "middle_changed",
      "leaf": "middle_changed"
    }
  },
  "with_url_overrides": {
    "root_signal": "url_root",
    "middle_signal": "url_middle",
    "leaf_signal": "url_leaf",
    "route_params": {
      "root": "url_root",
      "middle": "url_middle",
      "leaf": "url_leaf"
    }
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
