# [buildUrlFromPatternWithSegmentFiltering](../../route_pattern.test.js#L309)

```js
const pattern = "/admin/settings/:tab";
const routePattern = createRoutePattern(pattern);

// Mock segment defaults and connections as would be created during inheritance
const segmentDefaults = new Map([
  [
    1,
    {
      paramName: "section",
      literalValue: "settings",
      signalDefault: "settings",
    },
  ],
]);

const connections = [
  {
    paramName: "section",
    options: { defaultValue: "settings" },
  },
];

// Case 1: With parameters provided - should NOT omit segments
const resultWithParams = buildUrlFromPatternWithSegmentFiltering(
  routePattern.pattern,
  { tab: "advanced" },
  new Map(),
  { segmentDefaults, connections },
);

// Case 2: Without parameters - should omit segments when all are defaults
const resultWithoutParams = buildUrlFromPatternWithSegmentFiltering(
  routePattern.pattern,
  {},
  new Map(),
  { segmentDefaults, connections },
);

return {
  pattern,
  case1_with_params: {
    params: { tab: "advanced" },
    result: resultWithParams,
    expected: "/admin/settings/advanced",
  },
  case2_without_params: {
    params: {},
    result: resultWithoutParams,
    expected: "/admin/:tab", // Should keep param placeholder but omit "settings" segment
  },
  segmentDefaults: Array.from(segmentDefaults.entries()),
  connections: connections.map((c) => ({
    paramName: c.paramName,
    defaultValue: c.options.defaultValue,
  })),
};
```

```js
{
  "pattern": "/admin/settings/:tab",
  "case1_with_params": {
    "params": {
      "tab": "advanced"
    },
    "result": "/admin/settings/advanced",
    "expected": "/admin/settings/advanced"
  },
  "case2_without_params": {
    "params": {},
    "result": "/admin/:tab",
    "expected": "/admin/:tab"
  },
  "segmentDefaults": [
    [
      1,
      {
        "paramName": "section",
        "literalValue": "settings",
        "signalDefault": "settings"
      }
    ]
  ],
  "connections": [
    {
      "paramName": "section",
      "defaultValue": "settings"
    }
  ]
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
