# [buildUrlFromPatternWithSegmentFiltering - no connection for segmentDefault parameter](../../route_pattern.test.js#L368)

```js
// This reproduces the specific issue where a segment should NOT be filtered
// when there's no connection for the parameter in the current route
const pattern = "/admin/analytics/";
const routePattern = createRoutePattern(pattern);

// segmentDefaults exists but connections only has "tab", not "section"
const segmentDefaults = new Map([
  [
    1,
    {
      paramName: "section",
      literalValue: "analytics",
      signalDefault: "analytics", // Even when they match, shouldn't omit without connection
    },
  ],
]);

const connections = [
  {
    paramName: "tab", // Note: different from segmentDefault paramName
    options: { defaultValue: "overview" },
  },
];

const result = buildUrlFromPatternWithSegmentFiltering(
  routePattern.pattern,
  {}, // No parameters provided
  new Map([["section", "analytics"]]),
  { segmentDefaults, connections },
);

return {
  pattern,
  segmentDefaults: Array.from(segmentDefaults.entries()),
  connections: connections.map((c) => ({
    paramName: c.paramName,
    defaultValue: c.options.defaultValue,
  })),
  result,
  expected: "/admin/analytics/", // Should NOT omit "analytics" since no connection for "section"
  issue:
    "segment should not be filtered when no connection exists for the parameter",
};
```

```js
{
  "pattern": "/admin/analytics/",
  "segmentDefaults": [
    [
      1,
      {
        "paramName": "section",
        "literalValue": "analytics",
        "signalDefault": "analytics"
      }
    ]
  ],
  "connections": [
    {
      "paramName": "tab",
      "defaultValue": "overview"
    }
  ],
  "result": "/admin/analytics",
  "expected": "/admin/analytics/",
  "issue": "segment should not be filtered when no connection exists for the parameter"
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
