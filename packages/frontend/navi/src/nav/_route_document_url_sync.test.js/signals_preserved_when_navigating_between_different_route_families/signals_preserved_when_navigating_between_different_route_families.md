# [signals preserved when navigating between different route families](../../route_document_url_sync.test.js)

```js
try {
  const zoneSignal = stateSignal("foo", {
    id: "zone",
    type: "string",
  });

  // Create routes from different families with query parameter
  const { HOME_ROUTE, MAP_ROUTE } = setupRoutes({
    HOME_ROUTE: `/`, // Root page
    MAP_ROUTE: `/map?zone=${zoneSignal}`, // Map page with zone query parameter
  });

  // Start on the map route with a zone value: /map?zone=foo
  updateRoutes(`${baseUrl}/map?zone=foo`);

  const scenario1 = {
    description: "Initial state on /map?zone=foo",
    zone_signal: zoneSignal.value,
    home_route_matches: HOME_ROUTE.matching,
    map_route_matches: MAP_ROUTE.matching,
    current_url: globalThis.location?.href || "not available",
  };

  // Navigate to home page (root - different route family)
  updateRoutes(`${baseUrl}/`);

  const scenario2 = {
    description: "After navigating to root /",
    zone_signal: zoneSignal.value,
    home_route_matches: HOME_ROUTE.matching,
    map_route_matches: MAP_ROUTE.matching,
    current_url: globalThis.location?.href || "not available",
  };

  // Navigate back to map route to verify signal can be used
  updateRoutes(`${baseUrl}/map?zone=bar`);

  const scenario3 = {
    description: "Navigate back to /map with new zone value",
    zone_signal: zoneSignal.value,
    home_route_matches: HOME_ROUTE.matching,
    map_route_matches: MAP_ROUTE.matching,
    current_url: globalThis.location?.href || "not available",
  };

  return {
    scenario1_initial_map_route: scenario1,
    scenario2_navigate_to_home_root: scenario2,
    scenario3_back_to_map_with_new_value: scenario3,

    // Key test: signal should be preserved when moving between different route families
    // This is different from parent-child navigation where signals are cleared
    signal_preserved_across_families: scenario2.zone_signal === "foo", // Should still be "foo" from initial visit
    signal_updates_on_return: scenario3.zone_signal === "bar", // Should update to new value

    // Route matching verification
    routes_match_correctly: [
      scenario1.map_route_matches, // true - on /map?zone=foo
      scenario2.home_route_matches, // true - on /
      scenario3.map_route_matches, // true - on /map?zone=bar
    ],

    // Explanation of behavior:
    explanation: {
      why_preserved:
        "/ (root) and /map are different route families (different trees)",
      why_different_from_parent_child:
        "Unlike /map -> /map/isochrone (parent-child), /map -> / are separate trees",
      user_benefit:
        "Preserves map zone preference when user navigates to home and back",
      query_param_note:
        "Zone is now a query parameter (?zone=foo) instead of path parameter",
    },
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
}
```

```js
{
  "scenario1_initial_map_route": {
    "description": "Initial state on /map?zone=foo",
    "zone_signal": "foo",
    "home_route_matches": false,
    "map_route_matches": true,
    "current_url": "not available"
  },
  "scenario2_navigate_to_home_root": {
    "description": "After navigating to root /",
    "zone_signal": "foo",
    "home_route_matches": true,
    "map_route_matches": false,
    "current_url": "not available"
  },
  "scenario3_back_to_map_with_new_value": {
    "description": "Navigate back to /map with new zone value",
    "zone_signal": "bar",
    "home_route_matches": false,
    "map_route_matches": true,
    "current_url": "not available"
  },
  "signal_preserved_across_families": true,
  "signal_updates_on_return": true,
  "routes_match_correctly": [
    true,
    true,
    true
  ],
  "explanation": {
    "why_preserved": "/ (root) and /map are different route families (different trees)",
    "why_different_from_parent_child": "Unlike /map -> /map/isochrone (parent-child), /map -> / are separate trees",
    "user_benefit": "Preserves map zone preference when user navigates to home and back",
    "query_param_note": "Zone is now a query parameter (?zone=foo) instead of path parameter"
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
