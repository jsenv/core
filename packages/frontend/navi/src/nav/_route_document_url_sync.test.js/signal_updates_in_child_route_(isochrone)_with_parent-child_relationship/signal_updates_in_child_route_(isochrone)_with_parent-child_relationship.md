# [signal updates in child route (isochrone) with parent-child relationship](../../route_document_url_sync.test.js)

```js
// Mock browserIntegration.navTo to track redirectTo calls
const navToCalls = [];
const mockBrowserIntegration = {
  navTo: (url, options) => {
    navToCalls.push({ url, options });
  },
};
setBrowserIntegration(mockBrowserIntegration);

try {
  const walkEnabledSignal = stateSignal(false);
  const walkMinuteSignal = stateSignal(30);
  const zoneSignal = stateSignal("paris");
  const isochroneTabSignal = stateSignal("compare");
  const isochroneLongitudeSignal = stateSignal(2.3522);
  const mapPanelSignal = stateSignal(undefined);
  mapPanelSignal.value = "isochrone";
  isochroneLongitudeSignal.value = 10;
  zoneSignal.value = "nice";
  const { ISOCHRONE_COMPARE_ROUTE } = setupRoutes({
    HOME_ROUTE: "/",
    MAP_ROUTE: `/map/?zone=${zoneSignal}`,
    MAP_PANEL_ROUTE: `/map/:panel=${mapPanelSignal}/`,
    ISOCHRONE_ROUTE: `/map/isochrone/:tab=${isochroneTabSignal}/?iso_lon=${isochroneLongitudeSignal}`,
    ISOCHRONE_COMPARE_ROUTE: `/map/isochrone/compare?walk=${walkEnabledSignal}&walk_minute=${walkMinuteSignal}`,
    MAP_ISOCHRONE_TIME_ROUTE: "/map/isochrone/time/",
    MAP_ISOCHRONE_TIME_WALK_ROUTE: "/map/isochrone/time/walk",
  });
  updateRoutes(`${baseUrl}/map/isochrone/compare?zone=nice&iso_lon=10`);

  const scenario1 = {
    enabled_signal: walkEnabledSignal.value,
    minute_signal: walkMinuteSignal.value,
    current_url: ISOCHRONE_COMPARE_ROUTE.url,
  };

  // Clear redirect history before testing signal updates
  navToCalls.length = 0;
  // Update enabled signal to true (non-default)
  walkEnabledSignal.value = true;
  const scenario2 = {
    enabled_signal: walkEnabledSignal.value,
    current_url: ISOCHRONE_COMPARE_ROUTE.url,
    redirects_count: navToCalls.length,
  };

  // Clear redirect history
  navToCalls.length = 0;
  // Update minute signal
  walkMinuteSignal.value = 45;
  const scenario3 = {
    minute_signal: walkMinuteSignal.value,
    current_url: ISOCHRONE_COMPARE_ROUTE.url,
    redirects_count: navToCalls.length,
  };

  // Clear redirect history
  navToCalls.length = 0;
  // Update enabled back to false (default)
  walkEnabledSignal.value = false;
  const scenario4 = {
    enabled_signal: walkEnabledSignal.value,
    current_url: ISOCHRONE_COMPARE_ROUTE.url,
    redirects_count: navToCalls.length,
  };

  // Clear redirect history
  navToCalls.length = 0;
  // Update minute signal again
  walkMinuteSignal.value = 60;
  const scenario5 = {
    minute_signal: walkMinuteSignal.value,
    current_url: ISOCHRONE_COMPARE_ROUTE.url,
    redirects_count: navToCalls.length,
  };

  return {
    scenario1_initial: scenario1,
    scenario2_enabled_true: scenario2,
    scenario3_minute_45: scenario3,
    scenario4_enabled_false: scenario4,
    scenario5_minute_60: scenario5,
  };
} finally {
  setBrowserIntegration(undefined);
  clearAllRoutes();
  globalSignalRegistry.clear();
}
```

```js
{
  "scenario1_initial": {
    "enabled_signal": false,
    "minute_signal": 30,
    "current_url": "http://127.0.0.1/map/isochrone?zone=nice&iso_lon=10"
  },
  "scenario2_enabled_true": {
    "enabled_signal": true,
    "current_url": "http://127.0.0.1/map/isochrone?zone=nice&iso_lon=10&walk",
    "redirects_count": 1
  },
  "scenario3_minute_45": {
    "minute_signal": 45,
    "current_url": "http://127.0.0.1/map/isochrone?zone=nice&iso_lon=10&walk&walk_minute=45",
    "redirects_count": 2
  },
  "scenario4_enabled_false": {
    "enabled_signal": false,
    "current_url": "http://127.0.0.1/map/isochrone?zone=nice&iso_lon=10&walk_minute=45",
    "redirects_count": 1
  },
  "scenario5_minute_60": {
    "minute_signal": 60,
    "current_url": "http://127.0.0.1/map/isochrone?zone=nice&iso_lon=10&walk_minute=60",
    "redirects_count": 1
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
