# [dynamic array default - user arrives with URL before backend loads](../../route_document_url_sync.test.js)

```js
const navToCalls = [];

setRouteIntegration({
  navTo: (url) => {
    navToCalls.push(url);
    updateRoutes(url);
    return Promise.resolve();
  },
});

try {
  // Simulate available tramway lines from backend (dynamic) - starts empty
  const tramAvailableLines = stateSignal([], {
    type: "array",
  });
  // User-enabled tramway lines - defaults to all available lines
  const tramEnabledLines = stateSignal(tramAvailableLines, {
    type: "array",
  });
  // Master tramway visibility toggle
  const tramVisible = stateSignal(false, {
    type: "boolean",
  });
  setupRoutes({
    TRAM_ROUTE: `/map?tram=${tramVisible}&trams=${tramEnabledLines}`,
  });

  const captureState = () => {
    const navCalls = [...navToCalls];
    navToCalls.length = 0;
    return {
      available_lines: JSON.parse(JSON.stringify(tramAvailableLines.value)),
      enabled_lines: JSON.parse(JSON.stringify(tramEnabledLines.value)),
      tram_signal_visible: tramVisible.value,
      nav_calls: navCalls,
    };
  };

  const results = {};

  // Step 1: User arrives with URL containing specific tram selection (before backend loads)
  updateRoutes(`${baseUrl}/map?tram=true&trams=a,c`);
  results["1_user_arrives_with_url_before_backend"] = captureState();

  // Step 2: Backend eventually loads available tramway lines
  tramAvailableLines.value = ["a", "b", "c", "d"];
  results["2_backend_loads_available_lines_after_user"] = captureState();

  return results;
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
  setRouteIntegration(null);
}
```

```js
{
  "1_user_arrives_with_url_before_backend": {
    "available_lines": [],
    "enabled_lines": [
      "a",
      "c"
    ],
    "tram_signal_visible": true,
    "nav_calls": []
  },
  "2_backend_loads_available_lines_after_user": {
    "available_lines": [
      "a",
      "b",
      "c",
      "d"
    ],
    "enabled_lines": [
      "a",
      "c"
    ],
    "tram_signal_visible": true,
    "nav_calls": []
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
