# [updating signals keep url in sync](../../route_document_url_sync.test.js)

```js
// Mock browser integration to capture navigation calls
let navToCalls = [];
setRouteIntegration({
  navTo: (url) => {
    navToCalls.push(url);
    updateRoutes(url);
    return Promise.resolve();
  },
});

try {
  const categorySignal = stateSignal("electronics");
  const { CATEGORY_ROUTE } = setupRoutes({
    CATEGORY_ROUTE: `/products?category=${categorySignal}`,
  });
  // Navigate to initial URL - this should set signal to "electronics"
  updateRoutes(`${baseUrl}/products?category=electronics`);
  // Clear navigation calls from initial setup
  navToCalls = [];

  // TEST: Signal update should trigger navigation and update route params
  // Without circular dependency fix, route params would be stale
  categorySignal.value = "books";

  return {
    initialSignalValue: "electronics", // After URL parsing
    finalSignalValue: categorySignal.value, // After programmatic update
    navToCallsCount: navToCalls.length, // Should be 1 (Signal->URL only)
    navToCalls,
    routeMatching: CATEGORY_ROUTE.matching,
    routeParams: CATEGORY_ROUTE.params,
  };
} finally {
  clearAllRoutes();
  globalSignalRegistry.clear();
  setRouteIntegration(undefined);
}
```

```js
{
  "initialSignalValue": "electronics",
  "finalSignalValue": "books",
  "navToCallsCount": 1,
  "navToCalls": [
    "http://127.0.0.1/products?category=books"
  ],
  "routeMatching": true,
  "routeParams": {
    "category": "books"
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
