<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Text Auto-Spacing Demo</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" jsenv-type="module/jsx">
      import { render } from "preact";
      /* eslint-disable no-unused-vars */
      import { Text, Icon, Link } from "@jsenv/navi";

      const StarSvg = () => (
        <svg
          viewBox="0 0 24 24"
          width="100%"
          height="100%"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
            fill="currentColor"
          />
        </svg>
      );

      const Demo = () => {
        return (
          <div
            style={{
              padding: "20px",
              fontFamily: "system-ui, sans-serif",
            }}
          >
            <h1>Text Auto-Spacing Demo</h1>
            <p>
              Text components automatically add spacing between children by
              default. This eliminates verbose manual spacing with {`{" "}`}{" "}
              everywhere.
            </p>

            {/* Table of Contents */}
            <section
              style={{
                marginBottom: "30px",
                padding: "15px",
                backgroundColor: "#f8f9fa",
                borderRadius: "6px",
                border: "1px solid #e9ecef",
              }}
            >
              <h2 style={{ margin: "0 0 15px 0", fontSize: "1.2rem" }}>
                üìã Table of Contents
              </h2>
              <nav>
                <ol
                  style={{
                    margin: 0,
                    paddingLeft: "20px",
                    lineHeight: "1.6",
                  }}
                >
                  <li>
                    <Link href="#auto-spacing" textColor="#007bff">
                      Auto-Spacing by Default
                    </Link>
                  </li>
                  <li>
                    <Link href="#custom-separators" textColor="#007bff">
                      Custom Separators
                    </Link>
                  </li>
                  <li>
                    <Link href="#exact-control" textColor="#007bff">
                      When You Need Exact Control
                    </Link>
                  </li>
                  <li>
                    <Link href="#underline-gotcha" textColor="#007bff">
                      Underline + Auto-Spacing Gotcha
                    </Link>
                  </li>
                  <li>
                    <Link href="#multiline-behavior" textColor="#007bff">
                      Multiline Behavior Testing
                    </Link>
                  </li>
                </ol>
              </nav>
            </section>

            {/* Default behavior showcase */}
            <section id="auto-spacing" style={{ marginBottom: "30px" }}>
              <h2>üéâ Auto-Spacing by Default</h2>
              <p>
                Most of the time, you want spaces between elements -
                auto-spacing saves you from verbose manual spacing:
              </p>
              <div
                style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
              >
                <div>
                  <h3>Manual spacing (verbose)</h3>
                  <div
                    style={{
                      border: "1px solid #ccc",
                      padding: "8px",
                      backgroundColor: "#f9f9f9",
                    }}
                  >
                    <Text contentSpacing="pre">
                      <strong>Hello</strong> <em>beautiful</em>{" "}
                      <span>world!</span>
                    </Text>
                  </div>
                  <small style={{ color: "#666" }}>
                    Required manual {`{" "}`} everywhere
                  </small>
                </div>

                <div>
                  <h3>Automatic spacing (pleasant and automatic)</h3>
                  <div
                    style={{
                      border: "1px solid #ccc",
                      padding: "8px",
                      backgroundColor: "#e8f5e8",
                    }}
                  >
                    <Text>
                      <strong>Hello</strong>
                      <em>beautiful</em>
                      <span>world!</span>
                    </Text>
                  </div>
                  <small style={{ color: "#666" }}>
                    Clean JSX, automatic spacing!
                  </small>
                </div>
              </div>
            </section>

            {/* Custom separators */}
            <section id="custom-separators" style={{ marginBottom: "30px" }}>
              <h2>üé® Custom Separators</h2>

              <div style={{ marginBottom: "20px" }}>
                <h3>Breadcrumb Navigation</h3>
                <div style={{ border: "1px solid #ccc", padding: "8px" }}>
                  <Text contentSpacing={<span> / </span>} textColor="#666">
                    <Text as="a" href="#" textColor="blue">
                      Products
                    </Text>
                    <Text as="a" href="#" textColor="blue">
                      Electronics
                    </Text>
                    <Text as="a" href="#" textColor="blue">
                      Smartphones
                    </Text>
                    <Text textBold textColor="black">
                      iPhone 15
                    </Text>
                  </Text>
                </div>
                <small style={{ color: "#666" }}>contentSpacing=" / "</small>
              </div>

              <div style={{ marginBottom: "20px" }}>
                <h3>Status Dashboard</h3>
                <div style={{ border: "1px solid #ccc", padding: "8px" }}>
                  <Text contentSpacing=" ‚Ä¢ ">
                    <span>
                      Status:{" "}
                      <Text textBold textColor="green">
                        ‚úì Online
                      </Text>
                    </span>
                    <span>
                      Users:{" "}
                      <Text textBold textColor="blue">
                        1,234
                      </Text>
                    </span>
                    <span>
                      Updated: <Text textColor="#666">2 min ago</Text>
                    </span>
                  </Text>
                </div>
                <small style={{ color: "#666" }}>contentSpacing=" ‚Ä¢ "</small>
              </div>

              <div style={{ marginBottom: "20px" }}>
                <h3>Tag List</h3>
                <div style={{ border: "1px solid #ccc", padding: "8px" }}>
                  <Text contentSpacing=", ">
                    <span
                      style={{
                        backgroundColor: "#e1f5fe",
                        padding: "2px 6px",
                        borderRadius: "3px",
                      }}
                    >
                      React
                    </span>
                    <span
                      style={{
                        backgroundColor: "#e8f5e8",
                        padding: "2px 6px",
                        borderRadius: "3px",
                      }}
                    >
                      JavaScript
                    </span>
                    <span
                      style={{
                        backgroundColor: "#fff3e0",
                        padding: "2px 6px",
                        borderRadius: "3px",
                      }}
                    >
                      CSS
                    </span>
                  </Text>
                </div>
                <small style={{ color: "#666" }}>contentSpacing=", "</small>
              </div>
            </section>

            {/* When you need exact control */}
            <section id="exact-control" style={{ marginBottom: "30px" }}>
              <h2>üîß When You Need Exact Control (contentSpacing="pre")</h2>
              <p>
                Sometimes you need exact control over spacing - here's when to
                use contentSpacing="pre":
              </p>

              <div style={{ marginBottom: "20px" }}>
                <h3>‚ú® Styling Parts of a Word</h3>
                <p>
                  When styling different parts of a word, you want them to stick
                  together:
                </p>
                <div
                  style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
                >
                  <div>
                    <h4>‚ùå Default (unwanted spaces)</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#fee",
                      }}
                    >
                      <Text>
                        <span style={{ color: "blue" }}>Java</span>
                        <span style={{ color: "orange", fontWeight: "bold" }}>
                          Script
                        </span>
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Result: "Java Script" (unwanted space!)
                    </small>
                  </div>

                  <div>
                    <h4>‚úÖ contentSpacing="pre"</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#efe",
                      }}
                    >
                      <Text contentSpacing="pre">
                        <span style={{ color: "blue" }}>Java</span>
                        <span style={{ color: "orange", fontWeight: "bold" }}>
                          Script
                        </span>
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Result: "JavaScript" (perfect!)
                    </small>
                  </div>
                </div>
              </div>

              <div style={{ marginBottom: "20px" }}>
                <h3>üí∞ Price Display</h3>
                <p>
                  When different parts of content need to be in separate
                  elements but should display without gaps:
                </p>
                <div
                  style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
                >
                  <div>
                    <h4>‚ùå Default (unwanted spaces)</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#fee",
                      }}
                    >
                      <Text>
                        <span>Price:</span>
                        <strong style={{ color: "green" }}>$</strong>
                        <span style={{ fontSize: "1.2em" }}>29</span>
                        <span style={{ fontSize: "0.8em" }}>.99</span>
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Result: "Price: $ 29 .99" (broken formatting)
                    </small>
                  </div>

                  <div>
                    <h4>‚úÖ contentSpacing="pre"</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#efe",
                      }}
                    >
                      <Text contentSpacing="pre">
                        <span>Price: </span>
                        <strong style={{ color: "green" }}>$</strong>
                        <span style={{ fontSize: "1.2em" }}>29</span>
                        <span style={{ fontSize: "0.8em" }}>.99</span>
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Result: "Price: $29.99" (clean formatting)
                    </small>
                  </div>
                </div>
              </div>
            </section>

            {/* Best practices with underline and auto-spacing */}
            <section id="underline-gotcha" style={{ marginBottom: "30px" }}>
              <h2>‚ö†Ô∏è Underline + Auto-Spacing Gotcha</h2>
              <p>
                When using <code>textUnderline</code> on a Text container, any
                spacing (auto-inserted or manually put) between text and icon
                will be underlined which might be undesired. Move the underline
                to the specific text element instead.
              </p>
              <div
                style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
              >
                <div style={{ flex: 1 }}>
                  <h3>‚ùå Underline on container</h3>
                  <div
                    style={{
                      border: "1px solid #ccc",
                      padding: "8px",
                      backgroundColor: "#fee",
                    }}
                  >
                    <Text noWrap textUnderline>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      star
                    </Text>
                  </div>
                  <small style={{ color: "#666" }}>
                    Space between icon and text is also underlined
                  </small>
                </div>
                <div style={{ flex: 1 }}>
                  <h3>‚úÖ Underline only the text</h3>
                  <div
                    style={{
                      border: "1px solid #ccc",
                      padding: "8px",
                      backgroundColor: "#efe",
                    }}
                  >
                    <Text noWrap>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Text textUnderline>star</Text>
                    </Text>
                  </div>
                  <small style={{ color: "#666" }}>
                    Clean underline, spacing stays normal
                  </small>
                </div>
              </div>

              <pre
                style={{
                  background: "#f7f7f7",
                  padding: "10px",
                  borderRadius: "4px",
                  fontSize: "12px",
                  overflowX: "auto",
                  marginBottom: "20px",
                }}
              >
                {`// Bad - Icon + Text underline\n<Text noWrap textUnderline>\n  <Icon><StarSvg /></Icon>\n  star\n</Text>\n\n// Good - Only text underlined\n<Text noWrap>\n  <Icon><StarSvg /></Icon>\n  <Text textUnderline>star</Text>\n</Text>`}
              </pre>

              <h3>Links with Icons</h3>
              <p>
                The same principle applies to Links containing icons. Disable
                underline on the Link and add it back on the text:
              </p>
              <div
                style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
              >
                <div style={{ flex: 1 }}>
                  <h4>‚ùå Underline on Link with icon</h4>
                  <div
                    style={{
                      border: "1px solid #ccc",
                      padding: "8px",
                      backgroundColor: "#fee",
                    }}
                  >
                    <Link href="./user-profile">
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Text>Go to profile</Text>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Icon>
                        <StarSvg />
                      </Icon>
                    </Link>
                  </div>
                  <small style={{ color: "#666" }}>
                    Spaces between icons and text gets underlined
                  </small>
                </div>
                <div style={{ flex: 1 }}>
                  <h4>‚úÖ Disable Link underline, add it to text</h4>
                  <div
                    style={{
                      border: "1px solid #ccc",
                      padding: "8px",
                      backgroundColor: "#efe",
                    }}
                  >
                    <Link href="./user-profile" textUnderline={false}>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Text textUnderline>Go to profile</Text>
                      <Icon>
                        <StarSvg />
                      </Icon>
                      <Icon>
                        <StarSvg />
                      </Icon>
                    </Link>
                  </div>
                  <small style={{ color: "#666" }}>
                    Clean underline, icon stays normal
                  </small>
                </div>
              </div>

              <pre
                style={{
                  background: "#f7f7f7",
                  padding: "10px",
                  borderRadius: "4px",
                  fontSize: "12px",
                  overflowX: "auto",
                }}
              >
                {`// Bad - Link with icon, underline on everything\n<Link href="./user-profile">\n  <Icon><StarSvg /></Icon>\n  <Icon><StarSvg /></Icon>\n  <Text>Go to profile</Text>\n  <Icon><StarSvg /></Icon>\n  <Icon><StarSvg /></Icon>\n</Link>\n\n// Good - Disable Link underline, add to text only\n<Link href="./user-profile" textUnderline={false}>\n  <Icon><StarSvg /></Icon>\n  <Icon><StarSvg /></Icon>\n  <Text textUnderline>Go to profile</Text>\n  <Icon><StarSvg /></Icon>\n  <Icon><StarSvg /></Icon>\n</Link>`}
              </pre>
            </section>

            {/* Multiline behavior testing */}
            <section id="multiline-behavior" style={{ marginBottom: "30px" }}>
              <h2>üîÑ Multiline Behavior Testing</h2>
              <p>
                Testing how auto-spacing behaves when children array contains
                strings with whitespace. The fix should prevent adding spaces
                when children start/end with whitespace.
              </p>

              <div style={{ marginBottom: "20px" }}>
                <h3>
                  Case 1: Child ending with newline + child starting normal
                </h3>
                <div
                  style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
                >
                  <div style={{ flex: 1 }}>
                    <h4>Default auto-spacing (fixed)</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#e8f5e8",
                      }}
                    >
                      <Text preWrap>
                        First line.{"\n"}
                        Second line.
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      No space added between children (first ends with \n)
                    </small>
                  </div>
                  <div style={{ flex: 1 }}>
                    <h4>Manual control</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#f0f0f0",
                      }}
                    >
                      <Text preWrap contentSpacing="pre">
                        First line.{"\n"}
                        Second line.
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Expected result (no auto spacing)
                    </small>
                  </div>
                </div>
              </div>

              <div style={{ marginBottom: "20px" }}>
                <h3>Case 2: Child ending normal + child starting with space</h3>
                <div
                  style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
                >
                  <div style={{ flex: 1 }}>
                    <h4>Default auto-spacing (fixed)</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#e8f5e8",
                      }}
                    >
                      <Text preWrap>
                        {"Hello"}
                        {" world!"}
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      No space added (second child starts with space)
                    </small>
                  </div>
                  <div style={{ flex: 1 }}>
                    <h4>Manual control</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#f0f0f0",
                      }}
                    >
                      <Text preWrap contentSpacing="pre">
                        {"Hello"}
                        {" world!"}
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>Expected result</small>
                  </div>
                </div>
              </div>

              <div style={{ marginBottom: "20px" }}>
                <h3>
                  Case 3: Complex mixed children with whitespace boundaries
                </h3>
                <div
                  style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
                >
                  <div style={{ flex: 1 }}>
                    <h4>Default auto-spacing (fixed)</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#e8f5e8",
                      }}
                    >
                      <Text preWrap>
                        <strong>Title:</strong>
                        {"\n"}
                        {"Paragraph one here."}
                        {"\n\n"}
                        <em>Paragraph two</em>
                        {" continues here."}
                        {"\n"}
                        {"Final line."}
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Spaces only added where needed (not around \n)
                    </small>
                  </div>
                  <div style={{ flex: 1 }}>
                    <h4>Manual control</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#f0f0f0",
                      }}
                    >
                      <Text preWrap contentSpacing="pre">
                        <strong>Title:</strong>
                        {"\n"}
                        {"Paragraph one here."}
                        {"\n\n"}
                        <em>Paragraph two</em>
                        {" continues here."}
                        {"\n"}
                        {"Final line."}
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>Expected result</small>
                  </div>
                </div>
              </div>

              <div style={{ marginBottom: "20px" }}>
                <h3>Case 4: Normal children (should still get auto-spacing)</h3>
                <div
                  style={{ display: "flex", gap: "20px", marginBottom: "20px" }}
                >
                  <div style={{ flex: 1 }}>
                    <h4>Default auto-spacing (should work)</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#e8f5e8",
                      }}
                    >
                      <Text preWrap>
                        <strong>Bold</strong>
                        {"normal"}
                        <em>italic</em>
                        {"end"}
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Normal spacing should be added between all children
                    </small>
                  </div>
                  <div style={{ flex: 1 }}>
                    <h4>Manual spacing</h4>
                    <div
                      style={{
                        border: "1px solid #ccc",
                        padding: "8px",
                        backgroundColor: "#f0f0f0",
                      }}
                    >
                      <Text preWrap contentSpacing="pre">
                        <strong>Bold</strong>
                        {" normal "}
                        <em>italic</em>
                        {" end"}
                      </Text>
                    </div>
                    <small style={{ color: "#666" }}>
                      Manual spaces for comparison
                    </small>
                  </div>
                </div>
              </div>

              <p
                style={{ color: "#666", fontSize: "14px", fontStyle: "italic" }}
              >
                <strong>Fix explanation:</strong> The
                applyContentSpacingOnTextChildren function now checks if
                adjacent children start/end with whitespace characters (space,
                newline, tab, etc.) and skips adding contentSpacing in those
                cases, while preserving normal auto-spacing for regular content.
              </p>
            </section>
          </div>
        );
      };

      render(<Demo />, document.getElementById("app"));
    </script>
  </body>
</html>
