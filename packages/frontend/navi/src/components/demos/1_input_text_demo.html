<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="data:," />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Input text demo</title>
  </head>
  <body>
    <div id="root" style="position: relative"></div>

    <script type="module" jsenv-type="module/jsx">
      import { render } from "preact";
      import {
        // eslint-disable-next-line no-unused-vars
        Input,
        // eslint-disable-next-line no-unused-vars
        Form,
        createAction,
      } from "@jsenv/navi";

      const sharedAction = createAction(async () => {
        await new Promise((resolve) => {
          setTimeout(resolve, 2000);
        });
      });

      // eslint-disable-next-line no-unused-vars
      const App = () => {
        return (
          <>
            <div style="display: flex; flex-direction: row; gap: 30px">
              <div>
                <p>
                  <strong>Outside form</strong>
                </p>
                <OutsideForm />
              </div>

              <div>
                <p>
                  <strong>Outside form with initial value</strong>
                </p>
                <OutsideFormWithInitialValue />
              </div>

              <div>
                <p>
                  <strong>Outside form using action</strong>
                </p>
                <OutsideFormUsingAction />
              </div>
            </div>
            <div style="display: flex; flex-direction: row; gap: 30px">
              <div>
                <p>
                  <strong>Inside form</strong>
                </p>
                <InsideForm />
              </div>
              <div>
                <p>
                  <strong>Inside form with submit and reset</strong>
                </p>
                <InsideFormWithSubmitAndReset />
              </div>
            </div>
            <div style="display: flex; flex-direction: row; gap: 30px">
              <div>
                <p>
                  <strong>2 input for the same action</strong>
                </p>
                <Input
                  action={sharedAction}
                  label="Test"
                  style="color: blue"
                  requestExecuteOnChange
                ></Input>
                <Input
                  action={sharedAction}
                  label="Test"
                  style="color: blue"
                  requestExecuteOnChange
                ></Input>
              </div>
            </div>
          </>
        );
      };

      // eslint-disable-next-line no-unused-vars
      const OutsideForm = () => {
        return (
          <div>
            <div>
              <Input
                id="outside_form"
                requestExecuteOnChange
                action={async (value) => {
                  await new Promise((resolve) => setTimeout(resolve, 1_000));
                  throw new Error(`test: ${value}`);
                }}
              />
            </div>
          </div>
        );
      };

      // eslint-disable-next-line no-unused-vars
      const OutsideFormWithInitialValue = () => {
        return (
          <div>
            <div>
              <Input
                requestExecuteOnChange
                value="initial"
                action={async (value) => {
                  await new Promise((resolve) => setTimeout(resolve, 1_000));
                  throw new Error(`test: ${value}`);
                }}
              />
            </div>
          </div>
        );
      };

      const actionA = createAction(async (value) => {
        await new Promise((resolve) => setTimeout(resolve, 1_000));
        throw new Error(`test: ${value}`);
      });
      // eslint-disable-next-line no-unused-vars
      const OutsideFormUsingAction = () => {
        return (
          <div>
            <div>
              <Input requestExecuteOnChange action={actionA} />
            </div>
          </div>
        );
      };

      // eslint-disable-next-line no-unused-vars
      const InsideForm = () => {
        return (
          <div>
            <Form>
              <Input
                requestExecuteOnChange
                action={async (value) => {
                  await new Promise((resolve) => setTimeout(resolve, 1_500));
                  throw new Error(`test: ${value}`);
                }}
              />
            </Form>
          </div>
        );
      };

      // eslint-disable-next-line no-unused-vars
      const InsideFormWithSubmitAndReset = () => {
        return (
          <div>
            <Form>
              <Input
                id="tototo"
                action={async (value) => {
                  await new Promise((resolve) => setTimeout(resolve, 1_500));
                  throw new Error(`test: ${value}`);
                }}
              />
              <button type="submit">Submit</button>
              <button type="reset">Reset</button>
            </Form>
          </div>
        );
      };

      render(<App />, document.querySelector("#root"));
    </script>
  </body>
</html>
