<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="data:," />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Input text demo</title>
  </head>
  <body>
    <div id="root" style="position: relative"></div>

    <script type="module" jsenv-type="module/jsx">
      import { render } from "preact";
      import {
        // eslint-disable-next-line no-unused-vars
        Input,
        // eslint-disable-next-line no-unused-vars
        Form,
        createAction,
      } from "@jsenv/navi";

      const sharedAction = createAction(async ({ greeting, name }) => {
        await new Promise((resolve) => {
          setTimeout(resolve, 2000);
        });
        throw new Error(`${greeting} ${name}`);
      }).bindParams({ greeting: "hello" });

      // eslint-disable-next-line no-unused-vars
      const App = () => {
        return (
          <>
            <div style="display: flex; flex-direction: row; gap: 30px">
              <div>
                <p>
                  <strong>Outside form</strong>
                </p>
                <div>
                  <Input
                    id="outside_form"
                    name="outsideForm"
                    action={async ({ outsideForm }) => {
                      await new Promise((resolve) =>
                        setTimeout(resolve, 1_000),
                      );
                      throw new Error(`test: ${outsideForm}`);
                    }}
                  />
                </div>
              </div>

              <div>
                <p>
                  <strong>Outside form with initial value</strong>
                </p>

                <div>
                  <Input
                    name="outsideFormWithInitialValue"
                    value="initial"
                    action={async ({ outsideFormWithInitialValue }) => {
                      await new Promise((resolve) =>
                        setTimeout(resolve, 1_000),
                      );
                      throw new Error(`test: ${outsideFormWithInitialValue}`);
                    }}
                  />
                </div>
              </div>

              <div>
                <p>
                  <strong>Outside form using action</strong>
                </p>
                <div>
                  <Input name="outsideFormUsingAction" action={actionA} />
                </div>
              </div>
            </div>
            <div style="display: flex; flex-direction: row; gap: 30px">
              <div>
                <p>
                  <strong>Inside form</strong>
                </p>
                <div>
                  <Form>
                    <Input
                      name="insideForm"
                      action={async ({ insideForm }) => {
                        await new Promise((resolve) =>
                          setTimeout(resolve, 1_500),
                        );
                        throw new Error(`test: ${insideForm}`);
                      }}
                    />
                  </Form>
                </div>
              </div>
              <div>
                <p>
                  <strong>Inside form with submit and reset</strong>
                </p>
                <div>
                  <Form
                    action={async ({ insideFormWithSubmitAndReset }) => {
                      await new Promise((resolve) => setTimeout(resolve, 500));
                      throw new Error(`test: ${insideFormWithSubmitAndReset}`);
                    }}
                  >
                    <Input id="tototo" name="insideFormWithSubmitAndReset" />
                    <button type="submit">Submit</button>
                    <button type="reset">Reset</button>
                  </Form>
                </div>
              </div>
            </div>
            <div style="display: flex; flex-direction: row; gap: 30px">
              <div>
                <p>
                  <strong>2 input for the same action</strong>
                </p>
                <Input
                  name="name"
                  action={sharedAction}
                  label="Test"
                  style="color: blue"
                ></Input>
                <Input
                  name="name"
                  action={sharedAction}
                  label="Test"
                  style="color: blue"
                ></Input>
              </div>
            </div>
          </>
        );
      };

      const actionA = createAction(async ({ outsideFormUsingAction }) => {
        await new Promise((resolve) => setTimeout(resolve, 1_000));
        throw new Error(`test: ${outsideFormUsingAction}`);
      });

      render(<App />, document.querySelector("#root"));
    </script>
  </body>
</html>
