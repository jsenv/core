# [3_persistence_with_validation](../../state_signal_persists.test.js)

```js
clearAll();
const results = [];

const sig = stateSignal("option1", {
  id: "validated_persist",
  persists: true,
  oneOf: ["option1", "option2", "option3"],
});

// Set valid value
sig.value = "option2";
results.push({
  step: "valid value set",
  value: sig.value,
  valid: sig.validity.valid,
  storage: mockLocalStorage.getItem("validated_persist"),
});

// Set invalid value - should still persist but be marked invalid
sig.value = "invalid";
results.push({
  step: "invalid value set",
  value: sig.value,
  valid: sig.validity.valid,
  storage: mockLocalStorage.getItem("validated_persist"),
});

return { results };
```

```js
{
  "results": [
    {
      "step": "valid value set",
      "value": "option2",
      "valid": true,
      "storage": '"option2"'
    },
    {
      "step": "invalid value set",
      "value": "option1",
      "valid": true,
      "storage": null
    }
  ]
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
