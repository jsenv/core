# [effects should not trigger for redundant step values](../../state_signal_step.test.js)

```js
try {
  const signal = stateSignal(1.0, { type: "number", step: 0.1 });
  
  const effectCalls = [];
  let effectRunCount = 0;
  
  // Subscribe to signal changes
  signal.subscribe(() => {
    effectRunCount++;
    effectCalls.push({
      run: effectRunCount,
      value: signal.value,
      timestamp: Date.now()
    });
  });

  // Initial subscription call
  const initialEffectCount = effectRunCount;

  // Set values that should round to the same result
  signal.value = 1.04; // Rounds to 1.0 (same as current)
  const afterSameValueCount = effectRunCount;

  signal.value = 1.02; // Rounds to 1.0 (same as current)
  const afterAnotherSameValueCount = effectRunCount;

  // Set a value that should actually change the result
  signal.value = 1.15; // Rounds to 1.1 (different)
  const afterDifferentValueCount = effectRunCount;

  // Set another value that rounds to the same new value
  signal.value = 1.13; // Rounds to 1.1 (same as current 1.1)
  const afterSameFinalValueCount = effectRunCount;

  return {
    initial_effect_count: initialEffectCount,
    after_same_value_count: afterSameValueCount,
    after_another_same_value_count: afterAnotherSameValueCount,
    after_different_value_count: afterDifferentValueCount,
    after_same_final_value_count: afterSameFinalValueCount,
    total_effect_calls: effectCalls.length,
    effect_calls: effectCalls.map(call => ({ run: call.run, value: call.value }))
  };
} finally {
  globalSignalRegistry.clear();
}
```

```js
{
  "initial_effect_count": 1,
  "after_same_value_count": 1,
  "after_another_same_value_count": 1,
  "after_different_value_count": 2,
  "after_same_final_value_count": 2,
  "total_effect_calls": 2,
  "effect_calls": [
    {
      "run": 1,
      "value": 1
    },
    {
      "run": 2,
      "value": 1.1
    }
  ]
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
