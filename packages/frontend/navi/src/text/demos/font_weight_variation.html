<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Smooth-bold — démos</title>
    <style>
      :root {
        color: #111;
        font-family:
          Inter,
          system-ui,
          -apple-system,
          "Segoe UI",
          Roboto,
          "Helvetica Neue",
          Arial;
      }
      body {
        padding: 20px;
        line-height: 1.4;
        background: #f7f7fb;
      }
      h1 {
        margin: 0 0 12px;
        font-size: 18px;
      }
      .examples {
        max-width: 900px;
        margin: 0 auto;
      }
      .card {
        margin-bottom: 24px;
        padding: 20px;
        background: white;
        border: 1px solid #e6e8ec;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(20, 20, 40, 0.03);
      }
      .technique {
        display: inline-block;
        margin-bottom: 12px;
        padding: 4px 8px;
        color: #1e40af;
        font-weight: 600;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        background: #e8f2ff;
        border-radius: 4px;
      }
      .example-title {
        margin-bottom: 8px;
        font-weight: 600;
      }
      .controls {
        display: flex;
        margin-bottom: 10px;
        align-items: center;
        gap: 8px;
      }
      button {
        padding: 6px 10px;
        background: #fff;
        border: 1px solid #cfd6e3;
        border-radius: 6px;
        cursor: pointer;
      }
      .stage {
        margin-bottom: 8px;
        padding: 12px;
        background: #fff;
        border: 1px dashed #e0e6f0;
        border-radius: 6px;
      }

      /* zone parent qui contraint le texte (pour B/C/D). changez max-width pour tester */
      .constrainer {
        max-width: 100px;
        height: 250px;
        padding: 10px;
        background: #fbfcff;
        border-radius: 6px;
      }

      /* comportement par défaut pour les wrappers d'exemples */
      .smooth {
        display: inline-block;
        padding: 6px 8px;
        vertical-align: top;
        background: linear-gradient(
          90deg,
          rgba(255, 240, 240, 0.08),
          rgba(240, 255, 240, 0.03)
        );
        border-radius: 6px;
      }

      /* EXEMPLE 0: bold dicte le flow, normal visible en absolute */
      .ex-0 .wrapper {
        position: relative;
        display: inline-block;
      }
      .ex-0 .inner {
        position: relative;
        display: inline-block;
      }
      .ex-0 .text-normal {
        position: absolute;
        top: 0;
        left: 0;
        font-weight: 400;
        line-height: 1.25;
        white-space: normal;
        opacity: 1;
        transition: opacity 0.18s ease;
      }
      .ex-0 .text-bold {
        position: static; /* dicte le flow */
        font-weight: 700;
        line-height: 1.25;
        white-space: normal;
        opacity: 0; /* invisible, sert juste à dimensionner */
        transition: opacity 0.18s ease;
      }
      .ex-0.active .text-normal {
        font-weight: 700; /* devient bold */
      }
      .ex-0.active .text-bold {
        opacity: 0; /* reste invisible */
      }

      /* EXEMPLE B: normal=absolute + bold=absolute */
      .ex-b .wrapper {
        position: relative;
        display: block;
      }
      .ex-b .inner {
        position: relative;
        display: block;
        width: 100%;
      }
      .ex-b .text-normal {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font-weight: 400;
        line-height: 1.25;
        white-space: normal;
        opacity: 1;
        transition: opacity 0.18s ease;
      }
      .ex-b .text-bold {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font-weight: 700;
        line-height: 1.25;
        white-space: normal;
        opacity: 0;
        transition: opacity 0.18s ease;
      }
      .ex-b.active .text-normal {
        opacity: 0;
      }
      .ex-b.active .text-bold {
        opacity: 1;
      }

      /* EXEMPLE C: flow normal - layout shift visible */
      .ex-c .wrapper {
        position: relative;
        display: inline-block;
      }
      .ex-c .text {
        position: static;
        display: inline;
        font-weight: 400;
        line-height: 1.25;
        white-space: normal;
        transition: font-weight 0.18s ease;
      }
      .ex-c.active .text {
        font-weight: 700;
      }

      /* EXEMPLE D: single-line (nowrap) */
      .ex-d .wrapper {
        position: relative;
        display: inline-block;
        white-space: nowrap;
      }
      .ex-d .text {
        position: static;
        display: inline-block;
        font-weight: 400;
        line-height: 1.25;
        white-space: nowrap;
        transition: font-weight 0.18s ease;
      }
      .ex-d.active .text {
        font-weight: 700;
      }

      .meta {
        margin-top: 8px;
        color: #5b6473;
        font-size: 13px;
      }
      .widths {
        display: inline-block;
        margin-left: 8px;
        padding: 6px 8px;
        font-family: monospace;
        background: #f1f4fb;
        border-radius: 6px;
      }
      footer {
        margin-top: 20px;
        color: #606778;
        font-size: 13px;
      }
    </style>
  </head>
  <body>
    <h1>Smooth-bold — démonstrations interactives</h1>
    <p style="margin: 0 0 12px">
      Coche la case <strong>Bold</strong> sur chaque exemple pour observer le
      wrapping / layout-shift. Les largeurs mesurées (scrollWidth) sont
      affichées.
    </p>

    <div class="examples">
      <!-- EXEMPLE 0 -->
      <div class="card ex-0">
        <div class="technique">Bold=Flow + Normal=Absolute</div>
        <div class="example-title">
          Exemple 0 — <strong>bold dicte le flow</strong>
        </div>
        <div class="controls">
          <label> <input type="checkbox" data-toggle="0" /> Bold </label>
          <div class="meta">
            Bold (invisible) dicte la largeur, normal (visible) affiché en
            absolute
          </div>
        </div>
        <div class="stage">
          <div class="smooth wrapper" id="wrap-0">
            <span class="inner">
              <span class="text-bold" id="0-bold"
                >Ceci est un texte d'exemple qui peut se couper sur plusieurs
                lignes pour démontrer les risques de wrapping différent.</span
              >
              <span class="text-normal" id="0-normal"
                >Ceci est un texte d'exemple qui peut se couper sur plusieurs
                lignes pour démontrer les risques de wrapping différent.</span
              >
            </span>
          </div>
        </div>
        <div class="widths" id="0-widths">—</div>
      </div>

      <!-- EXEMPLE B -->
      <div class="card ex-b">
        <div class="technique">Normal=Absolute + Bold=Absolute</div>
        <div class="example-title">
          Exemple B — <strong>les deux en absolute</strong>
        </div>
        <div class="controls">
          <label> <input type="checkbox" data-toggle="b" /> Bold </label>
          <div class="meta">
            Parent avec max-width: 300px → peut causer des wrappings différents
          </div>
        </div>
        <div class="stage constrainer">
          <div class="smooth wrapper" id="wrap-b">
            <span class="inner">
              <span class="text-normal" id="b-normal"
                >Ceci est un texte d'exemple qui peut se couper sur plusieurs
                lignes pour démontrer les risques de wrapping différent.</span
              >
              <span class="text-bold" id="b-bold"
                >Ceci est un texte d'exemple qui peut se couper sur plusieurs
                lignes pour démontrer les risques de wrapping différent.</span
              >
            </span>
          </div>
        </div>
        <div class="widths" id="b-widths">—</div>
      </div>

      <!-- EXEMPLE C -->
      <div class="card ex-c">
        <div class="technique">Normal=Flow + Bold=Flow</div>
        <div class="example-title">
          Exemple C — <strong>les deux en flow</strong> — shift visible
        </div>
        <div class="controls">
          <label> <input type="checkbox" data-toggle="c" /> Bold </label>
          <div class="meta">
            Les deux textes participent au layout → layout shift garanti
          </div>
        </div>
        <div class="stage">
          <div class="smooth wrapper" id="wrap-c">
            <span class="text" id="c-text"
              >Ceci est un texte d'exemple qui peut se couper sur plusieurs
              lignes pour démontrer les risques de wrapping différent.</span
            >
          </div>
        </div>
        <div class="widths" id="c-widths">—</div>
      </div>

      <!-- EXEMPLE D -->
      <div class="card ex-d">
        <div class="technique">Single Line (No Wrap)</div>
        <div class="example-title">
          Exemple D — <strong>single-line</strong> — solution idéale
        </div>
        <div class="controls">
          <label> <input type="checkbox" data-toggle="d" /> Bold </label>
          <div class="meta">
            white-space: nowrap → pas de wrapping, donc pas de layout shift
          </div>
        </div>
        <div class="stage">
          <div class="smooth wrapper" id="wrap-d">
            <span class="text" id="d-text"
              >Texte_sans_retour_de_ligne_pour_montrer_le_cas_single_line_avec_underscores_ou_espaces_longs</span
            >
          </div>
        </div>
        <div class="widths" id="d-widths">—</div>
      </div>

      <!-- EXEMPLE VAR -->
      <div class="card ex-var">
        <div class="technique">Font Variation Settings</div>
        <div class="example-title">
          Exemple VAR — <strong>font-variation-settings</strong> (Inter
          variable)
        </div>
        <div class="controls">
          <label> <input type="checkbox" data-toggle="var" /> Bold </label>
          <div class="meta">
            Utilise font-variation-settings: "wght" 400/700 pour une transition
            plus fluide
          </div>
        </div>
        <div class="stage">
          <div class="smooth wrapper" id="wrap-var">
            <span class="text" id="var-text"
              >Ceci est un texte d'exemple qui peut se couper sur plusieurs
              lignes pour démontrer les risques de wrapping différent.</span
            >
          </div>
        </div>
        <div class="widths" id="var-widths">—</div>
      </div>
    </div>

    <footer>
      <div>
        Tip : tu peux modifier la largeur du <code>.constrainer</code> (Ex. B)
        ou le texte pour voir d'autres cas. L'exemple 0 utilise le texte bold
        (invisible) pour dimensionner le wrapper, le normal (visible) s'affiche
        en absolute.
      </div>
    </footer>

    <script>
      // Simple helpers
      const $ = (id) => document.getElementById(id);
      const measure = (el) => Math.ceil(el.scrollWidth);

      // Initialize example 0: set wrapper width to bold text width (bold dicte le flow)
      function init0() {
        const wrapper = $("wrap-0");
        const boldText = $("0-bold");
        const boldWidth = measure(boldText);
        wrapper.style.width = `${boldWidth}px`;
        updateWidths("0");
      }

      // Update width displays
      function updateWidths(example) {
        const widthsEl = $(`${example}-widths`);
        const card = document.querySelector(`.ex-${example}`);
        const isActive = card.classList.contains("active");

        let displayText;

        // Exemples avec deux éléments (0, b)
        if (["0", "b"].includes(example)) {
          const normalEl = $(`${example}-normal`);
          const boldEl = $(`${example}-bold`);
          const normalWidth = measure(normalEl);
          const boldWidth = measure(boldEl);

          displayText = `normal: ${normalWidth}px — bold: ${boldWidth}px`;

          if (example === "0") {
            const wrapper = $("wrap-0");
            displayText += ` — wrapper: ${wrapper.style.width}`;
          } else if (example === "b") {
            displayText += " — parent max-width: 300px";
          }
        } else {
          // Exemples avec un seul élément (c, d, var)
          const text = $(`${example}-text`);
          const currentWidth = measure(text);
          const currentWeight = isActive ? "bold (700)" : "normal (400)";
          displayText = `${currentWeight}: ${currentWidth}px`;

          if (example === "var") {
            const computedStyle = getComputedStyle(text);
            const fontVarSettings = computedStyle.fontVariationSettings;
            displayText += ` — font-variation-settings: ${fontVarSettings || "non supporté"}`;
          }
        }

        widthsEl.textContent = displayText;
      }

      // Toggle bold state based on checkbox
      function toggle(example, checked) {
        const card = document.querySelector(`.ex-${example}`);
        if (checked) {
          card.classList.add("active");
        } else {
          card.classList.remove("active");
        }

        requestAnimationFrame(() => {
          updateWidths(example);
        });
      }

      // Initialize everything
      function init() {
        // Set up example 0
        init0();

        // Initialize other examples
        updateWidths("b");
        updateWidths("c");
        updateWidths("d");
        updateWidths("var");

        // Attach checkbox listeners
        document.querySelectorAll("input[data-toggle]").forEach((checkbox) => {
          checkbox.addEventListener("change", () => {
            const example = checkbox.getAttribute("data-toggle");
            toggle(example, checkbox.checked);
          });
        });

        // Update on resize
        window.addEventListener("resize", () => {
          requestAnimationFrame(() => {
            updateWidths("b");
            updateWidths("c");
            updateWidths("d");
            updateWidths("var");
          });
        });
      }

      // Start when ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    </script>
  </body>
</html>
