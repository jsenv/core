<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Smooth-bold — problèmes de wrapping</title>
    <!-- Import Inter Variable pour font-variation-settings -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color: #111;
        font-family:
          Inter,
          system-ui,
          -apple-system,
          "Segoe UI",
          Roboto,
          "Helvetica Neue",
          Arial;
      }
      body {
        padding: 20px;
        line-height: 1.4;
        background: #f7f7fb;
      }
      h1 {
        margin: 0 0 12px;
        font-size: 18px;
      }
      .examples {
        max-width: 900px;
        margin: 0 auto;
      }
      .card {
        margin-bottom: 24px;
        padding: 20px;
        background: white;
        border: 1px solid #e6e8ec;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(20, 20, 40, 0.03);
      }
      .technique {
        display: inline-block;
        margin-bottom: 12px;
        padding: 4px 8px;
        color: #1e40af;
        font-weight: 600;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        background: #e8f2ff;
        border-radius: 4px;
      }
      .example-title {
        margin-bottom: 16px;
        font-weight: 600;
      }

      /* Comparaison côte à côte */
      .comparison {
        display: flex;
        margin-bottom: 16px;
        gap: 12px;
      }
      .version {
        padding: 10px;
        flex: 1;
        font-size: 14px;
        background: #f8f9fa;
        border-radius: 4px;
      }
      .version-title {
        margin-bottom: 8px;
        color: #666;
        font-weight: 600;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .demo-text {
        line-height: 1.3;
      }
      .demo-text.normal {
        font-weight: 400;
      }
      .demo-text.bold {
        font-weight: 700;
      }
      .constrainer {
        max-width: 145px;
        padding: 8px;
        background: #fff;
        border: 1px dashed #ddd;
        border-radius: 4px;
      }

      /* Section interactive */
      .interactive {
        margin-top: 16px;
        padding: 12px;
        background: #fff5f5;
        border: 1px solid #fecaca;
        border-radius: 6px;
      }
      .interactive-title {
        margin-bottom: 8px;
        color: #dc2626;
        font-weight: 600;
        font-size: 12px;
      }
      .smooth {
        display: inline-block;
        margin: 8px 0;
        padding: 6px 8px;
        font-size: 14px;
        background: linear-gradient(
          90deg,
          rgba(255, 240, 240, 0.08),
          rgba(240, 255, 240, 0.03)
        );
        border-radius: 6px;
      }

      .meta {
        margin: 8px 0;
        color: #5b6473;
        font-size: 13px;
      }
      .widths {
        display: inline-block;
        margin-left: 8px;
        padding: 6px 8px;
        font-size: 11px;
        font-family: monospace;
        background: #f1f4fb;
        border-radius: 6px;
      }

      /* EXEMPLE 0: bold invisible dicte la largeur */
      .ex-0 .wrapper {
        position: relative;
        display: inline-block;
        max-width: 140px;
      }
      .ex-0 .inner {
        position: relative;
        display: inline-block;
      }
      .ex-0 .text-normal {
        position: absolute;
        top: 0;
        left: 0;
        font-weight: 400;
        line-height: 1.3;
        opacity: 1;
        transition: font-weight 0.2s ease;
      }
      .ex-0 .text-bold {
        position: static;
        font-weight: 700;
        line-height: 1.3;
        opacity: 0;
      }
      .ex-0.active .text-normal {
        font-weight: 700;
      }

      /* EXEMPLE B: les deux en absolute */
      .ex-b .wrapper {
        position: relative;
        display: block;
      }
      .ex-b .inner {
        position: relative;
        display: block;
        width: 100%;
      }
      .ex-b .text-normal {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font-weight: 400;
        line-height: 1.3;
        opacity: 1;
        transition: opacity 0.2s ease;
      }
      .ex-b .text-bold {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font-weight: 700;
        line-height: 1.3;
        opacity: 0;
        transition: opacity 0.2s ease;
      }
      .ex-b.active .text-normal {
        opacity: 0;
      }
      .ex-b.active .text-bold {
        opacity: 1;
      }

      /* EXEMPLE C: les deux en flow */
      .ex-c .text {
        font-weight: 400;
        line-height: 1.3;
        transition: font-weight 0.2s ease;
      }
      .ex-c.active .text {
        font-weight: 700;
      }

      /* EXEMPLE D: single-line sans wrapping */
      .ex-d .wrapper {
        white-space: nowrap;
      }
      .ex-d .text {
        font-weight: 400;
        line-height: 1.3;
        white-space: nowrap;
        transition: font-weight 0.2s ease;
      }
      .ex-d.active .text {
        font-weight: 700;
      }
    </style>
  </head>
  <body>
    <h1>Smooth-bold — problèmes de wrapping</h1>
    <p style="margin: 0 0 16px; font-size: 14px; color: #666">
      Chaque exemple montre d'abord les versions <strong>normal</strong> et
      <strong>bold</strong> côte à côte, puis une démonstration interactive du
      problème de layout shift.
    </p>

    <div class="examples">
      <!-- EXEMPLE 0 -->
      <div class="card ex-0">
        <div class="technique">Bold invisible dicte la largeur</div>
        <div class="example-title">
          Problème : wrapping différent entre normal et bold
        </div>

        <div class="comparison">
          <div class="version">
            <div class="version-title">Normal (visible)</div>
            <div class="demo-text normal constrainer">
              Cette solution semble marcher mais échoue à cause du wrapping.
            </div>
          </div>
          <div class="version">
            <div class="version-title">Bold (invisible, dicte largeur)</div>
            <div class="demo-text bold constrainer">
              Cette solution semble marcher mais échoue à cause du wrapping.
            </div>
          </div>
        </div>

        <div class="meta">
          ⚠️ Le bold (invisible) dicte la largeur du container, mais son
          wrapping est différent du normal visible.
        </div>

        <div class="interactive">
          <div class="interactive-title">
            Test : Coche pour voir le décalage
          </div>
          <label> <input type="checkbox" data-toggle="0" /> Bold </label>
          <div class="smooth wrapper" id="wrap-0">
            <span class="inner">
              <span class="text-normal" id="0-normal"
                >Cette solution semble marcher mais échoue à cause du
                wrapping.</span
              >
              <span class="text-bold" id="0-bold"
                >Cette solution semble marcher mais échoue à cause du
                wrapping.</span
              >
            </span>
          </div>
          <div class="widths" id="0-widths">—</div>
        </div>
      </div>

      <!-- EXEMPLE B -->
      <div class="card ex-b">
        <div class="technique">Les deux en absolute</div>
        <div class="example-title">
          Problème : wrapping différent entre les deux versions
        </div>

        <div class="comparison">
          <div class="version">
            <div class="version-title">Normal (absolute)</div>
            <div class="demo-text normal constrainer">
              Texte court qui wrap différemment en bold.
            </div>
          </div>
          <div class="version">
            <div class="version-title">Bold (absolute)</div>
            <div class="demo-text bold constrainer">
              Texte court qui wrap différemment en bold.
            </div>
          </div>
        </div>

        <div class="meta">
          ⚠️ Les deux versions sont en absolute, mais leur wrapping diffère à
          cause de la largeur des caractères.
        </div>

        <div class="interactive">
          <div class="interactive-title">
            Test : Coche pour voir le changement de wrapping
          </div>
          <label> <input type="checkbox" data-toggle="b" /> Bold </label>
          <div class="constrainer">
            <div class="smooth wrapper" id="wrap-b">
              <span class="inner">
                <span class="text-normal" id="b-normal"
                  >Texte court qui wrap différemment en bold.</span
                >
                <span class="text-bold" id="b-bold"
                  >Texte court qui wrap différemment en bold.</span
                >
              </span>
            </div>
          </div>
          <div class="widths" id="b-widths">—</div>
        </div>
      </div>

      <!-- EXEMPLE C -->
      <div class="card ex-c">
        <div class="technique">Les deux en flow</div>
        <div class="example-title">Problème : layout shift garanti</div>

        <div class="comparison">
          <div class="version">
            <div class="version-title">Normal (flow)</div>
            <div class="demo-text normal constrainer">
              Texte normal dans le flow.
            </div>
          </div>
          <div class="version">
            <div class="version-title">Bold (flow)</div>
            <div class="demo-text bold constrainer">
              Texte normal dans le flow.
            </div>
          </div>
        </div>

        <div class="meta">
          ⚠️ Le texte participe au flow, le changement de largeur cause
          forcément un layout shift.
        </div>

        <div class="interactive">
          <div class="interactive-title">
            Test : Coche pour voir le layout shift
          </div>
          <label> <input type="checkbox" data-toggle="c" /> Bold </label>
          <div class="constrainer">
            <div class="smooth">
              <span class="text" id="c-text">Texte normal dans le flow.</span>
            </div>
          </div>
          <div class="widths" id="c-widths">—</div>
        </div>
      </div>

      <!-- EXEMPLE D -->
      <div class="card ex-d">
        <div class="technique">Single line (solution qui marche)</div>
        <div class="example-title">Solution : pas de wrapping possible</div>

        <div class="comparison">
          <div class="version">
            <div class="version-title">Normal (nowrap)</div>
            <div class="demo-text normal">Texte_single_line_sans_wrap</div>
          </div>
          <div class="version">
            <div class="version-title">Bold (nowrap)</div>
            <div class="demo-text bold">Texte_single_line_sans_wrap</div>
          </div>
        </div>

        <div class="meta">
          ✅ Avec white-space: nowrap, pas de différence de wrapping possible.
        </div>

        <div class="interactive">
          <div class="interactive-title">Test : Aucun layout shift</div>
          <label> <input type="checkbox" data-toggle="d" /> Bold </label>
          <div class="smooth wrapper" id="wrap-d">
            <span class="text" id="d-text">Texte_single_line_sans_wrap</span>
          </div>
          <div class="widths" id="d-widths">—</div>
        </div>
      </div>
    </div>

    <script>
      // Simple helpers
      const $ = (id) => document.getElementById(id);
      const measure = (el) => Math.ceil(el.scrollWidth);

      // Initialize example 0: set wrapper width to bold text width
      function init0() {
        const wrapper = $("wrap-0");
        const boldText = $("0-bold");
        const boldWidth = measure(boldText);
        wrapper.style.width = `${boldWidth}px`;
        updateWidths("0");
      }

      // Update width displays
      function updateWidths(example) {
        const widthsEl = $(`${example}-widths`);
        const card = document.querySelector(`.ex-${example}`);
        const isActive = card.classList.contains("active");

        let displayText;

        // Exemples avec deux éléments (0, b)
        if (["0", "b"].includes(example)) {
          const normalEl = $(`${example}-normal`);
          const boldEl = $(`${example}-bold`);
          const normalWidth = measure(normalEl);
          const boldWidth = measure(boldEl);

          displayText = `normal: ${normalWidth}px — bold: ${boldWidth}px`;

          if (example === "0") {
            const wrapper = $("wrap-0");
            displayText += ` — wrapper: ${wrapper.style.width}`;
          }
        } else {
          // Exemples avec un seul élément (c, d)
          const text = $(`${example}-text`);
          const currentWidth = measure(text);
          const currentWeight = isActive ? "bold (700)" : "normal (400)";
          displayText = `${currentWeight}: ${currentWidth}px`;
        }

        widthsEl.textContent = displayText;
      }

      // Toggle bold state based on checkbox
      function toggle(example, checked) {
        const card = document.querySelector(`.ex-${example}`);
        if (checked) {
          card.classList.add("active");
        } else {
          card.classList.remove("active");
        }

        requestAnimationFrame(() => {
          updateWidths(example);
        });
      }

      // Initialize everything
      function init() {
        // Set up example 0
        init0();

        // Initialize other examples
        updateWidths("b");
        updateWidths("c");
        updateWidths("d");

        // Attach checkbox listeners
        document.querySelectorAll("input[data-toggle]").forEach((checkbox) => {
          checkbox.addEventListener("change", () => {
            const example = checkbox.getAttribute("data-toggle");
            toggle(example, checkbox.checked);
          });
        });
      }

      // Start when ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    </script>
  </body>
</html>
