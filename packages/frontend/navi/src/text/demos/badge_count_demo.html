<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Badge Count Demo</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" jsenv-type="module/jsx">
      import { render } from "preact";
      import { useState } from "preact/hooks";
      import {
        Text,
        Paragraph,
        Box,
        Title,
        BadgeCount,
        Link,
        Button,
        Caption,
      } from "@jsenv/navi";

      // Composants JSX pour éviter les erreurs de syntaxe lors des modifications
      const TableOfContents = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">Table des matières</Title>
          <Box row spacing="xs" marginTop="md">
            <Link href="#tests-comportementaux">
              1. Tests comportementaux par police
            </Link>
            <Link href="#font-sizes">
              2. Comportement avec différents font-size
            </Link>
            <Link href="#font-families">
              3. Comportement avec différents font-family
            </Link>
            <Link href="#line-heights">
              4. Comportement avec différents line-heights
            </Link>
            <Link href="#integration-composants">
              5. Intégration dans différents composants
            </Link>
            <Link href="#badge-positioning">6. Badge positioning</Link>
            <Link href="#nowrap">
              7. Association texte + badge (pas de coupure)
            </Link>
          </Box>
        </Box>
      );

      const LoadingStateSection = () => {
        const [loading, setLoading] = useState(true);
        const [ellipseLoading, setEllipseLoading] = useState(true);

        return (
          <Box as="section" marginBottom="xl">
            <Title as="h2">Loading State Demo</Title>
            <Paragraph>
              This section demonstrates the loading prop effect on BadgeCount
              components. Use the buttons to test loading transitions.
            </Paragraph>

            <Box column spacing="m">
              <Box row spacing="md" alignX="start">
                <Caption>Loading state with default badge</Caption>
                <Box row spacing="sm" alignY="center">
                  <Button action={() => setLoading(true)} disabled={loading}>
                    Start Loading
                  </Button>
                  <Button action={() => setLoading(false)} disabled={!loading}>
                    Stop Loading
                  </Button>
                </Box>

                <Box
                  row
                  spacing="md"
                  alignY="center"
                  background="lightyellow"
                  border="1px dotted red"
                >
                  <Text>
                    Inbox
                    <BadgeCount
                      background="#2196f3"
                      color="white"
                      loading={loading}
                    >
                      15
                    </BadgeCount>
                  </Text>
                </Box>
              </Box>

              <Box row spacing="md" alignX="start">
                <Caption>Loading state with ellipse</Caption>
                <Box row spacing="sm" alignY="center">
                  <Button
                    action={() => setEllipseLoading(true)}
                    disabled={ellipseLoading}
                  >
                    Start Loading
                  </Button>
                  <Button
                    action={() => setEllipseLoading(false)}
                    disabled={!ellipseLoading}
                  >
                    Stop Loading
                  </Button>
                </Box>

                <Box
                  row
                  spacing="md"
                  alignY="center"
                  background="lightyellow"
                  border="1px dotted red"
                >
                  <Text>
                    Inbox
                    <BadgeCount
                      ellipse
                      background="#2196f3"
                      color="white"
                      loading={ellipseLoading}
                      max={Infinity}
                    >
                      1500
                    </BadgeCount>
                  </Text>
                </Box>
              </Box>
            </Box>
          </Box>
        );
      };

      const TestsComportementauxSection = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">
            <Link anchor href="#tests-comportementaux" />
            Tests comportementaux par police
          </Title>
          <Paragraph>
            Cette section teste le comportement du badge avec différentes
            valeurs numériques et différentes polices pour vérifier l'alignement
            et le rendu.
          </Paragraph>

          <Box row spacing="xs" size="xxl">
            <Box row alignY="center">
              <Caption>Police par défaut (sans-serif)</Caption>
              <Box row>
                <Text size="60">
                  <Text>Before</Text>
                  <BadgeCount background="#2196f3" color="white" size="m">
                    0
                  </BadgeCount>
                  <Text>After</Text>
                </Text>
                <Text>
                  Before
                  <BadgeCount background="#2196f3" color="white" size="xxs">
                    1
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white">
                    5
                  </BadgeCount>
                  After
                </Text>
                <Text>
                  Before
                  <BadgeCount background="#2196f3" color="white">
                    9
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white" max={9}>
                    10
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white">
                    10
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white">
                    99
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white">
                    100
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white" max="none">
                    100
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white" max={999}>
                    1000
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#2196f3" color="white" max="none">
                    1000
                  </BadgeCount>
                  After
                </Text>
              </Box>
            </Box>

            <Box row alignY="center">
              <Caption>Police monospace</Caption>
              <Box row font="monospace">
                <Text>
                  Before
                  <BadgeCount background="#ff9800" color="white">
                    0
                  </BadgeCount>
                  After
                </Text>
                <Text>
                  Before
                  <BadgeCount background="#ff9800" color="white" size="xxs">
                    1
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white">
                    5
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white">
                    9
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white" max={9}>
                    10
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white">
                    10
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white">
                    99
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white">
                    100
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white" max="none">
                    100
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white" max={999}>
                    1000
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#ff9800" color="white" max="none">
                    1000
                  </BadgeCount>
                  After
                </Text>
              </Box>
            </Box>

            <Box row alignY="center">
              <Caption>Police serif</Caption>
              <Box row font="serif">
                <Text>
                  Before
                  <BadgeCount background="#4caf50" color="white">
                    0
                  </BadgeCount>
                  After
                </Text>
                <Text>
                  Before
                  <BadgeCount background="#4caf50" color="white" size="xxs">
                    1
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white">
                    5
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white">
                    9
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white" max={9}>
                    10
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white">
                    10
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white">
                    99
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white">
                    100
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white" max="none">
                    100
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white" max={999}>
                    1000
                  </BadgeCount>
                  After
                </Text>
                <Text spacing="0">
                  Before
                  <BadgeCount background="#4caf50" color="white" max="none">
                    1000
                  </BadgeCount>
                  After
                </Text>
              </Box>
            </Box>
          </Box>
        </Box>
      );

      const FontFamiliesSection = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">
            <Link anchor href="#font-families" />
            Comportement avec différents font-family
          </Title>
          <Paragraph>
            Ces exemples montrent comment le badge s'adapte à différentes
            polices. Le badge maintient son alignement quel que soit le style de
            police utilisé.
          </Paragraph>
          <Box row spacing="lg">
            <div>
              <Caption>Sans-serif (défaut)</Caption>
              <div
                style={{
                  border: "2px dashed #e91e63",
                  backgroundColor: "rgba(233, 30, 99, 0.05)",
                  padding: "12px",
                  borderRadius: "4px",
                }}
              >
                <Text
                  style={{ fontSize: "20px", fontFamily: "sans-serif" }}
                  noWrap
                >
                  Messages
                  <BadgeCount background="#e91e63" color="white">
                    42
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>Monospace</Caption>
              <div
                style={{
                  border: "2px dashed #00bcd4",
                  backgroundColor: "rgba(0, 188, 212, 0.05)",
                  padding: "12px",
                  borderRadius: "4px",
                }}
              >
                <Text
                  style={{ fontSize: "20px", fontFamily: "monospace" }}
                  noWrap
                >
                  Messages
                  <BadgeCount background="#00bcd4" color="white">
                    42
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>Serif</Caption>
              <div
                style={{
                  border: "2px dashed #8bc34a",
                  backgroundColor: "rgba(139, 195, 74, 0.05)",
                  padding: "12px",
                  borderRadius: "4px",
                }}
              >
                <Text style={{ fontSize: "20px", fontFamily: "serif" }} noWrap>
                  Messages
                  <BadgeCount background="#8bc34a" color="white">
                    42
                  </BadgeCount>
                </Text>
              </div>
            </div>
          </Box>
        </Box>
      );

      const LineHeightsSection = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">
            <Link anchor href="#line-heights" />
            Comportement avec différents line-heights
          </Title>
          <Paragraph>
            Ces exemples montrent comment le badge s'adapte à différentes
            hauteurs de ligne. Les bordures colorées visualisent la hauteur
            réelle occupée par chaque ligne.
          </Paragraph>
          <Box row spacing="lg">
            <div>
              <Caption>line-height: 1.4 - Hauteur de ligne compacte</Caption>
              <div
                style={{
                  border: "2px dashed #2196f3",
                  backgroundColor: "rgba(33, 150, 243, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                  lineHeight: "1.4",
                  fontSize: "16px",
                }}
              >
                <Text noWrap>
                  Messages
                  <BadgeCount background="#9c27b0" color="white">
                    2
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>line-height: 2 - Hauteur de ligne espacée</Caption>
              <div
                style={{
                  border: "2px dashed #ff9800",
                  backgroundColor: "rgba(255, 152, 0, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                  lineHeight: "2",
                  fontSize: "16px",
                }}
              >
                <Text noWrap>
                  Messages
                  <BadgeCount background="#ff5722" color="white">
                    2
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>line-height: 3 - Hauteur de ligne très espacée</Caption>
              <div
                style={{
                  border: "2px dashed #4caf50",
                  backgroundColor: "rgba(76, 175, 80, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                  lineHeight: "3",
                  fontSize: "16px",
                }}
              >
                <Text noWrap>
                  Messages
                  <BadgeCount background="#795548" color="white">
                    2
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>
                line-height: 3 - Restoring a regular line height on the badge
              </Caption>
              <div
                style={{
                  border: "2px dashed #4caf50",
                  backgroundColor: "rgba(76, 175, 80, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                  lineHeight: "3",
                  fontSize: "16px",
                }}
              >
                <Text noWrap>
                  Messages
                  <BadgeCount
                    background="#795548"
                    color="white"
                    lineHeight="normal"
                  >
                    2
                  </BadgeCount>
                </Text>
              </div>
            </div>
          </Box>
        </Box>
      );

      const FontSizesSection = () => (
        <Box as="section" marginBottom="xl" relative>
          <Link anchor href="#font-sizes" revealOnInteraction />
          <Title as="h2">Comportement avec différents font-size</Title>
          <Paragraph>
            Ces exemples montrent comment le badge s'adapte à différentes
            tailles de police. Le badge maintient ses proportions relatives au
            texte.
          </Paragraph>
          <Box row spacing="lg">
            <div>
              <Caption>font-size: 12px - Petit texte</Caption>
              <div
                style={{
                  border: "2px dashed #9c27b0",
                  backgroundColor: "rgba(156, 39, 176, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                }}
              >
                <Text style={{ fontSize: "12px" }} noWrap>
                  Petits messages
                  <BadgeCount background="#9c27b0" color="white">
                    5
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>font-size: 16px - Taille normale</Caption>
              <div
                style={{
                  border: "2px dashed #ff5722",
                  backgroundColor: "rgba(255, 87, 34, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                }}
              >
                <Text style={{ fontSize: "16px" }} noWrap>
                  Messages normaux
                  <BadgeCount background="#ff5722" color="white">
                    12
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>font-size: 24px - Grand texte</Caption>
              <div
                style={{
                  border: "2px dashed #607d8b",
                  backgroundColor: "rgba(96, 125, 139, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                }}
              >
                <Text style={{ fontSize: "24px" }} noWrap>
                  Gros messages
                  <BadgeCount background="#607d8b" color="white">
                    8
                  </BadgeCount>
                </Text>
              </div>
            </div>

            <div>
              <Caption>font-size: 32px - Très grand texte</Caption>
              <div
                style={{
                  border: "2px dashed #795548",
                  backgroundColor: "rgba(121, 85, 72, 0.05)",
                  padding: "8px",
                  borderRadius: "4px",
                }}
              >
                <Text style={{ fontSize: "32px" }} noWrap>
                  Messages énormes
                  <BadgeCount background="#795548" color="white">
                    99
                  </BadgeCount>
                </Text>
              </div>
            </div>
          </Box>
        </Box>
      );

      const IntegrationComposantsSection = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">
            <Link anchor href="#integration-composants" />
            Intégration dans différents composants
          </Title>
          <Box row spacing="lg">
            <div>
              <Caption>Avec Text</Caption>
              <br />
              <Text>
                Notifications
                <BadgeCount background="#ff9800" color="white">
                  3
                </BadgeCount>
              </Text>
            </div>

            <div>
              <Caption>Avec Paragraph</Caption>
              <Paragraph>
                Vos messages
                <BadgeCount background="#4caf50" color="white" size="xs">
                  8
                </BadgeCount>
                sont prêts.
              </Paragraph>
            </div>

            <div>
              <Caption>Button with badge</Caption>
              <br />
              <Button>
                Tâches
                <BadgeCount background="#2196f3" color="white">
                  5
                </BadgeCount>
              </Button>
            </div>

            <div>
              <Caption>Button with badge size="s"</Caption>
              <br />
              <Button>
                Tâches
                <BadgeCount background="#2196f3" color="white" size="s">
                  5
                </BadgeCount>
              </Button>
            </div>

            <div>
              <Caption>Button lineHeight=2.5</Caption>
              <br />
              <Button lineHeight="2.5">
                Tâches
                <BadgeCount background="#2196f3" color="white">
                  5
                </BadgeCount>
              </Button>
            </div>
          </Box>
        </Box>
      );

      const BadgePositioningSection = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">
            <Link anchor href="#badge-positioning" />
            Badge positioning
          </Title>
          <Box row spacing="md">
            <div>
              <Caption>Position au début du conteneur</Caption>
              <Box row spacing="md">
                <Box
                  column
                  alignX="start"
                  alignY="center"
                  border="1px solid #e0e0e0"
                  borderRadius="8px"
                  padding="sm"
                  width="200"
                >
                  <BadgeCount background="#ff9800" color="white" size="xs">
                    12
                  </BadgeCount>
                  <Text selfAlignX="end">Tâches en attente</Text>
                </Box>

                <Box
                  column
                  alignX="end"
                  alignY="center"
                  border="1px solid #e0e0e0"
                  borderRadius="8px"
                  padding="sm"
                  width="250"
                >
                  <BadgeCount
                    background="#4caf50"
                    color="white"
                    selfAlignX="start"
                    size="xs"
                  >
                    12
                  </BadgeCount>
                  <Text>Tâches en attente</Text>
                </Box>
              </Box>
            </div>

            <div>
              <Caption>Position à la fin du conteneur</Caption>
              <Box row spacing="md">
                <Box
                  column
                  alignX="end"
                  alignY="center"
                  border="1px solid #e0e0e0"
                  borderRadius="8px"
                  padding="sm"
                  width="200"
                >
                  <Text selfAlignX="start">Alertes</Text>
                  <BadgeCount background="#d32f2f" color="white" size="xs">
                    25
                  </BadgeCount>
                </Box>

                <Box
                  column
                  alignX="start"
                  border="1px solid #e0e0e0"
                  borderRadius="8px"
                  padding="sm"
                  width="250"
                >
                  Messages
                  <BadgeCount
                    background="#1976d2"
                    color="white"
                    selfAlignX="end"
                  >
                    8
                  </BadgeCount>
                </Box>
              </Box>
            </div>
          </Box>
        </Box>
      );

      const NoWrapSection = () => (
        <Box as="section" marginBottom="xl">
          <Title as="h2">
            <Link anchor href="#nowrap" />
            Association texte + badge (pas de coupure)
          </Title>
          <Box column spacing="md">
            <div>
              <Caption>
                Sans noWrap - Le badge peut être séparé du texte
              </Caption>
              <Paragraph
                overflowEllipsis
                style={{
                  width: "120px",
                  border: "1px solid #ddd",
                  padding: "8px",
                  backgroundColor: "#f9f9f9",
                }}
              >
                <Text>
                  Vous avez
                  <BadgeCount background="#673ab7" color="white">
                    15
                  </BadgeCount>
                  messages
                </Text>
              </Paragraph>
            </div>

            <div>
              <Caption>
                Avec noWrap - Le badge et "messages" restent ensemble
              </Caption>
              <Paragraph
                overflowEllipsis
                style={{
                  width: "120px",
                  border: "1px solid #ddd",
                  padding: "8px",
                  backgroundColor: "#e8f5e8",
                }}
              >
                Vous avez
                <Text noWrap>
                  <BadgeCount background="#673ab7" color="white">
                    15
                  </BadgeCount>
                  messages
                </Text>
              </Paragraph>
            </div>
          </Box>
        </Box>
      );

      const Demo = () => {
        return (
          <div
            style={{
              padding: "20px",
              fontFamily: "system-ui, sans-serif",
              maxWidth: "800px",
              lineHeight: "1.6",
            }}
          >
            <Title as="h1">Badge Count Demo</Title>

            <TableOfContents />
            <LoadingStateSection />
            <TestsComportementauxSection />
            <FontSizesSection />
            <FontFamiliesSection />
            <LineHeightsSection />
            <IntegrationComposantsSection />
            <BadgePositioningSection />
            <NoWrapSection />
          </div>
        );
      };

      render(<Demo />, document.getElementById("app"));
    </script>
  </body>
</html>
