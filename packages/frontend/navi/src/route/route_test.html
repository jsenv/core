<!doctype html>
<html>
  <head>
    <title>Route Test</title>
    <meta charset="utf-8" />
    <link rel="icon" href="data:," />
    <style>
      body {
        padding: 20px;
        font-family: Arial, sans-serif;
      }
      .nav {
        margin-bottom: 20px;
      }
      .nav a {
        margin-right: 10px;
        padding: 5px 10px;
        text-decoration: none;
        background: #f0f0f0;
        border-radius: 3px;
      }
      .nav a.active {
        color: white;
        background: #007acc;
      }
      .route-wrapper {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      .debug {
        margin: 10px 0;
        padding: 10px;
        background: #f9f9f9;
        border-left: 3px solid #333;
      }
    </style>
  </head>

  <body>
    <div id="app"></div>
    <script type="module" jsenv-type="module/jsx">
      import { render } from "preact";
      import { setupRoutes } from "./route.js";
      import { Route } from "./route.jsx";

      const { HOME_ROUTE, LOGIN_ROUTE, FORGOT_PASSWORD_ROUTE, PROFILE_ROUTE } =
        setupRoutes({
          HOME_ROUTE: "/",
          LOGIN_ROUTE: "/login",
          FORGOT_PASSWORD_ROUTE: "/forgot",
          PROFILE_ROUTE: "/profile",
        });

      // Test App
      const App = () => {
        const [url, setUrl] = useState(window.location.href);

        const navigate = (newUrl) => {
          setUrl(newUrl);
          setCurrentUrl(newUrl);
          window.location.hash = newUrl;
        };

        return (
          <div>
            <h1>Route System Test</h1>

            {/* Navigation */}
            <div className="nav">
              <a
                href="#"
                className={url === "#/" ? "active" : ""}
                onClick={(e) => {
                  e.preventDefault();
                  navigate("#/");
                }}
              >
                Home
              </a>
              <a
                href="#"
                className={url === "#/login" ? "active" : ""}
                onClick={(e) => {
                  e.preventDefault();
                  navigate("#/login");
                }}
              >
                Login
              </a>
              <a
                href="#"
                className={url === "#/forgot" ? "active" : ""}
                onClick={(e) => {
                  e.preventDefault();
                  navigate("#/forgot");
                }}
              >
                Forgot Password
              </a>
              <a
                href="#"
                className={url === "#/profile" ? "active" : ""}
                onClick={(e) => {
                  e.preventDefault();
                  navigate("#/profile");
                }}
              >
                Profile
              </a>
            </div>

            <div className="debug">
              <strong>Current URL:</strong> {url}
            </div>

            {/* Test Cases */}
            <h2>Test Case 1: Simple Routes</h2>
            <div className="route-wrapper">
              <Route route={HOME_ROUTE}>
                <h3>üè† Homepage Content</h3>
                <p>This is the homepage!</p>
              </Route>

              <Route route={PROFILE_ROUTE}>
                <h3>üë§ Profile Content</h3>
                <p>This is the profile page!</p>
              </Route>
            </div>

            <h2>Test Case 2: Route Without Route Prop (Wrapper)</h2>
            <div className="route-wrapper">
              <Route>
                <div style="background: #e6f3ff; padding: 15px; border-radius: 5px;">
                  <h3>üîê Auth Section</h3>
                  <p>
                    This wrapper should only render when one of the auth routes
                    is active:
                  </p>

                  <Route route={LOGIN_ROUTE}>
                    <div style="background: #fff; padding: 10px; margin: 10px 0; border: 1px solid #ddd;">
                      <h4>Login Form</h4>
                      <p>Enter your credentials here</p>
                    </div>
                  </Route>

                  <Route route={FORGOT_PASSWORD_ROUTE}>
                    <div style="background: #fff; padding: 10px; margin: 10px 0; border: 1px solid #ddd;">
                      <h4>Password Reset</h4>
                      <p>Reset your password here</p>
                    </div>
                  </Route>

                  <p>
                    <em>End of auth section</em>
                  </p>
                </div>
              </Route>
            </div>

            <h2>Expected Behavior</h2>
            <ul>
              <li>
                <strong>Home (#/):</strong> Only homepage content visible
              </li>
              <li>
                <strong>Login (#/login):</strong> Auth section wrapper + login
                form visible
              </li>
              <li>
                <strong>Forgot (#/forgot):</strong> Auth section wrapper +
                forgot password form visible
              </li>
              <li>
                <strong>Profile (#/profile):</strong> Only profile content
                visible
              </li>
            </ul>
          </div>
        );
      };

      render(<App />, document.getElementById("app"));
    </script>
  </body>
</html>
