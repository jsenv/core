TODO:

- add more tests
- improve error messages
