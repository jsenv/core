# [3_versioning](../../endpoint_negotiation.test.mjs)

```js
const routes = [
  {
    endpoint: "GET /users",
    availableVersions: [(value) => parseInt(value) > 2],
    fetch: () =>
      new Response("latest users", {
        headers: { "content-version": "3" },
      }),
  },
  {
    endpoint: "GET /users",
    availableVersions: ["alpha"],
    fetch: () =>
      new Response("alpha users", {
        headers: { "content-version": "alpha" },
      }),
  },
  {
    endpoint: "GET /users",
    availableVersions: [1],
    fetch: () =>
      new Response("users v1", {
        headers: { "content-version": "1" },
      }),
  },
  {
    endpoint: "GET /users",
    availableVersions: [2],
    fetch: () =>
      new Response("users v2", {
        headers: { "content-version": "2" },
      }),
  },
];
return {
  "GET /users without setting accept-version": await run({
    routes,
    method: "GET",
    path: "/users",
  }),
  "GET /users accepting any version": await run({
    routes,
    method: "GET",
    path: "/users",
    headers: {
      "accept-version": "*",
    },
  }),
  "GET /users accepting alpha version": await run({
    routes,
    method: "GET",
    path: "/users",
    headers: {
      "accept-version": "alpha",
    },
  }),
  "GET /users accepting version 1": await run({
    routes,
    method: "GET",
    path: "/users",
    headers: {
      "accept-version": "1",
    },
  }),
  "GET /users accepting version 2": await run({
    routes,
    method: "GET",
    path: "/users",
    headers: {
      "accept-version": "2",
    },
  }),
  "GET /users accepting version 3": await run({
    routes,
    method: "GET",
    path: "/users",
    headers: {
      "accept-version": "3",
    },
  }),
};
```

```js
{
  "GET /users without setting accept-version": {
    "status": 200,
    "headers": {
      "content-type": "text/plain;charset=UTF-8",
      "content-version": "3",
      "vary": "accept-version",
      "date": "<X>",
      "connection": "keep-alive",
      "keep-alive": "timeout=5",
      "transfer-encoding": "chunked"
    },
    "body": "latest users"
  },
  "GET /users accepting any version": {
    "status": 200,
    "headers": {
      "content-type": "text/plain;charset=UTF-8",
      "content-version": "3",
      "vary": "accept-version",
      "date": "<X>",
      "connection": "keep-alive",
      "keep-alive": "timeout=5",
      "transfer-encoding": "chunked"
    },
    "body": "latest users"
  },
  "GET /users accepting alpha version": {
    "status": 200,
    "headers": {
      "content-type": "text/plain;charset=UTF-8",
      "content-version": "alpha",
      "vary": "accept-version",
      "date": "<X>",
      "connection": "keep-alive",
      "keep-alive": "timeout=5",
      "transfer-encoding": "chunked"
    },
    "body": "alpha users"
  },
  "GET /users accepting version 1": {
    "status": 200,
    "headers": {
      "content-type": "text/plain;charset=UTF-8",
      "content-version": "1",
      "vary": "accept-version",
      "date": "<X>",
      "connection": "keep-alive",
      "keep-alive": "timeout=5",
      "transfer-encoding": "chunked"
    },
    "body": "users v1"
  },
  "GET /users accepting version 2": {
    "status": 200,
    "headers": {
      "content-type": "text/plain;charset=UTF-8",
      "content-version": "2",
      "vary": "accept-version",
      "date": "<X>",
      "connection": "keep-alive",
      "keep-alive": "timeout=5",
      "transfer-encoding": "chunked"
    },
    "body": "users v2"
  },
  "GET /users accepting version 3": {
    "status": 200,
    "headers": {
      "content-type": "text/plain;charset=UTF-8",
      "content-version": "3",
      "vary": "accept-version",
      "date": "<X>",
      "connection": "keep-alive",
      "keep-alive": "timeout=5",
      "transfer-encoding": "chunked"
    },
    "body": "latest users"
  }
}
```

---

<sub>
  Generated by <a href="https://github.com/jsenv/core/tree/main/packages/tooling/snapshot">@jsenv/snapshot</a>
</sub>
