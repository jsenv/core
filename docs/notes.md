## TODO

- rename projectFolder projectPath
- fix uneval issue with AssertionError
- nothing else :)

## To keep in mind

- Any times groupMap changes (because compileGroupCount, babelPluginMap, platformScoreMap changes),
  node-platform, browser-platform and every cached files becomes invalid.
  This is not the case for now and can be surprising.
- Ideally we should not keep our own systemjs version:
  https://github.com/systemjs/systemjs/issues/1924 and https://github.com/systemjs/systemjs/pull/1925.
- Ideally we should not keep our own babel-plugin-transform-modules-systemjs version: https://github.com/babel/babel/issues/9426
- Respond to guybeford here https://github.com/systemjs/systemjs/pull/1925
- Create @jsenv/chromium-launcher to externalize some code and make
  jsenv/core lighter for thoose not using chromium
- Create @jsenv/node-launcher to externalize some code and make
  jsenv/core lighter for thoose not using node
- Create @jsenv/firefox-launcher because it would be cool
  to be able to test against firefox and puppeteer-firefox should help a lot
- safari-launcher, opera-launcher would be great

### How to use dependency written in commonjs

Some module now have `module` or `jsnext:main` in their `package.json` leading to files written using `import/export`. In that case `importMap.json` generated by `generate-import-map` will contain a remapping to this file and you're good.

Otherwise if you want to use a npm module called `awesome` written using `module.exports`, you can

(a) Use `import.meta.require` if you know your code is meant to be executed only on node:

```js
const awesome = import.meta.require("awesome")
```

(b) Manually convert it to `import/export`:

- Fork the github repository
- Run an automatic tool to transform `module.exports` into `import/export`. For instance https://github.com/tbranyen/babel-plugin-transform-commonjs.
- Ensure dependency still works, you may run npm test for that.
- Open a PR with the code written using `import/export` or use your fork directly.

You can reuse this strategy for dependency written in iife, amd or umd.

## Generator not supported

Because we miss a strategy to provide regeneratorRuntime and polyfill in general.

## Sourcemap broken

It's likely because `transform-async-to-promises` used together with `transform-modules-systemjs` generate bad sourcemap.
It means if you use async/await in a platform not supporting it, your sourcemap will not be able to point the original location.
