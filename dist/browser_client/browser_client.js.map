{
  "version": 3,
  "file": "browser_client.js",
  "sources": [
    "../../src/internal/browser_utils/fetch_using_xhr.js",
    "../../src/internal/browser_utils/fetch_browser.js",
    "../../node_modules/@jsenv/logger/src/createDetailedMessage.js",
    "../../src/internal/browser_utils/fetch_and_eval.js",
    "../../node_modules/@jsenv/uneval/src/internal/isComposite.js",
    "../../node_modules/@jsenv/uneval/src/internal/global-value-path.js",
    "../../node_modules/@jsenv/uneval/src/internal/decompose.js",
    "../../node_modules/@jsenv/uneval/src/internal/sortRecipe.js",
    "../../node_modules/@jsenv/uneval/src/internal/escapeString.js",
    "../../node_modules/@jsenv/uneval/src/uneval.js",
    "../../src/internal/runtime_client/uneval_exception.js",
    "../../src/internal/memoize.js",
    "../../node_modules/@jsenv/importmap/src/internal/assertImportMap.js",
    "../../node_modules/@jsenv/importmap/src/internal/hasScheme.js",
    "../../node_modules/@jsenv/importmap/src/internal/urlToScheme.js",
    "../../node_modules/@jsenv/importmap/src/internal/urlToPathname.js",
    "../../node_modules/@jsenv/importmap/src/internal/urlToOrigin.js",
    "../../node_modules/@jsenv/importmap/src/internal/pathnameToParentPathname.js",
    "../../node_modules/@jsenv/importmap/src/resolveUrl.js",
    "../../node_modules/@jsenv/importmap/src/internal/tryUrlResolution.js",
    "../../node_modules/@jsenv/importmap/src/resolveSpecifier.js",
    "../../node_modules/@jsenv/importmap/src/sortImportMap.js",
    "../../node_modules/@jsenv/importmap/src/normalizeImportMap.js",
    "../../node_modules/@jsenv/importmap/src/internal/pathnameToExtension.js",
    "../../node_modules/@jsenv/importmap/src/applyImportMap.js",
    "../../node_modules/@jsenv/importmap/src/resolveImport.js",
    "../../src/internal/runtime_client/module_registration.js",
    "../../src/internal/import_resolution/default_extension.js",
    "../../src/internal/import_resolution/import_resolver_importmap.js",
    "../../src/internal/runtime_client/s.js",
    "../../src/internal/browser_client/browser_system.js",
    "../../src/internal/browser_client/perf_browser.js",
    "../../src/internal/browser_client/module_namespace_transfer.js",
    "../../src/internal/browser_client/browser_client_factory.js",
    "../../src/internal/data_url.js",
    "../../src/internal/sourcemap_utils.js",
    "../../src/internal/windows_file_path_utils.js",
    "../../src/internal/error_stack_remap/remap_call_site.js",
    "../../src/internal/error_stack_remap/remap_stack.js",
    "../../src/internal/error_stack_remap/stringify_stack.js",
    "../../src/internal/error_stack_remap/install_error_stack_remapping.js",
    "../../src/internal/browser_client/browser_error_stack_remap.js",
    "../../src/internal/browser_client/error_in_document.js",
    "../../src/internal/browser_client/error_in_notification.js",
    "../../src/internal/browser_client/browser_client.js"
  ],
  "sourcesContent": [
    "export const fetchUsingXHR = async (\n  url,\n  {\n    signal,\n    method = \"GET\",\n    credentials = \"same-origin\",\n    headers = {},\n    body = null,\n  } = {},\n) => {\n  const headersPromise = createPromiseAndHooks()\n  const bodyPromise = createPromiseAndHooks()\n\n  const xhr = new XMLHttpRequest()\n\n  const failure = (error) => {\n    // if it was already resolved, we must reject the body promise\n    if (headersPromise.settled) {\n      bodyPromise.reject(error)\n    } else {\n      headersPromise.reject(error)\n    }\n  }\n\n  const cleanup = () => {\n    xhr.ontimeout = null\n    xhr.onerror = null\n    xhr.onload = null\n    xhr.onreadystatechange = null\n  }\n\n  xhr.ontimeout = () => {\n    cleanup()\n    failure(new Error(`xhr request timeout on ${url}.`))\n  }\n\n  xhr.onerror = (error) => {\n    cleanup()\n    // unfortunately with have no clue why it fails\n    // might be cors for instance\n    failure(createRequestError(error, { url }))\n  }\n\n  xhr.onload = () => {\n    cleanup()\n    bodyPromise.resolve()\n  }\n\n  signal.addEventListener(\"abort\", () => {\n    xhr.abort()\n    const abortError = new Error(\"aborted\")\n    abortError.name = \"AbortError\"\n    failure(abortError)\n  })\n\n  xhr.onreadystatechange = () => {\n    // https://developer.mozilla.org/fr/docs/Web/API/XMLHttpRequest/readyState\n    const { readyState } = xhr\n\n    if (readyState === 2) {\n      headersPromise.resolve()\n    } else if (readyState === 4) {\n      cleanup()\n      bodyPromise.resolve()\n    }\n  }\n\n  xhr.open(method, url, true)\n  Object.keys(headers).forEach((key) => {\n    xhr.setRequestHeader(key, headers[key])\n  })\n  xhr.withCredentials = computeWithCredentials({ credentials, url })\n  if (\"responseType\" in xhr && hasBlob) {\n    xhr.responseType = \"blob\"\n  }\n  xhr.send(body)\n\n  await headersPromise\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL\n  const responseUrl =\n    \"responseURL\" in xhr ? xhr.responseURL : headers[\"x-request-url\"]\n  let responseStatus = xhr.status\n  const responseStatusText = xhr.statusText\n  const responseHeaders = getHeadersFromXHR(xhr)\n\n  const readBody = async () => {\n    await bodyPromise\n\n    const { status } = xhr\n    // in Chrome on file:/// URLs, status is 0\n    if (status === 0) {\n      responseStatus = 200\n    }\n\n    const body = \"response\" in xhr ? xhr.response : xhr.responseText\n\n    return {\n      responseBody: body,\n      responseBodyType: detectBodyType(body),\n    }\n  }\n\n  const text = async () => {\n    const { responseBody, responseBodyType } = await readBody()\n\n    if (responseBodyType === \"blob\") {\n      return blobToText(responseBody)\n    }\n    if (responseBodyType === \"formData\") {\n      throw new Error(\"could not read FormData body as text\")\n    }\n    if (responseBodyType === \"dataView\") {\n      return arrayBufferToText(responseBody.buffer)\n    }\n    if (responseBodyType === \"arrayBuffer\") {\n      return arrayBufferToText(responseBody)\n    }\n    // if (responseBodyType === \"text\" || responseBodyType === 'searchParams') {\n    //   return body\n    // }\n    return String(responseBody)\n  }\n\n  const json = async () => {\n    const responseText = await text()\n    return JSON.parse(responseText)\n  }\n\n  const blob = async () => {\n    if (!hasBlob) {\n      throw new Error(`blob not supported`)\n    }\n\n    const { responseBody, responseBodyType } = await readBody()\n\n    if (responseBodyType === \"blob\") {\n      return responseBody\n    }\n    if (responseBodyType === \"dataView\") {\n      return new Blob([cloneBuffer(responseBody.buffer)])\n    }\n    if (responseBodyType === \"arrayBuffer\") {\n      return new Blob([cloneBuffer(responseBody)])\n    }\n    if (responseBodyType === \"formData\") {\n      throw new Error(\"could not read FormData body as blob\")\n    }\n    return new Blob([String(responseBody)])\n  }\n\n  const arrayBuffer = async () => {\n    const { responseBody, responseBodyType } = await readBody()\n\n    if (responseBodyType === \"arrayBuffer\") {\n      return cloneBuffer(responseBody)\n    }\n    const responseBlob = await blob()\n    return blobToArrayBuffer(responseBlob)\n  }\n\n  const formData = async () => {\n    if (!hasFormData) {\n      throw new Error(`formData not supported`)\n    }\n    const responseText = await text()\n    return textToFormData(responseText)\n  }\n\n  return {\n    url: responseUrl,\n    status: responseStatus,\n    statusText: responseStatusText,\n    headers: responseHeaders,\n    text,\n    json,\n    blob,\n    arrayBuffer,\n    formData,\n  }\n}\n\nconst canUseBlob = () => {\n  if (typeof window.FileReader !== \"function\") return false\n\n  if (typeof window.Blob !== \"function\") return false\n\n  try {\n    // eslint-disable-next-line no-new\n    new Blob()\n    return true\n  } catch (e) {\n    return false\n  }\n}\n\nconst hasBlob = canUseBlob()\n\nconst hasFormData = typeof window.FormData === \"function\"\n\nconst hasArrayBuffer = typeof window.ArrayBuffer === \"function\"\n\nconst hasSearchParams = typeof window.URLSearchParams === \"function\"\n\nconst createRequestError = (error, { url }) => {\n  return new Error(\n    `error during xhr request on ${url}.\n--- error stack ---\n${error.stack}`,\n  )\n}\n\nconst createPromiseAndHooks = () => {\n  let resolve\n  let reject\n  const promise = new Promise((res, rej) => {\n    resolve = (value) => {\n      promise.settled = true\n      res(value)\n    }\n    reject = (value) => {\n      promise.settled = true\n      rej(value)\n    }\n  })\n  promise.resolve = resolve\n  promise.reject = reject\n  return promise\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\nconst computeWithCredentials = ({ credentials, url }) => {\n  if (credentials === \"same-origin\") {\n    return originSameAsGlobalOrigin(url)\n  }\n  return credentials === \"include\"\n}\n\nconst originSameAsGlobalOrigin = (url) => {\n  // if we cannot read globalOrigin from window.location.origin, let's consider it's ok\n  if (typeof window !== \"object\") return true\n  if (typeof window.location !== \"object\") return true\n  const globalOrigin = window.location.origin\n  if (globalOrigin === \"null\") return true\n  return hrefToOrigin(url) === globalOrigin\n}\n\nconst detectBodyType = (body) => {\n  if (!body) {\n    return \"\"\n  }\n  if (typeof body === \"string\") {\n    return \"text\"\n  }\n  if (hasBlob && Blob.prototype.isPrototypeOf(body)) {\n    return \"blob\"\n  }\n  if (hasFormData && FormData.prototype.isPrototypeOf(body)) {\n    return \"formData\"\n  }\n  if (hasArrayBuffer) {\n    if (hasBlob && isDataView(body)) {\n      return `dataView`\n    }\n    if (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body)) {\n      return `arrayBuffer`\n    }\n  }\n  if (hasSearchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n    return \"searchParams\"\n  }\n  return \"\"\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders#Example\nconst getHeadersFromXHR = (xhr) => {\n  const headerMap = {}\n\n  const headersString = xhr.getAllResponseHeaders()\n  if (headersString === \"\") return headerMap\n\n  const lines = headersString.trim().split(/[\\r\\n]+/)\n  lines.forEach((line) => {\n    const parts = line.split(\": \")\n    const name = parts.shift()\n    const value = parts.join(\": \")\n    headerMap[name.toLowerCase()] = value\n  })\n\n  return headerMap\n}\n\nconst hrefToOrigin = (href) => {\n  const scheme = hrefToScheme(href)\n\n  if (scheme === \"file\") {\n    return \"file://\"\n  }\n\n  if (scheme === \"http\" || scheme === \"https\") {\n    const secondProtocolSlashIndex = scheme.length + \"://\".length\n    const pathnameSlashIndex = href.indexOf(\"/\", secondProtocolSlashIndex)\n\n    if (pathnameSlashIndex === -1) return href\n    return href.slice(0, pathnameSlashIndex)\n  }\n\n  return href.slice(0, scheme.length + 1)\n}\n\nconst hrefToScheme = (href) => {\n  const colonIndex = href.indexOf(\":\")\n  if (colonIndex === -1) return \"\"\n  return href.slice(0, colonIndex)\n}\n\nconst isDataView = (obj) => {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nconst isArrayBufferView =\n  ArrayBuffer.isView ||\n  (() => {\n    const viewClasses = [\n      \"[object Int8Array]\",\n      \"[object Uint8Array]\",\n      \"[object Uint8ClampedArray]\",\n      \"[object Int16Array]\",\n      \"[object Uint16Array]\",\n      \"[object Int32Array]\",\n      \"[object Uint32Array]\",\n      \"[object Float32Array]\",\n      \"[object Float64Array]\",\n    ]\n\n    return (value) => {\n      return (\n        value && viewClasses.includes(Object.prototype.toString.call(value))\n      )\n    }\n  })()\n\nconst textToFormData = (text) => {\n  const form = new FormData()\n  text\n    .trim()\n    .split(\"&\")\n    .forEach(function (bytes) {\n      if (bytes) {\n        const split = bytes.split(\"=\")\n        const name = split.shift().replace(/\\+/g, \" \")\n        const value = split.join(\"=\").replace(/\\+/g, \" \")\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nconst blobToArrayBuffer = async (blob) => {\n  const reader = new FileReader()\n  const promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nconst blobToText = (blob) => {\n  const reader = new FileReader()\n  const promise = fileReaderReady(reader)\n  reader.readAsText(blob)\n  return promise\n}\n\nconst arrayBufferToText = (arrayBuffer) => {\n  const view = new Uint8Array(arrayBuffer)\n  const chars = new Array(view.length)\n  let i = 0\n  while (i < view.length) {\n    chars[i] = String.fromCharCode(view[i])\n\n    i++\n  }\n  return chars.join(\"\")\n}\n\nconst fileReaderReady = (reader) => {\n  return new Promise(function (resolve, reject) {\n    reader.onload = function () {\n      resolve(reader.result)\n    }\n    reader.onerror = function () {\n      reject(reader.error)\n    }\n  })\n}\n\nconst cloneBuffer = (buffer) => {\n  if (buffer.slice) {\n    return buffer.slice(0)\n  }\n  const view = new Uint8Array(buffer.byteLength)\n  view.set(new Uint8Array(buffer))\n  return view.buffer\n}\n",
    "import { fetchUsingXHR } from \"./fetch_using_xhr.js\"\n\nconst fetchNative = async (url, { mode = \"cors\", ...options } = {}) => {\n  const response = await window.fetch(url, {\n    mode,\n    ...options,\n  })\n\n  return {\n    url: response.url,\n    status: response.status,\n    statusText: \"\",\n    headers: responseToHeaders(response),\n    text: () => response.text(),\n    json: () => response.json(),\n    blob: () => response.blob(),\n    arrayBuffer: () => response.arrayBuffer(),\n    formData: () => response.formData(),\n  }\n}\n\nconst responseToHeaders = (response) => {\n  const headers = {}\n  response.headers.forEach((value, name) => {\n    headers[name] = value\n  })\n  return headers\n}\n\nexport const fetchUrl =\n  typeof window.fetch === \"function\" &&\n  typeof window.AbortController === \"function\"\n    ? fetchNative\n    : fetchUsingXHR\n",
    "export const createDetailedMessage = (message, details = {}) => {\n  let string = `${message}`\n\n  Object.keys(details).forEach((key) => {\n    const value = details[key]\n    string += `\n--- ${key} ---\n${\n  Array.isArray(value)\n    ? value.join(`\n`)\n    : value\n}`\n  })\n\n  return string\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\n\nimport { fetchUrl } from \"./fetch_browser.js\"\n\nexport const fetchAndEval = async (url) => {\n  const response = await fetchUrl(url)\n\n  if (response.status >= 200 && response.status <= 299) {\n    const text = await response.text()\n    // eslint-disable-next-line no-eval\n    window.eval(appendSourceURL(text, url))\n  } else {\n    const text = await response.text()\n    throw new Error(\n      createDetailedMessage(`Unexpected response for script.`, {\n        [\"script url\"]: url,\n        [\"response body\"]: text,\n        [\"response status\"]: response.status,\n      }),\n    )\n  }\n}\n\nconst appendSourceURL = (code, sourceURL) => {\n  return `${code}\n${\"//#\"} sourceURL=${sourceURL}`\n}\n",
    "// https://developer.mozilla.org/en-US/docs/Glossary/Primitive\n\nexport const isComposite = (value) => {\n  if (value === null) {\n    return false\n  }\n\n  const type = typeof value\n  if (type === \"object\") {\n    return true\n  }\n\n  if (type === \"function\") {\n    return true\n  }\n\n  return false\n}\n",
    "import { isComposite } from \"./isComposite.js\"\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap\nconst compositeWellKnownMap = new WeakMap()\nconst primitiveWellKnownMap = new Map()\n\nexport const getCompositeGlobalPath = (value) => compositeWellKnownMap.get(value)\n\nexport const getPrimitiveGlobalPath = (value) => primitiveWellKnownMap.get(value)\n\nconst visitGlobalObject = (value) => {\n  const visitValue = (value, path) => {\n    if (isComposite(value)) {\n      // prevent infinite recursion\n      if (compositeWellKnownMap.has(value)) {\n        return\n      }\n      compositeWellKnownMap.set(value, path)\n\n      const visitProperty = (property) => {\n        let descriptor\n        try {\n          descriptor = Object.getOwnPropertyDescriptor(value, property)\n        } catch (e) {\n          if (e.name === \"SecurityError\") {\n            return\n          }\n          throw e\n        }\n\n        if (!descriptor) {\n          // it's apparently possible to have getOwnPropertyNames returning\n          // a property that later returns a null descriptor\n          // for instance window.showModalDialog in webkit 13.0\n          return\n        }\n\n        // do not trigger getter/setter\n        if (\"value\" in descriptor) {\n          const propertyValue = descriptor.value\n          visitValue(propertyValue, [...path, property])\n        }\n      }\n\n      Object.getOwnPropertyNames(value).forEach((name) => visitProperty(name))\n      Object.getOwnPropertySymbols(value).forEach((symbol) => visitProperty(symbol))\n    }\n\n    primitiveWellKnownMap.set(value, path)\n    return\n  }\n\n  visitValue(value, [])\n}\n\nif (typeof window === \"object\") visitGlobalObject(window)\n\nif (typeof global === \"object\") visitGlobalObject(global)\n",
    "/**\n * transforms a javascript value into an object describing it.\n *\n */\n\nimport { isComposite } from \"./isComposite.js\"\nimport { getCompositeGlobalPath, getPrimitiveGlobalPath } from \"./global-value-path.js\"\n\nexport const decompose = (mainValue, { functionAllowed, prototypeStrict, ignoreSymbols }) => {\n  const valueMap = {}\n  const recipeArray = []\n\n  const valueToIdentifier = (value, path = []) => {\n    if (!isComposite(value)) {\n      const existingIdentifier = identifierForPrimitive(value)\n      if (existingIdentifier !== undefined) {\n        return existingIdentifier\n      }\n      const identifier = identifierForNewValue(value)\n      recipeArray[identifier] = primitiveToRecipe(value)\n      return identifier\n    }\n\n    if (typeof Promise === \"function\" && value instanceof Promise) {\n      throw new Error(createPromiseAreNotSupportedMessage({ path }))\n    }\n    if (typeof WeakSet === \"function\" && value instanceof WeakSet) {\n      throw new Error(createWeakSetAreNotSupportedMessage({ path }))\n    }\n    if (typeof WeakMap === \"function\" && value instanceof WeakMap) {\n      throw new Error(createWeakMapAreNotSupportedMessage({ path }))\n    }\n    if (typeof value === \"function\" && !functionAllowed) {\n      throw new Error(createForbiddenFunctionMessage({ path }))\n    }\n\n    const existingIdentifier = identifierForComposite(value)\n    if (existingIdentifier !== undefined) {\n      return existingIdentifier\n    }\n    const identifier = identifierForNewValue(value)\n\n    const compositeGlobalPath = getCompositeGlobalPath(value)\n    if (compositeGlobalPath) {\n      recipeArray[identifier] = createGlobalReferenceRecipe(compositeGlobalPath)\n      return identifier\n    }\n\n    const propertyDescriptionArray = []\n    Object.getOwnPropertyNames(value).forEach((propertyName) => {\n      const propertyDescriptor = Object.getOwnPropertyDescriptor(value, propertyName)\n      const propertyNameIdentifier = valueToIdentifier(propertyName, [...path, propertyName])\n      const propertyDescription = computePropertyDescription(propertyDescriptor, propertyName, path)\n      propertyDescriptionArray.push({ propertyNameIdentifier, propertyDescription })\n    })\n\n    const symbolDescriptionArray = []\n    if (!ignoreSymbols) {\n      Object.getOwnPropertySymbols(value).forEach((symbol) => {\n        const propertyDescriptor = Object.getOwnPropertyDescriptor(value, symbol)\n        const symbolIdentifier = valueToIdentifier(symbol, [...path, `[${symbol.toString()}]`])\n        const propertyDescription = computePropertyDescription(propertyDescriptor, symbol, path)\n        symbolDescriptionArray.push({ symbolIdentifier, propertyDescription })\n      })\n    }\n\n    const methodDescriptionArray = computeMethodDescriptionArray(value, path)\n\n    const extensible = Object.isExtensible(value)\n\n    recipeArray[identifier] = createCompositeRecipe({\n      propertyDescriptionArray,\n      symbolDescriptionArray,\n      methodDescriptionArray,\n      extensible,\n    })\n    return identifier\n  }\n\n  const computePropertyDescription = (propertyDescriptor, propertyNameOrSymbol, path) => {\n    if (propertyDescriptor.set && !functionAllowed) {\n      throw new Error(createForbiddenPropertySetterMessage({ path, propertyNameOrSymbol }))\n    }\n    if (propertyDescriptor.get && !functionAllowed) {\n      throw new Error(createForbiddenPropertyGetterMessage({ path, propertyNameOrSymbol }))\n    }\n\n    return {\n      configurable: propertyDescriptor.configurable,\n      writable: propertyDescriptor.writable,\n      enumerable: propertyDescriptor.enumerable,\n      getIdentifier:\n        \"get\" in propertyDescriptor\n          ? valueToIdentifier(propertyDescriptor.get, [\n              ...path,\n              String(propertyNameOrSymbol),\n              \"[[descriptor:get]]\",\n            ])\n          : undefined,\n      setIdentifier:\n        \"set\" in propertyDescriptor\n          ? valueToIdentifier(propertyDescriptor.set, [\n              ...path,\n              String(propertyNameOrSymbol),\n              \"[[descriptor:set]]\",\n            ])\n          : undefined,\n      valueIdentifier:\n        \"value\" in propertyDescriptor\n          ? valueToIdentifier(propertyDescriptor.value, [\n              ...path,\n              String(propertyNameOrSymbol),\n              \"[[descriptor:value]]\",\n            ])\n          : undefined,\n    }\n  }\n\n  const computeMethodDescriptionArray = (value, path) => {\n    const methodDescriptionArray = []\n\n    if (typeof Set === \"function\" && value instanceof Set) {\n      const callArray = []\n      value.forEach((entryValue, index) => {\n        const entryValueIdentifier = valueToIdentifier(entryValue, [\n          ...path,\n          `[[SetEntryValue]]`,\n          index,\n        ])\n        callArray.push([entryValueIdentifier])\n      })\n      methodDescriptionArray.push({ methodNameIdentifier: valueToIdentifier(\"add\"), callArray })\n    }\n\n    if (typeof Map === \"function\" && value instanceof Map) {\n      const callArray = []\n      value.forEach((entryValue, entryKey) => {\n        const entryKeyIdentifier = valueToIdentifier(entryKey, [\n          ...path,\n          \"[[MapEntryKey]]\",\n          entryKey,\n        ])\n        const entryValueIdentifier = valueToIdentifier(entryValue, [\n          ...path,\n          \"[[MapEntryValue]]\",\n          entryValue,\n        ])\n        callArray.push([entryKeyIdentifier, entryValueIdentifier])\n      })\n      methodDescriptionArray.push({ methodNameIdentifier: valueToIdentifier(\"set\"), callArray })\n    }\n\n    return methodDescriptionArray\n  }\n\n  const identifierForPrimitive = (value) => {\n    return Object.keys(valueMap).find((existingIdentifier) => {\n      const existingValue = valueMap[existingIdentifier]\n      if (Object.is(value, existingValue)) return true\n      return value === existingValue\n    })\n  }\n\n  const identifierForComposite = (value) => {\n    return Object.keys(valueMap).find((existingIdentifier) => {\n      const existingValue = valueMap[existingIdentifier]\n      return value === existingValue\n    })\n  }\n\n  const identifierForNewValue = (value) => {\n    const identifier = nextIdentifier()\n    valueMap[identifier] = value\n    return identifier\n  }\n\n  let currentIdentifier = -1\n  const nextIdentifier = () => {\n    const identifier = String(parseInt(currentIdentifier) + 1)\n    currentIdentifier = identifier\n    return identifier\n  }\n\n  const mainIdentifier = valueToIdentifier(mainValue)\n\n  // prototype, important to keep after the whole structure was visited\n  // so that we discover if any prototype is part of the value\n  const prototypeValueToIdentifier = (prototypeValue) => {\n    // prototype is null\n    if (prototypeValue === null) {\n      return valueToIdentifier(prototypeValue)\n    }\n\n    // prototype found somewhere already\n    const prototypeExistingIdentifier = identifierForComposite(prototypeValue)\n    if (prototypeExistingIdentifier !== undefined) {\n      return prototypeExistingIdentifier\n    }\n\n    // mark prototype as visited\n    const prototypeIdentifier = identifierForNewValue(prototypeValue)\n\n    // prototype is a global reference ?\n    const prototypeGlobalPath = getCompositeGlobalPath(prototypeValue)\n    if (prototypeGlobalPath) {\n      recipeArray[prototypeIdentifier] = createGlobalReferenceRecipe(prototypeGlobalPath)\n      return prototypeIdentifier\n    }\n\n    // otherwise prototype is unknown\n    if (prototypeStrict) {\n      throw new Error(createUnknownPrototypeMessage({ prototypeValue }))\n    }\n\n    return prototypeValueToIdentifier(Object.getPrototypeOf(prototypeValue), true)\n  }\n  const identifierForValueOf = (value, path = []) => {\n    if (value instanceof Array) {\n      return valueToIdentifier(value.length, [...path, \"length\"])\n    }\n\n    if (\"valueOf\" in value === false) {\n      return undefined\n    }\n\n    if (typeof value.valueOf !== \"function\") {\n      return undefined\n    }\n\n    const valueOfReturnValue = value.valueOf()\n    if (!isComposite(valueOfReturnValue)) {\n      return valueToIdentifier(valueOfReturnValue, [...path, \"valueOf()\"])\n    }\n\n    if (valueOfReturnValue === value) {\n      return undefined\n    }\n\n    throw new Error(createUnexpectedValueOfReturnValueMessage())\n  }\n\n  recipeArray.slice().forEach((recipe, index) => {\n    if (recipe.type === \"composite\") {\n      const value = valueMap[index]\n\n      if (typeof value === \"function\") {\n        const valueOfIdentifier = nextIdentifier()\n        recipeArray[valueOfIdentifier] = {\n          type: \"primitive\",\n          value,\n        }\n        recipe.valueOfIdentifier = valueOfIdentifier\n        return\n      }\n\n      if (value instanceof RegExp) {\n        const valueOfIdentifier = nextIdentifier()\n        recipeArray[valueOfIdentifier] = {\n          type: \"primitive\",\n          value,\n        }\n        recipe.valueOfIdentifier = valueOfIdentifier\n        return\n      }\n\n      // valueOf, mandatory to uneval new Date(10) for instance.\n      recipe.valueOfIdentifier = identifierForValueOf(value)\n      const prototypeValue = Object.getPrototypeOf(value)\n      recipe.prototypeIdentifier = prototypeValueToIdentifier(prototypeValue, true)\n    }\n  })\n\n  return {\n    recipeArray,\n    mainIdentifier,\n    valueMap,\n  }\n}\n\nconst primitiveToRecipe = (value) => {\n  if (typeof value === \"symbol\") {\n    return symbolToRecipe(value)\n  }\n\n  return createPimitiveRecipe(value)\n}\n\nconst symbolToRecipe = (symbol) => {\n  const globalSymbolKey = Symbol.keyFor(symbol)\n  if (globalSymbolKey !== undefined) {\n    return createGlobalSymbolRecipe(globalSymbolKey)\n  }\n\n  const symbolGlobalPath = getPrimitiveGlobalPath(symbol)\n  if (!symbolGlobalPath) {\n    throw new Error(createUnknownSymbolMessage({ symbol }))\n  }\n\n  return createGlobalReferenceRecipe(symbolGlobalPath)\n}\n\nconst createPimitiveRecipe = (value) => {\n  return {\n    type: \"primitive\",\n    value,\n  }\n}\n\nconst createGlobalReferenceRecipe = (path) => {\n  const recipe = {\n    type: \"global-reference\",\n    path,\n  }\n  return recipe\n}\n\nconst createGlobalSymbolRecipe = (key) => {\n  return {\n    type: \"global-symbol\",\n    key,\n  }\n}\n\nconst createCompositeRecipe = ({\n  prototypeIdentifier,\n  valueOfIdentifier,\n  propertyDescriptionArray,\n  symbolDescriptionArray,\n  methodDescriptionArray,\n  extensible,\n}) => {\n  return {\n    type: \"composite\",\n    prototypeIdentifier,\n    valueOfIdentifier,\n    propertyDescriptionArray,\n    symbolDescriptionArray,\n    methodDescriptionArray,\n    extensible,\n  }\n}\n\nconst createPromiseAreNotSupportedMessage = ({ path }) => {\n  if (path.length === 0) {\n    return `promise are not supported.`\n  }\n\n  return `promise are not supported.\npromise found at: ${path.join(\"\")}`\n}\n\nconst createWeakSetAreNotSupportedMessage = ({ path }) => {\n  if (path.length === 0) {\n    return `weakSet are not supported.`\n  }\n\n  return `weakSet are not supported.\nweakSet found at: ${path.join(\"\")}`\n}\n\nconst createWeakMapAreNotSupportedMessage = ({ path }) => {\n  if (path.length === 0) {\n    return `weakMap are not supported.`\n  }\n\n  return `weakMap are not supported.\nweakMap found at: ${path.join(\"\")}`\n}\n\nconst createForbiddenFunctionMessage = ({ path }) => {\n  if (path.length === 0) {\n    return `function are not allowed.`\n  }\n\n  return `function are not allowed.\nfunction found at: ${path.join(\"\")}`\n}\n\nconst createForbiddenPropertyGetterMessage = ({\n  path,\n  propertyNameOrSymbol,\n}) => `property getter are not allowed.\ngetter found on property: ${String(propertyNameOrSymbol)}\nat: ${path.join(\"\")}`\n\nconst createForbiddenPropertySetterMessage = ({\n  path,\n  propertyNameOrSymbol,\n}) => `property setter are not allowed.\nsetter found on property: ${String(propertyNameOrSymbol)}\nat: ${path.join(\"\")}`\n\nconst createUnexpectedValueOfReturnValueMessage = () =>\n  `valueOf() must return a primitive of the object itself.`\n\nconst createUnknownSymbolMessage = ({\n  symbol,\n}) => `symbol must be global, like Symbol.iterator, or created using Symbol.for().\nsymbol: ${symbol.toString()}`\n\nconst createUnknownPrototypeMessage = ({ prototypeValue }) =>\n  `prototype must be global, like Object.prototype, or somewhere in the value.\nprototype constructor name: ${prototypeValue.constructor.name}`\n",
    "// be carefull because this function is mutating recipe objects inside the recipeArray.\n// this is not an issue because each recipe object is not accessible from the outside\n// when used internally by uneval\nexport const sortRecipe = (recipeArray) => {\n  const findInRecipePrototypeChain = (recipe, callback) => {\n    let currentRecipe = recipe\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      if (currentRecipe.type !== \"composite\") {\n        break\n      }\n\n      const prototypeIdentifier = currentRecipe.prototypeIdentifier\n      if (prototypeIdentifier === undefined) {\n        break\n      }\n\n      currentRecipe = recipeArray[prototypeIdentifier]\n\n      if (callback(currentRecipe, prototypeIdentifier)) {\n        return prototypeIdentifier\n      }\n    }\n    return undefined\n  }\n\n  const recipeArrayOrdered = recipeArray.slice()\n  recipeArrayOrdered.sort((leftRecipe, rightRecipe) => {\n    const leftType = leftRecipe.type\n    const rightType = rightRecipe.type\n\n    if (leftType === \"composite\" && rightType === \"composite\") {\n      const rightRecipeIsInLeftRecipePrototypeChain = findInRecipePrototypeChain(\n        leftRecipe,\n        (recipeCandidate) => recipeCandidate === rightRecipe,\n      )\n      // if left recipe requires right recipe, left must be after right\n      if (rightRecipeIsInLeftRecipePrototypeChain) {\n        return 1\n      }\n\n      const leftRecipeIsInRightRecipePrototypeChain = findInRecipePrototypeChain(\n        rightRecipe,\n        (recipeCandidate) => recipeCandidate === leftRecipe,\n      )\n      // if right recipe requires left recipe, right must be after left\n      if (leftRecipeIsInRightRecipePrototypeChain) {\n        return -1\n      }\n    }\n\n    if (leftType !== rightType) {\n      // if left is a composite, left must be after right\n      if (leftType === \"composite\") {\n        return 1\n      }\n\n      // if right is a composite, right must be after left\n      if (rightType === \"composite\") {\n        return -1\n      }\n    }\n\n    const leftIndex = recipeArray.indexOf(leftRecipe)\n    const rightIndex = recipeArray.indexOf(rightRecipe)\n    // left was before right, don't change that\n    if (leftIndex < rightIndex) {\n      return -1\n    }\n\n    // right was after left, don't change that\n    return 1\n  })\n\n  return recipeArrayOrdered\n}\n",
    "// https://github.com/joliss/js-string-escape/blob/master/index.js\n// http://javascript.crockford.com/remedial.html\nexport const escapeString = (value) => {\n  const string = String(value)\n  let i = 0\n  const j = string.length\n  var escapedString = \"\"\n  while (i < j) {\n    const char = string[i]\n    let escapedChar\n    if (char === '\"' || char === \"'\" || char === \"\\\\\") {\n      escapedChar = `\\\\${char}`\n    } else if (char === \"\\n\") {\n      escapedChar = \"\\\\n\"\n    } else if (char === \"\\r\") {\n      escapedChar = \"\\\\r\"\n    } else if (char === \"\\u2028\") {\n      escapedChar = \"\\\\u2028\"\n    } else if (char === \"\\u2029\") {\n      escapedChar = \"\\\\u2029\"\n    } else {\n      escapedChar = char\n    }\n    escapedString += escapedChar\n    i++\n  }\n  return escapedString\n}\n",
    "import { decompose } from \"./internal/decompose.js\"\nimport { sortRecipe } from \"./internal/sortRecipe.js\"\nimport { escapeString } from \"./internal/escapeString.js\"\n\nexport const uneval = (\n  value,\n  { functionAllowed = false, prototypeStrict = false, ignoreSymbols = false } = {},\n) => {\n  const { recipeArray, mainIdentifier, valueMap } = decompose(value, {\n    functionAllowed,\n    prototypeStrict,\n    ignoreSymbols,\n  })\n  const recipeArraySorted = sortRecipe(recipeArray)\n\n  let source = `(function () {\nvar globalObject\ntry {\n  globalObject = Function('return this')() || (42, eval)('this');\n} catch(e) {\n  globalObject = window;\n}\n\nfunction safeDefineProperty(object, propertyNameOrSymbol, descriptor) {\n  var currentDescriptor = Object.getOwnPropertyDescriptor(object, propertyNameOrSymbol);\n  if (currentDescriptor && !currentDescriptor.configurable) return\n  Object.defineProperty(object, propertyNameOrSymbol, descriptor)\n};\n`\n\n  const variableNameMap = {}\n  recipeArray.forEach((recipe, index) => {\n    const indexSorted = recipeArraySorted.indexOf(recipe)\n    variableNameMap[index] = `_${indexSorted}`\n  })\n\n  const identifierToVariableName = (identifier) => variableNameMap[identifier]\n\n  const recipeToSetupSource = (recipe) => {\n    if (recipe.type === \"primitive\") return primitiveRecipeToSetupSource(recipe)\n    if (recipe.type === \"global-symbol\") return globalSymbolRecipeToSetupSource(recipe)\n    if (recipe.type === \"global-reference\") return globalReferenceRecipeToSetupSource(recipe)\n    return compositeRecipeToSetupSource(recipe)\n  }\n\n  const primitiveRecipeToSetupSource = ({ value }) => {\n    const type = typeof value\n\n    if (type === \"string\") {\n      return `\"${escapeString(value)}\";`\n    }\n\n    if (type === \"bigint\") {\n      return `${value.toString()}n`\n    }\n\n    if (Object.is(value, -0)) {\n      return \"-0;\"\n    }\n\n    return `${String(value)};`\n  }\n\n  const globalSymbolRecipeToSetupSource = (recipe) => {\n    return `Symbol.for(\"${escapeString(recipe.key)}\");`\n  }\n\n  const globalReferenceRecipeToSetupSource = (recipe) => {\n    const pathSource = recipe.path.map((part) => `[\"${escapeString(part)}\"]`).join(\"\")\n    return `globalObject${pathSource};`\n  }\n\n  const compositeRecipeToSetupSource = ({ prototypeIdentifier, valueOfIdentifier }) => {\n    if (prototypeIdentifier === undefined) {\n      return identifierToVariableName(valueOfIdentifier)\n    }\n\n    const prototypeValue = valueMap[prototypeIdentifier]\n    if (prototypeValue === null) {\n      return `Object.create(null);`\n    }\n\n    const prototypeConstructor = prototypeValue.constructor\n    if (prototypeConstructor === Object) {\n      return `Object.create(${identifierToVariableName(prototypeIdentifier)});`\n    }\n\n    if (valueOfIdentifier === undefined) {\n      return `new ${prototypeConstructor.name}();`\n    }\n\n    if (prototypeConstructor.name === \"BigInt\") {\n      return `Object(${identifierToVariableName(valueOfIdentifier)})`\n    }\n\n    return `new ${prototypeConstructor.name}(${identifierToVariableName(valueOfIdentifier)});`\n  }\n\n  recipeArraySorted.forEach((recipe) => {\n    const recipeVariableName = identifierToVariableName(recipeArray.indexOf(recipe))\n    source += `var ${recipeVariableName} = ${recipeToSetupSource(recipe, recipeVariableName)}\n`\n  })\n\n  const recipeToMutateSource = (recipe, recipeVariableName) => {\n    if (recipe.type === \"composite\") {\n      return compositeRecipeToMutateSource(recipe, recipeVariableName)\n    }\n    return ``\n  }\n\n  const compositeRecipeToMutateSource = (\n    { propertyDescriptionArray, symbolDescriptionArray, methodDescriptionArray, extensible },\n    recipeVariableName,\n  ) => {\n    let mutateSource = ``\n\n    propertyDescriptionArray.forEach(({ propertyNameIdentifier, propertyDescription }) => {\n      mutateSource += generateDefinePropertySource(\n        recipeVariableName,\n        propertyNameIdentifier,\n        propertyDescription,\n      )\n    })\n\n    symbolDescriptionArray.forEach(({ symbolIdentifier, propertyDescription }) => {\n      mutateSource += generateDefinePropertySource(\n        recipeVariableName,\n        symbolIdentifier,\n        propertyDescription,\n      )\n    })\n\n    methodDescriptionArray.forEach(({ methodNameIdentifier, callArray }) => {\n      mutateSource += generateMethodCallSource(recipeVariableName, methodNameIdentifier, callArray)\n    })\n\n    if (!extensible) {\n      mutateSource += generatePreventExtensionSource(recipeVariableName)\n    }\n\n    return mutateSource\n  }\n\n  const generateDefinePropertySource = (\n    recipeVariableName,\n    propertyNameOrSymbolIdentifier,\n    propertyDescription,\n  ) => {\n    const propertyOrSymbolVariableName = identifierToVariableName(propertyNameOrSymbolIdentifier)\n\n    const propertyDescriptorSource = generatePropertyDescriptorSource(propertyDescription)\n    return `safeDefineProperty(${recipeVariableName}, ${propertyOrSymbolVariableName}, ${propertyDescriptorSource});`\n  }\n\n  const generatePropertyDescriptorSource = ({\n    configurable,\n    writable,\n    enumerable,\n    getIdentifier,\n    setIdentifier,\n    valueIdentifier,\n  }) => {\n    if (valueIdentifier === undefined) {\n      return `{\n  configurable: ${configurable},\n  enumerable: ${enumerable},\n  get: ${getIdentifier === undefined ? undefined : identifierToVariableName(getIdentifier)},\n  set: ${setIdentifier === undefined ? undefined : identifierToVariableName(setIdentifier)},\n}`\n    }\n\n    return `{\n  configurable: ${configurable},\n  writable: ${writable},\n  enumerable: ${enumerable},\n  value: ${valueIdentifier === undefined ? undefined : identifierToVariableName(valueIdentifier)}\n}`\n  }\n\n  const generateMethodCallSource = (recipeVariableName, methodNameIdentifier, callArray) => {\n    let methodCallSource = ``\n\n    const methodVariableName = identifierToVariableName(methodNameIdentifier)\n    callArray.forEach((argumentIdentifiers) => {\n      const argumentVariableNames = argumentIdentifiers.map((argumentIdentifier) =>\n        identifierToVariableName(argumentIdentifier),\n      )\n\n      methodCallSource += `${recipeVariableName}[${methodVariableName}](${argumentVariableNames.join(\n        \",\",\n      )});`\n    })\n\n    return methodCallSource\n  }\n\n  const generatePreventExtensionSource = (recipeVariableName) => {\n    return `Object.preventExtensions(${recipeVariableName});`\n  }\n\n  recipeArraySorted.forEach((recipe) => {\n    const recipeVariableName = identifierToVariableName(recipeArray.indexOf(recipe))\n    source += `${recipeToMutateSource(recipe, recipeVariableName)}`\n  })\n\n  source += `return ${identifierToVariableName(mainIdentifier)}; })()`\n\n  return source\n}\n",
    "import { uneval } from \"@jsenv/uneval\"\n\nexport const unevalException = (value) => {\n  if (value && value.hasOwnProperty(\"toString\")) {\n    delete value.toString\n  }\n  return uneval(value, { ignoreSymbols: true })\n}\n",
    "export const memoize = (compute) => {\n  let memoized = false\n  let memoizedValue\n\n  const fnWithMemoization = (...args) => {\n    if (memoized) {\n      return memoizedValue\n    }\n    // if compute is recursive wait for it to be fully done before storing the lockValue\n    // so set locked later\n    memoizedValue = compute(...args)\n    memoized = true\n    return memoizedValue\n  }\n\n  fnWithMemoization.forget = () => {\n    const value = memoizedValue\n    memoized = false\n    memoizedValue = undefined\n    return value\n  }\n\n  return fnWithMemoization\n}\n",
    "export const assertImportMap = (value) => {\n  if (value === null) {\n    throw new TypeError(`an importMap must be an object, got null`)\n  }\n\n  const type = typeof value\n  if (type !== \"object\") {\n    throw new TypeError(`an importMap must be an object, received ${value}`)\n  }\n\n  if (Array.isArray(value)) {\n    throw new TypeError(\n      `an importMap must be an object, received array ${value}`,\n    )\n  }\n}\n",
    "export const hasScheme = (string) => {\n  return /^[a-zA-Z]{2,}:/.test(string)\n}\n",
    "export const urlToScheme = (urlString) => {\n  const colonIndex = urlString.indexOf(\":\")\n  if (colonIndex === -1) return \"\"\n  return urlString.slice(0, colonIndex)\n}\n",
    "import { urlToScheme } from \"./urlToScheme.js\"\n\nexport const urlToPathname = (urlString) => {\n  return ressourceToPathname(urlToRessource(urlString))\n}\n\nconst urlToRessource = (urlString) => {\n  const scheme = urlToScheme(urlString)\n\n  if (scheme === \"file\") {\n    return urlString.slice(\"file://\".length)\n  }\n\n  if (scheme === \"https\" || scheme === \"http\") {\n    // remove origin\n    const afterProtocol = urlString.slice(scheme.length + \"://\".length)\n    const pathnameSlashIndex = afterProtocol.indexOf(\"/\", \"://\".length)\n    return afterProtocol.slice(pathnameSlashIndex)\n  }\n\n  return urlString.slice(scheme.length + 1)\n}\n\nconst ressourceToPathname = (ressource) => {\n  const searchSeparatorIndex = ressource.indexOf(\"?\")\n  return searchSeparatorIndex === -1\n    ? ressource\n    : ressource.slice(0, searchSeparatorIndex)\n}\n",
    "import { urlToScheme } from \"./urlToScheme.js\"\n\nexport const urlToOrigin = (urlString) => {\n  const scheme = urlToScheme(urlString)\n\n  if (scheme === \"file\") {\n    return \"file://\"\n  }\n\n  if (scheme === \"http\" || scheme === \"https\") {\n    const secondProtocolSlashIndex = scheme.length + \"://\".length\n    const pathnameSlashIndex = urlString.indexOf(\"/\", secondProtocolSlashIndex)\n\n    if (pathnameSlashIndex === -1) return urlString\n    return urlString.slice(0, pathnameSlashIndex)\n  }\n\n  return urlString.slice(0, scheme.length + 1)\n}\n",
    "export const pathnameToParentPathname = (pathname) => {\n  const slashLastIndex = pathname.lastIndexOf(\"/\")\n  if (slashLastIndex === -1) {\n    return \"/\"\n  }\n\n  return pathname.slice(0, slashLastIndex + 1)\n}\n",
    "// could be useful: https://url.spec.whatwg.org/#url-miscellaneous\n\nimport { urlToScheme } from \"./internal/urlToScheme.js\"\nimport { urlToPathname } from \"./internal/urlToPathname.js\"\nimport { urlToOrigin } from \"./internal/urlToOrigin.js\"\nimport { pathnameToParentPathname } from \"./internal/pathnameToParentPathname.js\"\nimport { hasScheme } from \"./internal/hasScheme.js\"\n\nexport const resolveUrl = (specifier, baseUrl) => {\n  if (baseUrl) {\n    if (typeof baseUrl !== \"string\") {\n      throw new TypeError(writeBaseUrlMustBeAString({ baseUrl, specifier }))\n    }\n    if (!hasScheme(baseUrl)) {\n      throw new Error(writeBaseUrlMustBeAbsolute({ baseUrl, specifier }))\n    }\n  }\n\n  if (hasScheme(specifier)) {\n    return specifier\n  }\n\n  if (!baseUrl) {\n    throw new Error(writeBaseUrlRequired({ baseUrl, specifier }))\n  }\n\n  // scheme relative\n  if (specifier.slice(0, 2) === \"//\") {\n    return `${urlToScheme(baseUrl)}:${specifier}`\n  }\n\n  // origin relative\n  if (specifier[0] === \"/\") {\n    return `${urlToOrigin(baseUrl)}${specifier}`\n  }\n\n  const baseOrigin = urlToOrigin(baseUrl)\n  const basePathname = urlToPathname(baseUrl)\n\n  if (specifier === \".\") {\n    const baseDirectoryPathname = pathnameToParentPathname(basePathname)\n    return `${baseOrigin}${baseDirectoryPathname}`\n  }\n\n  // pathname relative inside\n  if (specifier.slice(0, 2) === \"./\") {\n    const baseDirectoryPathname = pathnameToParentPathname(basePathname)\n    return `${baseOrigin}${baseDirectoryPathname}${specifier.slice(2)}`\n  }\n\n  // pathname relative outside\n  if (specifier.slice(0, 3) === \"../\") {\n    let unresolvedPathname = specifier\n    const importerFolders = basePathname.split(\"/\")\n    importerFolders.pop()\n\n    while (unresolvedPathname.slice(0, 3) === \"../\") {\n      unresolvedPathname = unresolvedPathname.slice(3)\n      // when there is no folder left to resolved\n      // we just ignore '../'\n      if (importerFolders.length) {\n        importerFolders.pop()\n      }\n    }\n\n    const resolvedPathname = `${importerFolders.join(\n      \"/\",\n    )}/${unresolvedPathname}`\n    return `${baseOrigin}${resolvedPathname}`\n  }\n\n  // bare\n  if (basePathname === \"\") {\n    return `${baseOrigin}/${specifier}`\n  }\n  if (basePathname[basePathname.length] === \"/\") {\n    return `${baseOrigin}${basePathname}${specifier}`\n  }\n  return `${baseOrigin}${pathnameToParentPathname(basePathname)}${specifier}`\n}\n\nconst writeBaseUrlMustBeAString = ({\n  baseUrl,\n  specifier,\n}) => `baseUrl must be a string.\n--- base url ---\n${baseUrl}\n--- specifier ---\n${specifier}`\n\nconst writeBaseUrlMustBeAbsolute = ({\n  baseUrl,\n  specifier,\n}) => `baseUrl must be absolute.\n--- base url ---\n${baseUrl}\n--- specifier ---\n${specifier}`\n\nconst writeBaseUrlRequired = ({\n  baseUrl,\n  specifier,\n}) => `baseUrl required to resolve relative specifier.\n--- base url ---\n${baseUrl}\n--- specifier ---\n${specifier}`\n",
    "import { hasScheme } from \"./hasScheme.js\"\nimport { resolveUrl } from \"../resolveUrl.js\"\n\nexport const tryUrlResolution = (string, url) => {\n  const result = resolveUrl(string, url)\n  return hasScheme(result) ? result : null\n}\n",
    "import { hasScheme } from \"./internal/hasScheme.js\"\nimport { resolveUrl } from \"./resolveUrl.js\"\n\nexport const resolveSpecifier = (specifier, importer) => {\n  if (\n    specifier === \".\" ||\n    specifier[0] === \"/\" ||\n    specifier.startsWith(\"./\") ||\n    specifier.startsWith(\"../\")\n  ) {\n    return resolveUrl(specifier, importer)\n  }\n\n  if (hasScheme(specifier)) {\n    return specifier\n  }\n\n  return null\n}\n",
    "import { assertImportMap } from \"./internal/assertImportMap.js\"\n\nexport const sortImportMap = (importMap) => {\n  assertImportMap(importMap)\n\n  const { imports, scopes } = importMap\n\n  return {\n    ...(imports ? { imports: sortImports(imports) } : {}),\n    ...(scopes ? { scopes: sortScopes(scopes) } : {}),\n  }\n}\n\nexport const sortImports = (imports) => {\n  const mappingsSorted = {}\n\n  Object.keys(imports)\n    .sort(compareLengthOrLocaleCompare)\n    .forEach((name) => {\n      mappingsSorted[name] = imports[name]\n    })\n\n  return mappingsSorted\n}\n\nexport const sortScopes = (scopes) => {\n  const scopesSorted = {}\n\n  Object.keys(scopes)\n    .sort(compareLengthOrLocaleCompare)\n    .forEach((scopeSpecifier) => {\n      scopesSorted[scopeSpecifier] = sortImports(scopes[scopeSpecifier])\n    })\n\n  return scopesSorted\n}\n\nconst compareLengthOrLocaleCompare = (a, b) => {\n  return b.length - a.length || a.localeCompare(b)\n}\n",
    "import { assertImportMap } from \"./internal/assertImportMap.js\"\nimport { tryUrlResolution } from \"./internal/tryUrlResolution.js\"\nimport { resolveSpecifier } from \"./resolveSpecifier.js\"\nimport { sortImports, sortScopes } from \"./sortImportMap.js\"\n\nexport const normalizeImportMap = (importMap, baseUrl) => {\n  assertImportMap(importMap)\n\n  if (!isStringOrUrl(baseUrl)) {\n    throw new TypeError(formulateBaseUrlMustBeStringOrUrl({ baseUrl }))\n  }\n\n  const { imports, scopes } = importMap\n\n  return {\n    imports: imports ? normalizeMappings(imports, baseUrl) : undefined,\n    scopes: scopes ? normalizeScopes(scopes, baseUrl) : undefined,\n  }\n}\n\nconst isStringOrUrl = (value) => {\n  if (typeof value === \"string\") {\n    return true\n  }\n\n  if (typeof URL === \"function\" && value instanceof URL) {\n    return true\n  }\n\n  return false\n}\n\nconst normalizeMappings = (mappings, baseUrl) => {\n  const mappingsNormalized = {}\n\n  Object.keys(mappings).forEach((specifier) => {\n    const address = mappings[specifier]\n\n    if (typeof address !== \"string\") {\n      console.warn(\n        formulateAddressMustBeAString({\n          address,\n          specifier,\n        }),\n      )\n      return\n    }\n\n    const specifierResolved = resolveSpecifier(specifier, baseUrl) || specifier\n\n    const addressUrl = tryUrlResolution(address, baseUrl)\n    if (addressUrl === null) {\n      console.warn(\n        formulateAdressResolutionFailed({\n          address,\n          baseUrl,\n          specifier,\n        }),\n      )\n      return\n    }\n\n    if (specifier.endsWith(\"/\") && !addressUrl.endsWith(\"/\")) {\n      console.warn(\n        formulateAddressUrlRequiresTrailingSlash({\n          addressUrl,\n          address,\n          specifier,\n        }),\n      )\n      return\n    }\n    mappingsNormalized[specifierResolved] = addressUrl\n  })\n\n  return sortImports(mappingsNormalized)\n}\n\nconst normalizeScopes = (scopes, baseUrl) => {\n  const scopesNormalized = {}\n\n  Object.keys(scopes).forEach((scopeSpecifier) => {\n    const scopeMappings = scopes[scopeSpecifier]\n    const scopeUrl = tryUrlResolution(scopeSpecifier, baseUrl)\n    if (scopeUrl === null) {\n      console.warn(\n        formulateScopeResolutionFailed({\n          scope: scopeSpecifier,\n          baseUrl,\n        }),\n      )\n      return\n    }\n    const scopeValueNormalized = normalizeMappings(scopeMappings, baseUrl)\n    scopesNormalized[scopeUrl] = scopeValueNormalized\n  })\n\n  return sortScopes(scopesNormalized)\n}\n\nconst formulateBaseUrlMustBeStringOrUrl = ({\n  baseUrl,\n}) => `baseUrl must be a string or an url.\n--- base url ---\n${baseUrl}`\n\nconst formulateAddressMustBeAString = ({\n  specifier,\n  address,\n}) => `Address must be a string.\n--- address ---\n${address}\n--- specifier ---\n${specifier}`\n\nconst formulateAdressResolutionFailed = ({\n  address,\n  baseUrl,\n  specifier,\n}) => `Address url resolution failed.\n--- address ---\n${address}\n--- base url ---\n${baseUrl}\n--- specifier ---\n${specifier}`\n\nconst formulateAddressUrlRequiresTrailingSlash = ({\n  addressURL,\n  address,\n  specifier,\n}) => `Address must end with /.\n--- address url ---\n${addressURL}\n--- address ---\n${address}\n--- specifier ---\n${specifier}`\n\nconst formulateScopeResolutionFailed = ({\n  scope,\n  baseUrl,\n}) => `Scope url resolution failed.\n--- scope ---\n${scope}\n--- base url ---\n${baseUrl}`\n",
    "export const pathnameToExtension = (pathname) => {\n  const slashLastIndex = pathname.lastIndexOf(\"/\")\n  if (slashLastIndex !== -1) {\n    pathname = pathname.slice(slashLastIndex + 1)\n  }\n\n  const dotLastIndex = pathname.lastIndexOf(\".\")\n  if (dotLastIndex === -1) return \"\"\n  // if (dotLastIndex === pathname.length - 1) return \"\"\n  return pathname.slice(dotLastIndex)\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\nimport { assertImportMap } from \"./internal/assertImportMap.js\"\nimport { hasScheme } from \"./internal/hasScheme.js\"\nimport { tryUrlResolution } from \"./internal/tryUrlResolution.js\"\nimport { resolveSpecifier } from \"./resolveSpecifier.js\"\n\nexport const applyImportMap = ({\n  importMap,\n  specifier,\n  importer,\n  createBareSpecifierError = ({ specifier, importer }) => {\n    return new Error(\n      createDetailedMessage(`Unmapped bare specifier.`, {\n        specifier,\n        importer,\n      }),\n    )\n  },\n  onImportMapping = () => {},\n}) => {\n  assertImportMap(importMap)\n  if (typeof specifier !== \"string\") {\n    throw new TypeError(\n      createDetailedMessage(\"specifier must be a string.\", {\n        specifier,\n        importer,\n      }),\n    )\n  }\n  if (importer) {\n    if (typeof importer !== \"string\") {\n      throw new TypeError(\n        createDetailedMessage(\"importer must be a string.\", {\n          importer,\n          specifier,\n        }),\n      )\n    }\n    if (!hasScheme(importer)) {\n      throw new Error(\n        createDetailedMessage(`importer must be an absolute url.`, {\n          importer,\n          specifier,\n        }),\n      )\n    }\n  }\n\n  const specifierUrl = resolveSpecifier(specifier, importer)\n  const specifierNormalized = specifierUrl || specifier\n\n  const { scopes } = importMap\n  if (scopes && importer) {\n    const scopeSpecifierMatching = Object.keys(scopes).find(\n      (scopeSpecifier) => {\n        return (\n          scopeSpecifier === importer ||\n          specifierIsPrefixOf(scopeSpecifier, importer)\n        )\n      },\n    )\n    if (scopeSpecifierMatching) {\n      const scopeMappings = scopes[scopeSpecifierMatching]\n      const mappingFromScopes = applyMappings(\n        scopeMappings,\n        specifierNormalized,\n        scopeSpecifierMatching,\n        onImportMapping,\n      )\n      if (mappingFromScopes !== null) {\n        return mappingFromScopes\n      }\n    }\n  }\n\n  const { imports } = importMap\n  if (imports) {\n    const mappingFromImports = applyMappings(\n      imports,\n      specifierNormalized,\n      undefined,\n      onImportMapping,\n    )\n    if (mappingFromImports !== null) {\n      return mappingFromImports\n    }\n  }\n\n  if (specifierUrl) {\n    return specifierUrl\n  }\n\n  throw createBareSpecifierError({ specifier, importer })\n}\n\nconst applyMappings = (\n  mappings,\n  specifierNormalized,\n  scope,\n  onImportMapping,\n) => {\n  const specifierCandidates = Object.keys(mappings)\n\n  let i = 0\n  while (i < specifierCandidates.length) {\n    const specifierCandidate = specifierCandidates[i]\n    i++\n    if (specifierCandidate === specifierNormalized) {\n      const address = mappings[specifierCandidate]\n      onImportMapping({\n        scope,\n        from: specifierCandidate,\n        to: address,\n        before: specifierNormalized,\n        after: address,\n      })\n      return address\n    }\n    if (specifierIsPrefixOf(specifierCandidate, specifierNormalized)) {\n      const address = mappings[specifierCandidate]\n      const afterSpecifier = specifierNormalized.slice(\n        specifierCandidate.length,\n      )\n      const addressFinal = tryUrlResolution(afterSpecifier, address)\n      onImportMapping({\n        scope,\n        from: specifierCandidate,\n        to: address,\n        before: specifierNormalized,\n        after: addressFinal,\n      })\n      return addressFinal\n    }\n  }\n\n  return null\n}\n\nconst specifierIsPrefixOf = (specifierHref, href) => {\n  return (\n    specifierHref[specifierHref.length - 1] === \"/\" &&\n    href.startsWith(specifierHref)\n  )\n}\n",
    "import { urlToPathname } from \"./internal/urlToPathname.js\"\nimport { pathnameToExtension } from \"./internal/pathnameToExtension.js\"\nimport { resolveUrl } from \"./resolveUrl.js\"\nimport { applyImportMap } from \"./applyImportMap.js\"\n\nexport const resolveImport = ({\n  specifier,\n  importer,\n  importMap,\n  defaultExtension = false,\n  createBareSpecifierError,\n  onImportMapping = () => {},\n}) => {\n  let url\n  if (importMap) {\n    url = applyImportMap({\n      importMap,\n      specifier,\n      importer,\n      createBareSpecifierError,\n      onImportMapping,\n    })\n  } else {\n    url = resolveUrl(specifier, importer)\n  }\n\n  if (defaultExtension) {\n    url = applyDefaultExtension({ url, importer, defaultExtension })\n  }\n\n  return url\n}\n\nconst applyDefaultExtension = ({ url, importer, defaultExtension }) => {\n  if (urlToPathname(url).endsWith(\"/\")) {\n    return url\n  }\n\n  if (typeof defaultExtension === \"string\") {\n    const extension = pathnameToExtension(url)\n    if (extension === \"\") {\n      return `${url}${defaultExtension}`\n    }\n    return url\n  }\n\n  if (defaultExtension === true) {\n    const extension = pathnameToExtension(url)\n    if (extension === \"\" && importer) {\n      const importerPathname = urlToPathname(importer)\n      const importerExtension = pathnameToExtension(importerPathname)\n      return `${url}${importerExtension}`\n    }\n  }\n\n  return url\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\n\nexport const fromFunctionReturningNamespace = (fn, data) => {\n  return fromFunctionReturningRegisteredModule(() => {\n    // should we compute the namespace here\n    // or as it is done below, defer to execute ?\n    // I think defer to execute is better\n    return [\n      [],\n      (_export) => {\n        return {\n          execute: () => {\n            const namespace = fn()\n            _export(namespace)\n          },\n        }\n      },\n    ]\n  }, data)\n}\n\nexport const getJavaScriptModuleResponseError = async (\n  response,\n  {\n    url,\n    importerUrl,\n    compileServerOrigin,\n    compileDirectoryRelativeUrl,\n    jsonContentTypeAccepted,\n  },\n) => {\n  if (response.status === 404) {\n    return new Error(\n      createDetailedMessage(\n        `JavaScript module file cannot be found`,\n        getModuleDetails({\n          url,\n          importerUrl,\n          compileServerOrigin,\n          compileDirectoryRelativeUrl,\n          notFound: true,\n        }),\n      ),\n    )\n  }\n\n  const contentType = response.headers[\"content-type\"] || \"\"\n  if (response.status === 500 && contentType === \"application/json\") {\n    const bodyAsJson = await response.json()\n    if (\n      bodyAsJson.message &&\n      bodyAsJson.filename &&\n      \"columnNumber\" in bodyAsJson\n    ) {\n      const error = new Error(\n        createDetailedMessage(`JavaScript module file cannot be parsed`, {\n          [\"parsing error message\"]: bodyAsJson.message,\n          ...getModuleDetails({\n            url,\n            importerUrl,\n            compileServerOrigin,\n            compileDirectoryRelativeUrl,\n          }),\n        }),\n      )\n      error.parsingError = bodyAsJson\n      return error\n    }\n  }\n\n  if (response.status < 200 || response.status >= 300) {\n    return new Error(\n      createDetailedMessage(\n        `JavaScript module file response status is unexpected`,\n        {\n          [\"status\"]: response.status,\n          [\"allowed status\"]: \"200 to 299\",\n          [\"statusText\"]: response.statusText,\n          ...getModuleDetails({\n            url,\n            importerUrl,\n            compileServerOrigin,\n            compileDirectoryRelativeUrl,\n          }),\n        },\n      ),\n    )\n  }\n\n  if (\n    jsonContentTypeAccepted &&\n    (contentType === \"application/json\" || contentType.endsWith(\"+json\"))\n  ) {\n    return null\n  }\n\n  if (\n    contentType !== \"application/javascript\" &&\n    contentType !== \"text/javascript\"\n  ) {\n    return new Error(\n      createDetailedMessage(\n        `Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of \"${contentType}\". Strict MIME type checking is enforced for module scripts per HTML spec.`,\n        {\n          ...getModuleDetails({\n            url,\n            importerUrl,\n            compileServerOrigin,\n            compileDirectoryRelativeUrl,\n          }),\n          suggestion: `Use import.meta.url or import assertions as documented in https://github.com/jsenv/jsenv-core/blob/master/docs/building/readme.md#How-to-reference-assets`,\n        },\n      ),\n    )\n  }\n\n  return null\n}\n\nexport const fromFunctionReturningRegisteredModule = (fn, data) => {\n  try {\n    return fn()\n  } catch (error) {\n    if (error.name === \"SyntaxError\") {\n      throw new Error(\n        createDetailedMessage(`Syntax error in module.`, {\n          \"syntax error stack\": error.stack,\n          ...getModuleDetails(data),\n        }),\n      )\n    }\n    throw new Error(\n      createDetailedMessage(`Module instantiation error.`, {\n        [\"instantiation error stack\"]: error.stack,\n        ...getModuleDetails(data),\n      }),\n    )\n  }\n}\n\nexport const getModuleDetails = ({\n  url,\n  importerUrl,\n  compileServerOrigin,\n  compileDirectoryRelativeUrl,\n  notFound = false,\n}) => {\n  const relativeUrl = tryToFindProjectRelativeUrl(url, {\n    compileServerOrigin,\n    compileDirectoryRelativeUrl,\n  })\n\n  const importerRelativeUrl = tryToFindProjectRelativeUrl(importerUrl, {\n    compileServerOrigin,\n    compileDirectoryRelativeUrl,\n  })\n\n  const details = notFound\n    ? {\n        ...(importerUrl\n          ? { [\"import declared in\"]: importerRelativeUrl || importerUrl }\n          : {}),\n        ...(relativeUrl ? { file: relativeUrl } : {}),\n        [\"file url\"]: url,\n      }\n    : {\n        ...(relativeUrl ? { file: relativeUrl } : {}),\n        [\"file url\"]: url,\n        ...(importerUrl\n          ? { [\"imported by\"]: importerRelativeUrl || importerUrl }\n          : {}),\n      }\n\n  return details\n}\n\nexport const tryToFindProjectRelativeUrl = (\n  url,\n  { compileServerOrigin, compileDirectoryRelativeUrl },\n) => {\n  if (!url) {\n    return null\n  }\n\n  if (!url.startsWith(`${compileServerOrigin}/`)) {\n    return null\n  }\n\n  if (url === compileServerOrigin) {\n    return null\n  }\n\n  const afterOrigin = url.slice(`${compileServerOrigin}/`.length)\n  if (!afterOrigin.startsWith(compileDirectoryRelativeUrl)) {\n    return null\n  }\n\n  const afterCompileDirectory = afterOrigin.slice(\n    compileDirectoryRelativeUrl.length,\n  )\n  return afterCompileDirectory\n}\n\n// const textToBase64 =\n//   typeof window === \"object\"\n//     ? (text) => window.btoa(window.unescape(window.encodeURIComponent(text)))\n//     : (text) => Buffer.from(text, \"utf8\").toString(\"base64\")\n",
    "export const applyDefaultExtension = (specifier, importer) => {\n  if (!importer) {\n    return specifier\n  }\n\n  const importerExtension = urlToExtension(importer)\n  const fakeUrl = new URL(specifier, importer).href\n  const specifierExtension = urlToExtension(fakeUrl)\n  if (specifierExtension !== \"\") {\n    return specifier\n  }\n\n  // I guess typescript still expect default extension to be .ts\n  // in a tsx file.\n  if (importerExtension === \"tsx\") {\n    return `${specifier}.ts`\n  }\n\n  // extension magic\n  return `${specifier}${importerExtension}`\n}\n\nconst urlToExtension = (url) => {\n  return pathnameToExtension(urlToPathname(url))\n}\n\nconst urlToPathname = (url) => new URL(url).pathname\n\nconst pathnameToExtension = (pathname) => {\n  const slashLastIndex = pathname.lastIndexOf(\"/\")\n  if (slashLastIndex !== -1) {\n    pathname = pathname.slice(slashLastIndex + 1)\n  }\n\n  const dotLastIndex = pathname.lastIndexOf(\".\")\n  if (dotLastIndex === -1) return \"\"\n  // if (dotLastIndex === pathname.length - 1) return \"\"\n  const extension = pathname.slice(dotLastIndex)\n  return extension\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\nimport { resolveImport } from \"@jsenv/importmap/src/resolveImport.js\"\n\nimport { tryToFindProjectRelativeUrl } from \"@jsenv/core/src/internal/runtime_client/module_registration.js\"\n\nimport { applyDefaultExtension } from \"./default_extension.js\"\n\nexport const createImportResolverForImportmap = async ({\n  // projectDirectoryUrl,\n  compileServerOrigin,\n  compileDirectoryRelativeUrl,\n  importMap,\n  importMapUrl,\n  importDefaultExtension,\n  onBareSpecifierError = () => {},\n}) => {\n  const _resolveImport = (specifier, importer) => {\n    if (importDefaultExtension) {\n      specifier = applyDefaultExtension(specifier, importer)\n    }\n    return resolveImport({\n      specifier,\n      importer,\n      importMap,\n      createBareSpecifierError: ({ specifier, importer }) => {\n        const bareSpecifierError = createBareSpecifierError({\n          specifier,\n          importer:\n            tryToFindProjectRelativeUrl(importer, {\n              compileServerOrigin,\n              compileDirectoryRelativeUrl,\n            }) || importer,\n          importMapUrl:\n            tryToFindProjectRelativeUrl(importMapUrl, {\n              compileServerOrigin,\n              compileDirectoryRelativeUrl,\n            }) || importMapUrl,\n          importMap,\n        })\n        onBareSpecifierError(bareSpecifierError)\n        return bareSpecifierError\n      },\n    })\n  }\n\n  return { resolveImport: _resolveImport }\n}\n\nconst createBareSpecifierError = ({ specifier, importer, importMapUrl }) => {\n  const detailedMessage = createDetailedMessage(\"Unmapped bare specifier.\", {\n    specifier,\n    importer,\n    ...(importMapUrl\n      ? {\n          \"how to fix\": `Add a mapping for \"${specifier}\" into the importmap file at \"${importMapUrl}\"`,\n        }\n      : {\n          \"how to fix\": `Add an importmap with a mapping for \"${specifier}\"`,\n          \"suggestion\": `Generate importmap using https://github.com/jsenv/importmap-node-module`,\n        }),\n  })\n\n  return new Error(detailedMessage)\n}\n",
    "/*\n* SJS 6.11.0\n* Minimal SystemJS Build\n*/\n(function () {\n\n  function errMsg(errCode, msg) {\n    return (msg || \"\") + \" (SystemJS https://git.io/JvFET#\" + errCode + \")\";\n  }\n\n  var hasSymbol = typeof Symbol !== 'undefined';\n  var hasSelf = typeof self !== 'undefined';\n  var hasDocument = typeof document !== 'undefined';\n\n  var envGlobal = hasSelf ? self : global;\n\n  var baseUrl;\n\n  if (hasDocument) {\n    var baseEl = document.querySelector('base[href]');\n    if (baseEl)\n      baseUrl = baseEl.href;\n  }\n\n  if (!baseUrl && typeof location !== 'undefined') {\n    baseUrl = location.href.split('#')[0].split('?')[0];\n    var lastSepIndex = baseUrl.lastIndexOf('/');\n    if (lastSepIndex !== -1)\n      baseUrl = baseUrl.slice(0, lastSepIndex + 1);\n  }\n\n  var backslashRegEx = /\\\\/g;\n  function resolveIfNotPlainOrUrl (relUrl, parentUrl) {\n    if (relUrl.indexOf('\\\\') !== -1)\n      relUrl = relUrl.replace(backslashRegEx, '/');\n    // protocol-relative\n    if (relUrl[0] === '/' && relUrl[1] === '/') {\n      return parentUrl.slice(0, parentUrl.indexOf(':') + 1) + relUrl;\n    }\n    // relative-url\n    else if (relUrl[0] === '.' && (relUrl[1] === '/' || relUrl[1] === '.' && (relUrl[2] === '/' || relUrl.length === 2 && (relUrl += '/')) ||\n        relUrl.length === 1  && (relUrl += '/')) ||\n        relUrl[0] === '/') {\n      var parentProtocol = parentUrl.slice(0, parentUrl.indexOf(':') + 1);\n      // Disabled, but these cases will give inconsistent results for deep backtracking\n      //if (parentUrl[parentProtocol.length] !== '/')\n      //  throw Error('Cannot resolve');\n      // read pathname from parent URL\n      // pathname taken to be part after leading \"/\"\n      var pathname;\n      if (parentUrl[parentProtocol.length + 1] === '/') {\n        // resolving to a :// so we need to read out the auth and host\n        if (parentProtocol !== 'file:') {\n          pathname = parentUrl.slice(parentProtocol.length + 2);\n          pathname = pathname.slice(pathname.indexOf('/') + 1);\n        }\n        else {\n          pathname = parentUrl.slice(8);\n        }\n      }\n      else {\n        // resolving to :/ so pathname is the /... part\n        pathname = parentUrl.slice(parentProtocol.length + (parentUrl[parentProtocol.length] === '/'));\n      }\n\n      if (relUrl[0] === '/')\n        return parentUrl.slice(0, parentUrl.length - pathname.length - 1) + relUrl;\n\n      // join together and split for removal of .. and . segments\n      // looping the string instead of anything fancy for perf reasons\n      // '../../../../../z' resolved to 'x/y' is just 'z'\n      var segmented = pathname.slice(0, pathname.lastIndexOf('/') + 1) + relUrl;\n\n      var output = [];\n      var segmentIndex = -1;\n      for (var i = 0; i < segmented.length; i++) {\n        // busy reading a segment - only terminate on '/'\n        if (segmentIndex !== -1) {\n          if (segmented[i] === '/') {\n            output.push(segmented.slice(segmentIndex, i + 1));\n            segmentIndex = -1;\n          }\n        }\n\n        // new segment - check if it is relative\n        else if (segmented[i] === '.') {\n          // ../ segment\n          if (segmented[i + 1] === '.' && (segmented[i + 2] === '/' || i + 2 === segmented.length)) {\n            output.pop();\n            i += 2;\n          }\n          // ./ segment\n          else if (segmented[i + 1] === '/' || i + 1 === segmented.length) {\n            i += 1;\n          }\n          else {\n            // the start of a new segment as below\n            segmentIndex = i;\n          }\n        }\n        // it is the start of a new segment\n        else {\n          segmentIndex = i;\n        }\n      }\n      // finish reading out the last segment\n      if (segmentIndex !== -1)\n        output.push(segmented.slice(segmentIndex));\n      return parentUrl.slice(0, parentUrl.length - pathname.length) + output.join('');\n    }\n  }\n\n  /*\n   * Import maps implementation\n   *\n   * To make lookups fast we pre-resolve the entire import map\n   * and then match based on backtracked hash lookups\n   *\n   */\n\n  function resolveUrl (relUrl, parentUrl) {\n    return resolveIfNotPlainOrUrl(relUrl, parentUrl) || (relUrl.indexOf(':') !== -1 ? relUrl : resolveIfNotPlainOrUrl('./' + relUrl, parentUrl));\n  }\n\n  function resolveAndComposePackages (packages, outPackages, baseUrl, parentMap, parentUrl) {\n    for (var p in packages) {\n      var resolvedLhs = resolveIfNotPlainOrUrl(p, baseUrl) || p;\n      var rhs = packages[p];\n      // package fallbacks not currently supported\n      if (typeof rhs !== 'string')\n        continue;\n      var mapped = resolveImportMap(parentMap, resolveIfNotPlainOrUrl(rhs, baseUrl) || rhs, parentUrl);\n      if (!mapped) {\n        targetWarning('W1', p, rhs);\n      }\n      else\n        outPackages[resolvedLhs] = mapped;\n    }\n  }\n\n  function resolveAndComposeImportMap (json, baseUrl, outMap) {\n    if (json.imports)\n      resolveAndComposePackages(json.imports, outMap.imports, baseUrl, outMap, null);\n\n    var u;\n    for (u in json.scopes || {}) {\n      var resolvedScope = resolveUrl(u, baseUrl);\n      resolveAndComposePackages(json.scopes[u], outMap.scopes[resolvedScope] || (outMap.scopes[resolvedScope] = {}), baseUrl, outMap, resolvedScope);\n    }\n\n    for (u in json.depcache || {})\n      outMap.depcache[resolveUrl(u, baseUrl)] = json.depcache[u];\n\n    for (u in json.integrity || {})\n      outMap.integrity[resolveUrl(u, baseUrl)] = json.integrity[u];\n  }\n\n  function getMatch (path, matchObj) {\n    if (matchObj[path])\n      return path;\n    var sepIndex = path.length;\n    do {\n      var segment = path.slice(0, sepIndex + 1);\n      if (segment in matchObj)\n        return segment;\n    } while ((sepIndex = path.lastIndexOf('/', sepIndex - 1)) !== -1)\n  }\n\n  function applyPackages (id, packages) {\n    var pkgName = getMatch(id, packages);\n    if (pkgName) {\n      var pkg = packages[pkgName];\n      if (pkg === null) return;\n      if (id.length > pkgName.length && pkg[pkg.length - 1] !== '/') {\n        targetWarning('W2', pkgName, pkg);\n      }\n      else\n        return pkg + id.slice(pkgName.length);\n    }\n  }\n\n  function targetWarning (code, match, target, msg) {\n    console.warn(errMsg(code,  [target, match].join(', ') ));\n  }\n\n  function resolveImportMap (importMap, resolvedOrPlain, parentUrl) {\n    var scopes = importMap.scopes;\n    var scopeUrl = parentUrl && getMatch(parentUrl, scopes);\n    while (scopeUrl) {\n      var packageResolution = applyPackages(resolvedOrPlain, scopes[scopeUrl]);\n      if (packageResolution)\n        return packageResolution;\n      scopeUrl = getMatch(scopeUrl.slice(0, scopeUrl.lastIndexOf('/')), scopes);\n    }\n    return applyPackages(resolvedOrPlain, importMap.imports) || resolvedOrPlain.indexOf(':') !== -1 && resolvedOrPlain;\n  }\n\n  /*\n   * SystemJS Core\n   *\n   * Provides\n   * - System.import\n   * - System.register support for\n   *     live bindings, function hoisting through circular references,\n   *     reexports, dynamic import, import.meta.url, top-level await\n   * - System.getRegister to get the registration\n   * - Symbol.toStringTag support in Module objects\n   * - Hookable System.createContext to customize import.meta\n   * - System.onload(err, id, deps) handler for tracing / hot-reloading\n   *\n   * Core comes with no System.prototype.resolve or\n   * System.prototype.instantiate implementations\n   */\n\n  var toStringTag = hasSymbol && Symbol.toStringTag;\n  var REGISTRY = hasSymbol ? Symbol() : '@';\n\n  function SystemJS () {\n    this[REGISTRY] = {};\n  }\n\n  var systemJSPrototype = SystemJS.prototype;\n\n  systemJSPrototype.import = function (id, parentUrl) {\n    var loader = this;\n    return Promise.resolve(loader.prepareImport())\n    .then(function() {\n      return loader.resolve(String(id), parentUrl);\n    })\n    .then(function (id) {\n      var load = getOrCreateLoad(loader, id);\n      return load.C || topLevelLoad(loader, load);\n    });\n  };\n\n  // Hookable createContext function -> allowing eg custom import meta\n  systemJSPrototype.createContext = function (parentId) {\n    var loader = this;\n    return {\n      url: parentId,\n      resolve: function (id, parentUrl) {\n        return Promise.resolve(loader.resolve(id, parentUrl || parentId));\n      }\n    };\n  };\n  function loadToId (load) {\n    return load.id;\n  }\n  function triggerOnload (loader, load, err, isErrSource) {\n    loader.onload(err, load.id, load.d && load.d.map(loadToId), !!isErrSource);\n    if (err)\n      throw err;\n  }\n\n  var lastRegister;\n  systemJSPrototype.register = function (deps, declare) {\n    lastRegister = [deps, declare];\n  };\n\n  /*\n   * getRegister provides the last anonymous System.register call\n   */\n  systemJSPrototype.getRegister = function () {\n    var _lastRegister = lastRegister;\n    lastRegister = undefined;\n    return _lastRegister;\n  };\n\n  function getOrCreateLoad (loader, id, firstParentUrl) {\n    var load = loader[REGISTRY][id];\n    if (load)\n      return load;\n\n    var importerSetters = [];\n    var ns = Object.create(null);\n    if (toStringTag)\n      Object.defineProperty(ns, toStringTag, { value: 'Module' });\n\n    var instantiatePromise = Promise.resolve()\n    .then(function () {\n      return loader.instantiate(id, firstParentUrl);\n    })\n    .then(function (registration) {\n      if (!registration)\n        throw Error(errMsg(2,  id ));\n      function _export (name, value) {\n        // note if we have hoisted exports (including reexports)\n        load.h = true;\n        var changed = false;\n        if (typeof name === 'string') {\n          if (!(name in ns) || ns[name] !== value) {\n            ns[name] = value;\n            changed = true;\n          }\n        }\n        else {\n          for (var p in name) {\n            var value = name[p];\n            if (!(p in ns) || ns[p] !== value) {\n              ns[p] = value;\n              changed = true;\n            }\n          }\n\n          if (name && name.__esModule) {\n            ns.__esModule = name.__esModule;\n          }\n        }\n        if (changed)\n          for (var i = 0; i < importerSetters.length; i++) {\n            var setter = importerSetters[i];\n            if (setter) setter(ns);\n          }\n        return value;\n      }\n      var declared = registration[1](_export, registration[1].length === 2 ? {\n        import: function (importId) {\n          return loader.import(importId, id);\n        },\n        meta: loader.createContext(id)\n      } : undefined);\n      load.e = declared.execute || function () {};\n      return [registration[0], declared.setters || []];\n    }, function (err) {\n      load.e = null;\n      load.er = err;\n      throw err;\n    });\n\n    var linkPromise = instantiatePromise\n    .then(function (instantiation) {\n      return Promise.all(instantiation[0].map(function (dep, i) {\n        var setter = instantiation[1][i];\n        return Promise.resolve(loader.resolve(dep, id))\n        .then(function (depId) {\n          var depLoad = getOrCreateLoad(loader, depId, id);\n          // depLoad.I may be undefined for already-evaluated\n          return Promise.resolve(depLoad.I)\n          .then(function () {\n            if (setter) {\n              depLoad.i.push(setter);\n              // only run early setters when there are hoisted exports of that module\n              // the timing works here as pending hoisted export calls will trigger through importerSetters\n              if (depLoad.h || !depLoad.I)\n                setter(depLoad.n);\n            }\n            return depLoad;\n          });\n        });\n      }))\n      .then(function (depLoads) {\n        load.d = depLoads;\n      });\n    });\n\n    // Capital letter = a promise function\n    return load = loader[REGISTRY][id] = {\n      id: id,\n      // importerSetters, the setters functions registered to this dependency\n      // we retain this to add more later\n      i: importerSetters,\n      // module namespace object\n      n: ns,\n\n      // instantiate\n      I: instantiatePromise,\n      // link\n      L: linkPromise,\n      // whether it has hoisted exports\n      h: false,\n\n      // On instantiate completion we have populated:\n      // dependency load records\n      d: undefined,\n      // execution function\n      e: undefined,\n\n      // On execution we have populated:\n      // the execution error if any\n      er: undefined,\n      // in the case of TLA, the execution promise\n      E: undefined,\n\n      // On execution, L, I, E cleared\n\n      // Promise for top-level completion\n      C: undefined,\n\n      // parent instantiator / executor\n      p: undefined\n    };\n  }\n\n  function instantiateAll (loader, load, parent, loaded) {\n    if (!loaded[load.id]) {\n      loaded[load.id] = true;\n      // load.L may be undefined for already-instantiated\n      return Promise.resolve(load.L)\n      .then(function () {\n        if (!load.p || load.p.e === null)\n          load.p = parent;\n        return Promise.all(load.d.map(function (dep) {\n          return instantiateAll(loader, dep, parent, loaded);\n        }));\n      })\n      .catch(function (err) {\n        if (load.er)\n          throw err;\n        load.e = null;\n        throw err;\n      });\n    }\n  }\n\n  function topLevelLoad (loader, load) {\n    return load.C = instantiateAll(loader, load, load, {})\n    .then(function () {\n      return postOrderExec(loader, load, {});\n    })\n    .then(function () {\n      return load.n;\n    });\n  }\n\n  // the closest we can get to call(undefined)\n  var nullContext = Object.freeze(Object.create(null));\n\n  // returns a promise if and only if a top-level await subgraph\n  // throws on sync errors\n  function postOrderExec (loader, load, seen) {\n    if (seen[load.id])\n      return;\n    seen[load.id] = true;\n\n    if (!load.e) {\n      if (load.er)\n        throw load.er;\n      if (load.E)\n        return load.E;\n      return;\n    }\n\n    // deps execute first, unless circular\n    var depLoadPromises;\n    load.d.forEach(function (depLoad) {\n      try {\n        var depLoadPromise = postOrderExec(loader, depLoad, seen);\n        if (depLoadPromise)\n          (depLoadPromises = depLoadPromises || []).push(depLoadPromise);\n      }\n      catch (err) {\n        load.e = null;\n        load.er = err;\n        throw err;\n      }\n    });\n    if (depLoadPromises)\n      return Promise.all(depLoadPromises).then(doExec);\n\n    return doExec();\n\n    function doExec () {\n      try {\n        var execPromise = load.e.call(nullContext);\n        if (execPromise) {\n          execPromise = execPromise.then(function () {\n            load.C = load.n;\n            load.E = null; // indicates completion\n            if (!true) ;\n          }, function (err) {\n            load.er = err;\n            load.E = null;\n            if (!true) ;\n            throw err;\n          });\n          return load.E = execPromise;\n        }\n        // (should be a promise, but a minify optimization to leave out Promise.resolve)\n        load.C = load.n;\n        load.L = load.I = undefined;\n      }\n      catch (err) {\n        load.er = err;\n        throw err;\n      }\n      finally {\n        load.e = null;\n      }\n    }\n  }\n\n  envGlobal.System = new SystemJS();\n\n  /*\n   * SystemJS browser attachments for script and import map processing\n   */\n\n  var importMapPromise = Promise.resolve();\n  var importMap = { imports: {}, scopes: {}, depcache: {}, integrity: {} };\n  systemJSPrototype.importMap = importMap;\n  systemJSPrototype.baseUrl = baseUrl;\n\n  // Scripts are processed immediately, on the first System.import, and on DOMReady.\n  // Import map scripts are processed only once (by being marked) and in order for each phase.\n  // This is to avoid using DOM mutation observers in core, although that would be an alternative.\n  var processFirst = hasDocument;\n  systemJSPrototype.prepareImport = function (doProcessScripts) {\n    if (processFirst || doProcessScripts) {\n      processScripts();\n      processFirst = false;\n    }\n    return importMapPromise;\n  };\n  if (hasDocument) {\n    processScripts();\n    window.addEventListener('DOMContentLoaded', processScripts);\n  }\n\n  function processScripts () {\n    [].forEach.call(document.querySelectorAll('script'), function (script) {\n      if (script.sp) // sp marker = systemjs processed\n        return;\n      // TODO: deprecate systemjs-module in next major now that we have auto import\n      if (script.type === 'systemjs-module') {\n        script.sp = true;\n        if (!script.src)\n          return;\n        System.import(script.src.slice(0, 7) === 'import:' ? script.src.slice(7) : resolveUrl(script.src, baseUrl)).catch(function (e) {\n          // if there is a script load error, dispatch an \"error\" event\n          // on the script tag.\n          if (e.message.indexOf('https://git.io/JvFET#3') > -1) {\n            var event = document.createEvent('Event');\n            event.initEvent('error', false, false);\n            script.dispatchEvent(event);\n          }\n          return Promise.reject(e);\n        });\n      }\n      else if (script.type === 'systemjs-importmap') {\n        script.sp = true;\n        var fetchPromise = script.src ? fetch(script.src, { integrity: script.integrity }).then(function (res) {\n          if (!res.ok)\n            throw Error( res.status );\n          return res.text();\n        }).catch(function (err) {\n          err.message = errMsg('W4',  script.src ) + '\\n' + err.message;\n          console.warn(err);\n          if (typeof script.onerror === 'function') {\n              script.onerror();\n          }\n          return '{}';\n        }) : script.innerHTML;\n        importMapPromise = importMapPromise.then(function () {\n          return fetchPromise;\n        }).then(function (text) {\n          extendImportMap(importMap, text, script.src || baseUrl);\n          return importMap\n        });\n      }\n    });\n  }\n\n  function extendImportMap (importMap, newMapText, newMapUrl) {\n    var newMap = {};\n    try {\n      newMap = JSON.parse(newMapText);\n    } catch (err) {\n      console.warn(Error(( errMsg('W5')  )));\n    }\n    resolveAndComposeImportMap(newMap, newMapUrl, importMap);\n  }\n  System.extendImportMap = extendImportMap\n\n  /*\n   * Script instantiation loading\n   */\n\n  if (hasDocument) {\n    window.addEventListener('error', function (evt) {\n      lastWindowErrorUrl = evt.filename;\n      lastWindowError = evt.error;\n    });\n    var baseOrigin = location.origin;\n  }\n\n  systemJSPrototype.createScript = function (url) {\n    var script = document.createElement('script');\n    script.async = true;\n    // Only add cross origin for actual cross origin\n    // this is because Safari triggers for all\n    // - https://bugs.webkit.org/show_bug.cgi?id=171566\n    if (url.indexOf(baseOrigin + '/'))\n      script.crossOrigin = 'anonymous';\n    var integrity = importMap.integrity[url];\n    if (integrity)\n      script.integrity = integrity;\n    script.src = url;\n    return script;\n  };\n\n  // Auto imports -> script tags can be inlined directly for load phase\n  var lastAutoImportDeps, lastAutoImportTimeout;\n  var autoImportCandidates = {};\n  var systemRegister = systemJSPrototype.register;\n  var inlineScriptCount = 0;\n  systemJSPrototype.register = function (deps, declare, autoUrl) {\n    if (hasDocument && document.readyState === 'loading' && typeof deps !== 'string') {\n      var scripts = document.querySelectorAll('script[src]');\n      var lastScript = scripts[scripts.length - 1];\n      var lastAutoImportUrl\n      lastAutoImportDeps = deps;\n      if (lastScript && lastScript.src) {\n        lastAutoImportUrl = lastScript.src;\n      }\n      else if (autoUrl) {\n        lastAutoImportUrl = autoUrl\n      }\n      else {\n        inlineScriptCount++\n        lastAutoImportUrl = document.location.href + \"__inline_script__\" + inlineScriptCount;\n      }\n      // if this is already a System load, then the instantiate has already begun\n      // so this re-import has no consequence\n      var loader = this;\n      lastAutoImportTimeout = setTimeout(function () {\n        autoImportCandidates[lastAutoImportUrl] = [deps, declare];\n        loader.import(lastAutoImportUrl);\n      });\n    }\n    else {\n      lastAutoImportDeps = undefined;\n    }\n    return systemRegister.call(this, deps, declare);\n  };\n\n  var lastWindowErrorUrl, lastWindowError;\n  systemJSPrototype.instantiate = function (url, firstParentUrl) {\n    var autoImportRegistration = autoImportCandidates[url];\n    if (autoImportRegistration) {\n      delete autoImportCandidates[url];\n      return autoImportRegistration;\n    }\n    var loader = this;\n    return Promise.resolve(systemJSPrototype.createScript(url)).then(function (script) {\n      return new Promise(function (resolve, reject) {\n        script.addEventListener('error', function () {\n          reject(Error(errMsg(3,  [url, firstParentUrl].join(', ') )));\n        });\n        script.addEventListener('load', function () {\n          document.head.removeChild(script);\n          // Note that if an error occurs that isn't caught by this if statement,\n          // that getRegister will return null and a \"did not instantiate\" error will be thrown.\n          if (lastWindowErrorUrl === url) {\n            reject(lastWindowError);\n          }\n          else {\n            var register = loader.getRegister(url);\n            // Clear any auto import registration for dynamic import scripts during load\n            if (register && register[0] === lastAutoImportDeps)\n              clearTimeout(lastAutoImportTimeout);\n            resolve(register);\n          }\n        });\n        document.head.appendChild(script);\n      });\n    });\n  };\n\n  /*\n   * Fetch loader, sets up shouldFetch and fetch hooks\n   */\n  systemJSPrototype.shouldFetch = function () {\n    return false;\n  };\n  if (typeof fetch !== 'undefined')\n    systemJSPrototype.fetch = fetch;\n\n  var instantiate = systemJSPrototype.instantiate;\n  var jsContentTypeRegEx = /^(text|application)\\/(x-)?javascript(;|$)/;\n  systemJSPrototype.instantiate = function (url, parent) {\n    var loader = this;\n    if (!this.shouldFetch(url))\n      return instantiate.apply(this, arguments);\n    return this.fetch(url, {\n      credentials: 'same-origin',\n      integrity: importMap.integrity[url]\n    })\n    .then(function (res) {\n      if (!res.ok)\n        throw Error(errMsg(7,  [res.status, res.statusText, url, parent].join(', ') ));\n      var contentType = res.headers.get('content-type');\n      if (!contentType || !jsContentTypeRegEx.test(contentType))\n        throw Error(errMsg(4,  contentType ));\n      return res.text().then(function (source) {\n        if (source.indexOf('//# sourceURL=') < 0)\n          source += '\\n//# sourceURL=' + url;\n        (0, eval)(source);\n        return loader.getRegister(url);\n      });\n    });\n  };\n\n  systemJSPrototype.resolve = function (id, parentUrl) {\n    parentUrl = parentUrl || !true  || baseUrl;\n    return resolveImportMap(( importMap), resolveIfNotPlainOrUrl(id, parentUrl) || id, parentUrl) || throwUnresolved(id, parentUrl);\n  };\n\n  function throwUnresolved (id, parentUrl) {\n    throw Error(errMsg(8,  [id, parentUrl].join(', ') ));\n  }\n\n  var systemInstantiate = systemJSPrototype.instantiate;\n  systemJSPrototype.instantiate = function (url, firstParentUrl) {\n    var preloads = ( importMap).depcache[url];\n    if (preloads) {\n      for (var i = 0; i < preloads.length; i++)\n        getOrCreateLoad(this, this.resolve(preloads[i], url), url);\n    }\n    return systemInstantiate.call(this, url, firstParentUrl);\n  };\n\n  /*\n   * Supports loading System.register in workers\n   */\n\n  if (hasSelf && typeof importScripts === 'function') {\n    systemJSPrototype.instantiate = function (url) {\n      var loader = this;\n      return self.fetch(url, {\n        credentials: 'same-origin',\n      }).then(function (response) {\n        if (!response.ok) {\n          throw Error(errMsg(7,  [response.status, response.statusText, url].join(', ') ));\n        }\n        return response.text()\n      }).then(function (source) {\n        if (source.indexOf('//# sourceURL=') < 0) source += '\\n//# sourceURL=' + url;\n        (0, eval)(source);\n        return loader.getRegister(url);\n      })\n    };\n  }\n\n}());\n\n(function(){\n  var envGlobal = typeof self !== 'undefined' ? self : global;\n  var System = envGlobal.System;\n\n  var registerRegistry = Object.create(null)\n  var register = System.register;\n  System.registerRegistry = registerRegistry;\n  System.register = function (name, deps, declare) {\n    if (typeof name !== 'string') return register.apply(this, arguments);\n    var define = [deps, declare];\n    return System.prepareImport().then(function () {\n      var url = System.resolve(`./${name}`);\n      registerRegistry[url] = define;\n      return register.call(System, deps, declare, url);\n    })\n  };\n\n  var instantiate = System.instantiate;\n  System.instantiate = function (url, firstParentUrl) {\n    var result = registerRegistry[url];\n\n    if (result) {\n      registerRegistry[url] = null;\n      return result;\n    } else {\n      return instantiate.call(this, url, firstParentUrl);\n    }\n  };\n\n  var getRegister = System.getRegister;\n  System.getRegister = function (url) {\n    // Calling getRegister() because other extras need to know it was called so they can perform side effects\n    var register = getRegister.call(this, url);\n    var result = registerRegistry[url] || register;\n    return result;\n  };\n}());\n\n(function () {\n  // worker or service worker\n  if (typeof WorkerGlobalScope === 'function' && self instanceof WorkerGlobalScope) {\n    var importMapFromParentPromise = new Promise((resolve) => {\n      var importmapMessageCallback = function (e) {\n        if (e.data === \"__importmap_init__\") {\n          self.removeEventListener(\"message\", importmapMessageCallback)\n          e.ports[0].onmessage = (message) => {\n            resolve(message.data)\n          }\n          e.ports[0].postMessage('__importmap_request__')         \n        }\n      };\n      self.addEventListener(\"message\", importmapMessageCallback)\n    })\n    // var prepareImport = System.prepareImport\n    System.prepareImport = function () {\n      return importMapFromParentPromise.then(function (importmap) {\n        System.extendImportMap(System.importMap, JSON.stringify(importmap), System.baseUrl)\n      })\n    }\n\n    // auto import first register\n    var messageEvents = []\n    var messageCallback = (event) => {\n      messageEvents.push(event)\n    }\n    self.addEventListener('message', messageCallback)\n    var register = System.register;\n    System.register = function(deps, declare) {\n      System.register = register;\n      System.registerRegistry[self.location.href] = [deps, declare];\n      return System.import(self.location.href).then((result) => {\n        self.removeEventListener('message', messageCallback)\n        messageEvents.forEach((messageEvent) => {\n          self.dispatchEvent(messageEvent)\n        })\n        messageEvents = null\n        return result\n      })\n    }\n  }\n  else if (typeof window === 'object') {\n    var WorkerConstructor = window.Worker;\n    if (typeof WorkerConstructor === 'function') {\n      window.Worker = function (url, options) {\n        var worker = new WorkerConstructor(url, options);\n        var importmapChannel = new MessageChannel();\n        importmapChannel.port1.onmessage = function (message) {\n          System.prepareImport().then(function (importmap) {\n            message.target.postMessage(importmap);\n          });\n        }\n        worker.postMessage('__importmap_init__', [importmapChannel.port2]);\n        return worker\n      }\n    }\n\n    var serviceWorker = navigator.serviceWorker;\n    if (serviceWorker) {\n      var register =  serviceWorker.register;\n      serviceWorker.register = function(url, options) {\n        var registrationPromise = register.call(this, url, options);\n        registrationPromise.then(function(registration) {\n          var installing = registration.installing;\n          var waiting = registration.waiting;\n          var active = registration.active;\n          var worker = installing || waiting || active;\n          var importmapChannel = new MessageChannel();\n          importmapChannel.port1.onmessage = function (message) {\n            System.prepareImport().then(function (importmap) {\n              message.target.postMessage(importmap)\n            });\n          }\n          worker.postMessage('__importmap_init__', [importmapChannel.port2]);\n        })\n        return registrationPromise\n      }\n    }\n  }\n}());",
    "import { getJavaScriptModuleResponseError } from \"@jsenv/core/src/internal/runtime_client/module_registration.js\"\nimport \"@jsenv/core/src/internal/runtime_client/s.js\"\n\nexport const createBrowserSystem = ({\n  compileServerOrigin,\n  compileDirectoryRelativeUrl,\n  importResolver,\n  fetchSource,\n}) => {\n  if (typeof window.System === \"undefined\") {\n    throw new Error(`window.System is undefined`)\n  }\n\n  const browserSystem = window.System\n\n  const resolve = (specifier, importer = document.location.href) => {\n    return importResolver.resolveImport(specifier, importer)\n  }\n\n  browserSystem.resolve = resolve\n\n  const instantiate = browserSystem.instantiate\n  browserSystem.instantiate = async function (url, importerUrl) {\n    const { importType, urlWithoutImportType } = extractImportTypeFromUrl(url)\n    if (importType === \"json\") {\n      const jsonModule = await instantiateAsJsonModule(urlWithoutImportType, {\n        browserSystem,\n        fetchSource,\n      })\n      return jsonModule\n    }\n\n    if (importType === \"css\") {\n      const cssModule = await instantiateAsCssModule(urlWithoutImportType, {\n        browserSystem,\n        importerUrl,\n        compileDirectoryRelativeUrl,\n        fetchSource,\n      })\n      return cssModule\n    }\n\n    try {\n      const registration = await instantiate.call(this, url, importerUrl)\n      if (!registration) {\n        throw new Error(\n          `no registration found for JS at ${url}\n--- importer url ---\n${importerUrl}\n--- navigator.vendor ---\n${window.navigator.vendor}`,\n        )\n      }\n      return registration\n    } catch (e) {\n      const jsenvError = await createDetailedInstantiateError({\n        instantiateError: e,\n        url,\n        importerUrl,\n        compileServerOrigin,\n        compileDirectoryRelativeUrl,\n        fetchSource,\n      })\n      throw jsenvError\n    }\n  }\n\n  browserSystem.createContext = (importerUrl) => {\n    return {\n      url: importerUrl,\n      resolve: (specifier) => resolve(specifier, importerUrl),\n    }\n  }\n\n  return browserSystem\n}\n\nconst extractImportTypeFromUrl = (url) => {\n  const urlObject = new URL(url)\n  const { search } = urlObject\n  const searchParams = new URLSearchParams(search)\n\n  const importType = searchParams.get(\"import_type\")\n  if (!importType) {\n    return {}\n  }\n\n  searchParams.delete(\"import_type\")\n  urlObject.search = String(searchParams)\n  return {\n    importType,\n    urlWithoutImportType: urlObject.href,\n  }\n}\n\nconst instantiateAsJsonModule = async (url, { browserSystem, fetchSource }) => {\n  const response = await fetchSource(url, {\n    contentTypeExpected: \"application/json\",\n  })\n  const json = await response.json()\n  browserSystem.register([], (_export) => {\n    return {\n      execute: () => {\n        _export(\"default\", json)\n      },\n    }\n  })\n  const registration = browserSystem.getRegister(url)\n  if (!registration) {\n    throw new Error(\n      `no registration found for JSON at ${url}. Navigator.vendor: ${window.navigator.vendor}. JSON text: ${json}`,\n    )\n  }\n  return registration\n}\n\nconst instantiateAsCssModule = async (\n  url,\n  { importerUrl, browserSystem, fetchSource },\n) => {\n  const response = await fetchSource(url, {\n    contentTypeExpected: \"text/css\",\n  })\n  // There is a logic inside \"file_changes.js\" which is reloading\n  // all link rel=\"stylesheet\" when a file ending with \".css\" is modified\n  // But here it would not work because we have to replace the css in\n  // the adopted stylesheet + all module importing this css module\n  // should be reinstantiated\n  // -> the default behaviour for this CSS file should be a page reload\n  const { reloadMetas } = window.__jsenv_event_source_client__\n  // if below is to respect if import.meta.hot is called for this CSS file\n  // TODO: it's not the right way to check\n  // because code would do\n  /*\n  import style from \"./style.css\" assert { type: 'css' }\n  \n  if (import.meta.hot) {\n    let currentStyle = style\n    import.meta.hot.accept('./style.css', (newStyle) => {\n      document.adoptedStyleSheets = document.adoptedStyleSheets.filter((s) => s !== currentStyle);\n      document.adoptedStylesheets = [...document.adoptedStyleSheets, newStyle]\n      currentStyle = newStyle\n    })\n  }\n  */\n  if (!reloadMetas[url]) {\n    reloadMetas[url] = \"decline\"\n  }\n\n  const cssText = await response.text()\n  const cssTextWithBaseUrl = cssWithBaseUrl({\n    cssText,\n    cssUrl: url,\n    baseUrl: importerUrl,\n  })\n  browserSystem.register([], (_export) => {\n    return {\n      execute: () => {\n        const sheet = new CSSStyleSheet()\n        sheet.replaceSync(cssTextWithBaseUrl)\n        _export(\"default\", sheet)\n      },\n    }\n  })\n  const registration = browserSystem.getRegister(url)\n  if (!registration) {\n    throw new Error(\n      `no registration found for CSS at ${url}. Navigator.vendor: ${window.navigator.vendor}. CSS text: ${cssTextWithBaseUrl}`,\n    )\n  }\n  return registration\n}\n\n// CSSStyleSheet accepts a \"baseUrl\" parameter\n// as documented in https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleSheet/CSSStyleSheet#parameters\n// Unfortunately the polyfill do not seems to implement it\n// So we reuse \"systemjs\" strategy from https://github.com/systemjs/systemjs/blob/98609dbeef01ec62447e4b21449ce47e55f818bd/src/extras/module-types.js#L37\nconst cssWithBaseUrl = ({ cssUrl, cssText, baseUrl }) => {\n  const cssDirectoryUrl = new URL(\"./\", cssUrl).href\n  const baseDirectoryUrl = new URL(\"./\", baseUrl).href\n  if (cssDirectoryUrl === baseDirectoryUrl) {\n    return cssText\n  }\n  const cssTextRelocated = cssText.replace(\n    /url\\(\\s*(?:([\"'])((?:\\\\.|[^\\n\\\\\"'])+)\\1|((?:\\\\.|[^\\s,\"'()\\\\])+))\\s*\\)/g,\n    (match, quotes, relUrl1, relUrl2) => {\n      const absoluteUrl = new URL(relUrl1 || relUrl2, cssUrl).href\n      return `url(${quotes}${absoluteUrl}${quotes})`\n    },\n  )\n  return cssTextRelocated\n}\n\nconst createDetailedInstantiateError = async ({\n  instantiateError,\n  url,\n  importerUrl,\n  compileServerOrigin,\n  compileDirectoryRelativeUrl,\n  fetchSource,\n}) => {\n  let response\n  try {\n    response = await fetchSource(url, {\n      importerUrl,\n      contentTypeExpected: \"application/javascript\",\n    })\n  } catch (e) {\n    e.code = \"NETWORK_FAILURE\"\n    return e\n  }\n\n  const jsModuleResponseError = await getJavaScriptModuleResponseError(\n    response,\n    {\n      url,\n      importerUrl,\n      compileServerOrigin,\n      compileDirectoryRelativeUrl,\n    },\n  )\n  return jsModuleResponseError || instantiateError\n}\n",
    "const { performance } = window\n\nexport const measureAsyncFnPerf = performance\n  ? async (fn, name) => {\n      const perfMarkStartName = `${name}_start`\n\n      performance.mark(perfMarkStartName)\n      try {\n        const value = await fn()\n        return value\n      } finally {\n        performance.measure(name, perfMarkStartName)\n      }\n    }\n  : async (fn) => {\n      return fn()\n    }\n",
    "export const makeModuleNamespaceTransferable = (namespace) => {\n  const transferableNamespace = {}\n  Object.keys(namespace).forEach((key) => {\n    const value = namespace[key]\n    transferableNamespace[key] = isTransferable(value)\n      ? value\n      : hideNonTransferableValue(value)\n  })\n  return transferableNamespace\n}\n\nconst hideNonTransferableValue = (value) => {\n  if (typeof value === \"function\") {\n    return `[[HIDDEN: ${value.name} function cannot be transfered]]`\n  }\n\n  if (typeof value === \"symbol\") {\n    return `[[HIDDEN: symbol function cannot be transfered]]`\n  }\n\n  return `[[HIDDEN: ${\n    value.constructor ? value.constructor.name : \"object\"\n  } cannot be transfered]]`\n}\n\n// https://stackoverflow.com/a/32673910/2634179\nconst isTransferable = (value) => {\n  const seenArray = []\n  const visit = () => {\n    if (typeof value === \"function\") return false\n\n    if (typeof value === \"symbol\") return false\n\n    if (value === null) return false\n\n    if (typeof value === \"object\") {\n      const constructorName = value.constructor.namespace\n\n      if (supportedTypes.includes(constructorName)) {\n        return true\n      }\n\n      const maybe = maybeTypes.includes(constructorName)\n      if (maybe) {\n        const visited = seenArray.includes(value)\n        if (visited) {\n          // we don't really know until we are done visiting the object\n          // implementing it properly means waiting for the recursion to be done\n          // let's just\n          return true\n        }\n        seenArray.push(value)\n\n        if (constructorName === \"Array\" || constructorName === \"Object\") {\n          return Object.keys(value).every((key) => isTransferable(value[key]))\n        }\n        if (constructorName === \"Map\") {\n          return (\n            [...value.keys()].every(isTransferable) &&\n            [...value.values()].every(isTransferable)\n          )\n        }\n        if (constructorName === \"Set\") {\n          return [...value.keys()].every(isTransferable)\n        }\n      }\n\n      // Error, DOM Node and others\n      return false\n    }\n    return true\n  }\n\n  return visit(value)\n}\n\nconst supportedTypes = [\n  \"Boolean\",\n  \"Number\",\n  \"String\",\n  \"Date\",\n  \"RegExp\",\n  \"Blob\",\n  \"FileList\",\n  \"ImageData\",\n  \"ImageBitmap\",\n  \"ArrayBuffer\",\n]\n\nconst maybeTypes = [\"Array\", \"Object\", \"Map\", \"Set\"]\n",
    "import { normalizeImportMap } from \"@jsenv/importmap/src/normalizeImportMap.js\"\n\n// do not use memoize from @jsenv/filesystem to avoid pulling @jsenv/filesystem code into the browser build\nimport { fetchUrl } from \"@jsenv/core/src/internal/browser_utils/fetch_browser.js\"\nimport { createImportResolverForImportmap } from \"@jsenv/core/src/internal/import_resolution/import_resolver_importmap.js\"\nimport { memoize } from \"@jsenv/core/src/internal/memoize.js\"\n\nimport { createBrowserSystem } from \"./browser_system.js\"\nimport { measureAsyncFnPerf } from \"./perf_browser.js\"\nimport { makeModuleNamespaceTransferable } from \"./module_namespace_transfer.js\"\n\nconst memoizedCreateBrowserSystem = memoize(createBrowserSystem)\n\nexport const createBrowserClient = async ({\n  compileServerOrigin,\n  jsenvDirectoryRelativeUrl,\n  compileId,\n}) => {\n  const fetchSource = (url, { contentTypeExpected }) => {\n    return fetchUrl(url, {\n      credentials: \"same-origin\",\n      contentTypeExpected,\n    })\n  }\n\n  const fetchJson = async (url) => {\n    const response = await fetchSource(url, {\n      contentTypeExpected: \"application/json\",\n    })\n    const json = await response.json()\n    return json\n  }\n\n  const compileServerMetaUrl = String(\n    new URL(\"__jsenv_compile_profile__\", `${compileServerOrigin}/`),\n  )\n  const { importDefaultExtension } = await fetchJson(compileServerMetaUrl)\n  const compileDirectoryRelativeUrl = `${jsenvDirectoryRelativeUrl}${compileId}/`\n  // if there is an importmap in the document we use it instead of fetching.\n  // systemjs style with systemjs-importmap\n  const importmapScript = document.querySelector(\n    `script[type=\"systemjs-importmap\"]`,\n  )\n  let importMap\n  let importMapUrl\n  if (importmapScript) {\n    let importmapRaw\n    if (importmapScript.src) {\n      importMapUrl = importmapScript.src\n      const importmapFileResponse = await fetchSource(importMapUrl, {\n        contentTypeExpected: \"application/importmap+json\",\n      })\n      importmapRaw =\n        importmapFileResponse.status === 404\n          ? {}\n          : await importmapFileResponse.json()\n    } else {\n      importMapUrl = document.location.href\n      importmapRaw = JSON.parse(importmapScript.textContent) || {}\n    }\n    importMap = normalizeImportMap(importmapRaw, importMapUrl)\n  }\n\n  const importResolver = await createImportResolverForImportmap({\n    // projectDirectoryUrl,\n    compileServerOrigin,\n    compileDirectoryRelativeUrl,\n    importMap,\n    importMapUrl,\n    importDefaultExtension,\n  })\n\n  const importFile = async (specifier) => {\n    const browserSystem = await memoizedCreateBrowserSystem({\n      compileServerOrigin,\n      compileDirectoryRelativeUrl,\n      fetchSource,\n      importResolver,\n    })\n    return browserSystem.import(specifier)\n  }\n\n  const executeFile = async (\n    specifier,\n    {\n      transferableNamespace = false,\n      executionExposureOnWindow = false,\n      errorTransform = (error) => error,\n      measurePerformance,\n    } = {},\n  ) => {\n    const browserSystem = await memoizedCreateBrowserSystem({\n      compileServerOrigin,\n      compileDirectoryRelativeUrl,\n      fetchSource,\n      importResolver,\n    })\n\n    const importUsingSystemJs = async () => {\n      try {\n        let namespace = await browserSystem.import(specifier)\n\n        if (transferableNamespace) {\n          namespace = makeModuleNamespaceTransferable(namespace)\n        }\n\n        return {\n          status: \"completed\",\n          namespace,\n          coverage: readCoverage(),\n        }\n      } catch (error) {\n        let transformedError\n        try {\n          transformedError = await errorTransform(error)\n        } catch (e) {\n          transformedError = error\n        }\n\n        return {\n          status: \"errored\",\n          error: transformedError,\n          coverage: readCoverage(),\n        }\n      }\n    }\n\n    const executionResult = await (measurePerformance\n      ? measureAsyncFnPerf(importUsingSystemJs, `jsenv_file_import`)\n      : importUsingSystemJs())\n    if (executionExposureOnWindow) {\n      window.__executionResult__ = executionResult\n    }\n    return executionResult\n  }\n\n  return {\n    compileDirectoryRelativeUrl,\n    importFile,\n    executeFile,\n  }\n}\n\nconst readCoverage = () => window.__coverage__\n",
    "/* eslint-env browser, node */\n\nexport const DataUrl = {\n  parse: (string, { as = \"raw\" } = {}) => {\n    const afterDataProtocol = string.slice(\"data:\".length)\n    const commaIndex = afterDataProtocol.indexOf(\",\")\n    const beforeComma = afterDataProtocol.slice(0, commaIndex)\n\n    let mediaType\n    let base64Flag\n    if (beforeComma.endsWith(`;base64`)) {\n      mediaType = beforeComma.slice(0, -`;base64`.length)\n      base64Flag = true\n    } else {\n      mediaType = beforeComma\n      base64Flag = false\n    }\n\n    const afterComma = afterDataProtocol.slice(commaIndex + 1)\n    return {\n      mediaType: mediaType === \"\" ? \"text/plain;charset=US-ASCII\" : mediaType,\n      base64Flag,\n      data:\n        as === \"string\" && base64Flag ? base64ToString(afterComma) : afterComma,\n    }\n  },\n\n  stringify: ({ mediaType, base64Flag = true, data }) => {\n    if (!mediaType || mediaType === \"text/plain;charset=US-ASCII\") {\n      // can be a buffer or a string, hence check on data.length instead of !data or data === ''\n      if (data.length === 0) {\n        return `data:,`\n      }\n      if (base64Flag) {\n        return `data:,${data}`\n      }\n      return `data:,${dataToBase64(data)}`\n    }\n    if (base64Flag) {\n      return `data:${mediaType};base64,${dataToBase64(data)}`\n    }\n    return `data:${mediaType},${data}`\n  },\n}\n\nconst dataToBase64 =\n  typeof window === \"object\"\n    ? window.atob\n    : (data) => Buffer.from(data).toString(\"base64\")\n\nconst base64ToString =\n  typeof window === \"object\"\n    ? window.btoa\n    : (base64String) => Buffer.from(base64String, \"base64\").toString(\"utf8\")\n",
    "export const generateSourcemapUrl = (url) => {\n  // we want to remove eventual search params from url\n  const urlString = String(url)\n  const urlObject = new URL(url)\n  const origin = urlString.startsWith(\"file://\") ? \"file://\" : urlObject.origin\n  const pathname = urlObject.pathname\n  const sourcemapUrl = `${origin}${pathname}.map`\n  return sourcemapUrl\n}\n\nexport const getJavaScriptSourceMappingUrl = (javaScriptSource) => {\n  let sourceMappingUrl\n  replaceSourceMappingUrl(\n    javaScriptSource,\n    javascriptSourceMappingUrlCommentRegexp,\n    (value) => {\n      sourceMappingUrl = value\n    },\n  )\n  return sourceMappingUrl\n}\n\nexport const setJavaScriptSourceMappingUrl = (\n  javaScriptSource,\n  sourceMappingFileUrl,\n) => {\n  let replaced\n  const sourceAfterReplace = replaceSourceMappingUrl(\n    javaScriptSource,\n    javascriptSourceMappingUrlCommentRegexp,\n    () => {\n      replaced = true\n      return sourceMappingFileUrl\n        ? writeJavaScriptSourceMappingURL(sourceMappingFileUrl)\n        : \"\"\n    },\n  )\n  if (replaced) {\n    return sourceAfterReplace\n  }\n\n  return sourceMappingFileUrl\n    ? `${javaScriptSource}\n${writeJavaScriptSourceMappingURL(sourceMappingFileUrl)}`\n    : javaScriptSource\n}\n\nexport const getCssSourceMappingUrl = (cssSource) => {\n  let sourceMappingUrl\n  replaceSourceMappingUrl(\n    cssSource,\n    cssSourceMappingUrlCommentRegExp,\n    (value) => {\n      sourceMappingUrl = value\n    },\n  )\n  return sourceMappingUrl\n}\n\nexport const setCssSourceMappingUrl = (cssSource, sourceMappingFileUrl) => {\n  let replaced\n  const sourceAfterReplace = replaceSourceMappingUrl(\n    cssSource,\n    cssSourceMappingUrlCommentRegExp,\n    () => {\n      replaced = true\n      return sourceMappingFileUrl\n        ? writeCssSourceMappingUrl(sourceMappingFileUrl)\n        : \"\"\n    },\n  )\n  if (replaced) {\n    return sourceAfterReplace\n  }\n  return sourceMappingFileUrl\n    ? `${cssSource}\n${writeCssSourceMappingUrl(sourceMappingFileUrl)}`\n    : cssSource\n}\n\nconst javascriptSourceMappingUrlCommentRegexp =\n  /\\/\\/ ?# ?sourceMappingURL=([^\\s'\"]+)/g\nconst cssSourceMappingUrlCommentRegExp =\n  /\\/\\*# ?sourceMappingURL=([^\\s'\"]+) \\*\\//g\n\n// ${\"//#\"} is to avoid a parser thinking there is a sourceMappingUrl for this file\nconst writeJavaScriptSourceMappingURL = (value) =>\n  `${\"//#\"} sourceMappingURL=${value}`\nconst writeCssSourceMappingUrl = (value) => `/*# sourceMappingURL=${value} */`\n\nexport const sourcemapToBase64Url = (sourcemap) => {\n  const asBase64 = Buffer.from(JSON.stringify(sourcemap)).toString(\"base64\")\n  return `data:application/json;charset=utf-8;base64,${asBase64}`\n}\n\nconst replaceSourceMappingUrl = (source, regexp, callback) => {\n  let lastSourceMappingUrl\n  let matchSourceMappingUrl\n  while ((matchSourceMappingUrl = regexp.exec(source))) {\n    lastSourceMappingUrl = matchSourceMappingUrl\n  }\n  if (lastSourceMappingUrl) {\n    const index = lastSourceMappingUrl.index\n    const before = source.slice(0, index)\n    const after = source.slice(index)\n    const mappedAfter = after.replace(regexp, (match, firstGroup) => {\n      return callback(firstGroup)\n    })\n    return `${before}${mappedAfter}`\n  }\n  return source\n}\n",
    "export const startsWithWindowsDriveLetter = (string) => {\n  const firstChar = string[0]\n  if (!/[a-zA-Z]/.test(firstChar)) return false\n\n  const secondChar = string[1]\n  if (secondChar !== \":\") return false\n\n  return true\n}\n\nexport const windowsFilePathToUrl = (windowsFilePath) => {\n  return `file:///${replaceBackSlashesWithSlashes(windowsFilePath)}`\n}\n\nexport const replaceBackSlashesWithSlashes = (string) =>\n  string.replace(/\\\\/g, \"/\")\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\n\nimport {\n  startsWithWindowsDriveLetter,\n  windowsFilePathToUrl,\n} from \"@jsenv/core/src/internal/windows_file_path_utils.js\"\n\nexport const remapCallSite = async (\n  callSite,\n  { urlToSourcemapConsumer, resolveFile, readErrorStack, onFailure },\n) => {\n  if (callSite.isNative()) {\n    return callSite\n  }\n\n  // Most call sites will return the source file from getFileName(), but code\n  // passed to eval() ending in \"//# sourceURL=...\" will return the source file\n  // from getScriptNameOrSourceURL() instead\n  const source = callSite.getFileName() || callSite.getScriptNameOrSourceURL()\n  if (source) {\n    const line = callSite.getLineNumber()\n    const column = callSite.getColumnNumber() - 1\n    const originalPosition = await remapSourcePosition({\n      source,\n      line,\n      column,\n      resolveFile,\n      urlToSourcemapConsumer,\n      readErrorStack,\n      onFailure,\n    })\n\n    const callSiteClone = cloneCallSite(callSite)\n\n    callSiteClone.getFunctionName = () =>\n      originalPosition.name || callSite.getFunctionName()\n    callSiteClone.getFileName = () => originalPosition.source\n    callSiteClone.getLineNumber = () => originalPosition.line\n    callSiteClone.getColumnNumber = () => originalPosition.column + 1\n    callSiteClone.getScriptNameOrSourceURL = () => originalPosition.source\n\n    return callSiteClone\n  }\n\n  // Code called using eval() needs special handling\n  if (callSite.isEval()) {\n    const origin = callSite.getEvalOrigin()\n    if (origin) {\n      const callSiteClone = cloneCallSite(callSite)\n      const originalEvalOrigin = await remapEvalOrigin(origin, {\n        resolveFile,\n        urlToSourcemapConsumer,\n        readErrorStack,\n        onFailure,\n      })\n      callSiteClone.getEvalOrigin = () => originalEvalOrigin\n      return callSiteClone\n    }\n    return callSite\n  }\n\n  // If we get here then we were unable to change the source position\n  return callSite\n}\n\nconst cloneCallSite = (callSite) => {\n  const callSiteClone = {}\n  methods.forEach((name) => {\n    callSiteClone[name] = () => callSite[name]()\n  })\n  callSiteClone.toString = () => callSiteToFunctionCall(callSiteClone)\n\n  return callSiteClone\n}\n\nconst methods = [\n  \"getColumnNumber\",\n  \"getEvalOrigin\",\n  \"getFileName\",\n  \"getFunction\",\n  \"getFunctionName\",\n  \"getLineNumber\",\n  \"getMethodName\",\n  \"getPosition\",\n  \"getScriptNameOrSourceURL\",\n  \"getThis\",\n  \"getTypeName\",\n  \"isConstructor\",\n  \"isEval\",\n  \"isNative\",\n  \"isToplevel\",\n  \"toString\",\n]\n\nconst callSiteToFunctionCall = (callSite) => {\n  const fileLocation = callSiteToFileLocation(callSite)\n  const isConstructor = callSite.isConstructor()\n  const isMethodCall = !callSite.isToplevel() && !isConstructor\n\n  if (isMethodCall) {\n    return `${callSiteToMethodCall(callSite)} (${fileLocation})`\n  }\n\n  const functionName = callSite.getFunctionName()\n  if (isConstructor) {\n    return `new ${functionName || \"<anonymous>\"} (${fileLocation})`\n  }\n\n  if (functionName) {\n    return `${functionName} (${fileLocation})`\n  }\n\n  return `${fileLocation}`\n}\n\nconst callSiteToMethodCall = (callSite) => {\n  const functionName = callSite.getFunctionName()\n  const typeName = callSiteToType(callSite)\n\n  if (!functionName) {\n    return `${typeName}.<anonymous>`\n  }\n\n  const methodName = callSite.getMethodName()\n  const as = generateAs({ methodName, functionName })\n\n  if (typeName && !functionName.startsWith(typeName)) {\n    return `${typeName}.${functionName}${as}`\n  }\n\n  return `${functionName}${as}`\n}\n\nconst generateAs = ({ methodName, functionName }) => {\n  if (!methodName) return \"\"\n  if (\n    functionName.indexOf(`.${methodName}`) ===\n    functionName.length - methodName.length - 1\n  )\n    return \"\"\n  return ` [as ${methodName}]`\n}\n\nconst callSiteToType = (callSite) => {\n  const typeName = callSite.getTypeName()\n  // Fixes shim to be backward compatible with Node v0 to v4\n  if (typeName === \"[object Object]\") {\n    return \"null\"\n  }\n  return typeName\n}\n\nconst callSiteToFileLocation = (callSite) => {\n  if (callSite.isNative()) return \"native\"\n\n  const sourceFile = callSiteToSourceFile(callSite)\n  const lineNumber = callSite.getLineNumber()\n  if (lineNumber === null) {\n    return sourceFile\n  }\n\n  const columnNumber = callSite.getColumnNumber()\n  if (!columnNumber) {\n    return `${sourceFile}:${lineNumber}`\n  }\n\n  return `${sourceFile}:${lineNumber}:${columnNumber}`\n}\n\nconst callSiteToSourceFile = (callSite) => {\n  const fileName = callSite.getScriptNameOrSourceURL()\n\n  if (fileName) {\n    return fileName\n  }\n\n  // Source code does not originate from a file and is not native, but we\n  // can still get the source position inside the source string, e.g. in\n  // an eval string.\n  if (callSite.isEval()) {\n    return `${callSite.getEvalOrigin()}, <anonymous>`\n  }\n\n  return \"<anonymous>\"\n}\n\n// Parses code generated by FormatEvalOrigin(), a function inside V8:\n// https://code.google.com/p/v8/source/browse/trunk/src/messages.js\nconst remapEvalOrigin = async (\n  origin,\n  { resolveFile, urlToSourcemapConsumer, onFailure },\n) => {\n  // Most eval() calls are in this format\n  const topLevelEvalMatch = /^eval at ([^(]+) \\((.+):(\\d+):(\\d+)\\)$/.exec(\n    origin,\n  )\n  if (topLevelEvalMatch) {\n    const source = topLevelEvalMatch[2]\n    const line = Number(topLevelEvalMatch[3])\n    const column = topLevelEvalMatch[4] - 1\n    const originalPosition = await remapSourcePosition({\n      source,\n      line,\n      column,\n      resolveFile,\n      urlToSourcemapConsumer,\n      onFailure,\n    })\n    return `eval at ${topLevelEvalMatch[1]} (${originalPosition.source}:${\n      originalPosition.line\n    }:${originalPosition.column + 1})`\n  }\n\n  // Parse nested eval() calls using recursion\n  const nestedEvalMatch = /^eval at ([^(]+) \\((.+)\\)$/.exec(origin)\n  if (nestedEvalMatch) {\n    const originalEvalOrigin = await remapEvalOrigin(nestedEvalMatch[2], {\n      resolveFile,\n      urlToSourcemapConsumer,\n      onFailure,\n    })\n    return `eval at ${nestedEvalMatch[1]} (${originalEvalOrigin})`\n  }\n\n  // Make sure we still return useful information if we didn't find anything\n  return origin\n}\n\nconst remapSourcePosition = async ({\n  source,\n  line,\n  column,\n  resolveFile,\n  urlToSourcemapConsumer,\n  readErrorStack,\n  onFailure,\n}) => {\n  const position = { source, line, column }\n\n  const url = sourceToUrl(source, { resolveFile })\n  if (!url) return position\n\n  const sourceMapConsumer = await urlToSourcemapConsumer(url)\n\n  if (!sourceMapConsumer) return position\n\n  try {\n    const originalPosition = sourceMapConsumer.originalPositionFor(position)\n\n    // Only return the original position if a matching line was found. If no\n    // matching line is found then we return position instead, which will cause\n    // the stack trace to print the path and line for the compiled file. It is\n    // better to give a precise location in the compiled file than a vague\n    // location in the original file.\n    const originalSource = originalPosition.source\n\n    if (originalSource === null) return position\n    originalPosition.source = resolveFile(originalSource, url, {\n      type: \"file-original\",\n    })\n\n    return originalPosition\n  } catch (e) {\n    onFailure(\n      createDetailedMessage(`error while remapping position.`, {\n        [\"error stack\"]: readErrorStack(e),\n        [\"source\"]: source,\n        [\"line\"]: line,\n        [\"column\"]: column,\n      }),\n    )\n    return position\n  }\n}\n\nconst sourceToUrl = (source, { resolveFile }) => {\n  if (startsWithScheme(source)) {\n    return source\n  }\n\n  // linux filesystem path\n  if (source[0] === \"/\") {\n    return resolveFile(source)\n  }\n\n  // be careful, due to babel or something like that we might receive paths like\n  // C:/directory/file.js (without backslashes we would expect on windows)\n  // In that case we consider C: is the signe we are on windows\n  // And I avoid to rely on process.platform === \"win32\" because this file might be executed in chrome\n  if (startsWithWindowsDriveLetter(source)) {\n    return windowsFilePathToUrl(source)\n  }\n\n  // I don't think we will ever encounter relative file in the stack trace\n  // but if it ever happens we are safe :)\n  if (source.slice(0, 2) === \"./\" || source.slice(0, 3) === \"../\") {\n    return resolveFile(source)\n  }\n\n  // we have received a \"bare specifier\" for the source\n  // it happens for internal/process/task_queues.js for instance\n  // if we do return resolveFile(source) it will be converted to\n  // file:///C:/project-directory/internal/process/task_queues.js in node\n  // and\n  // http://domain.com/internal/process/task_queues.js\n  // but the file will certainly be a 404\n  // and if not it won't be the right file anyway\n  // for now we assume \"bare specifier\" in the stack trace\n  // are internal files that are pointless to try to remap\n  return null\n}\n\nconst startsWithScheme = (string) => {\n  return /^[a-zA-Z]{2,}:/.test(string)\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\n\nimport { DataUrl } from \"@jsenv/core/src/internal/data_url.js\"\nimport { getJavaScriptSourceMappingUrl } from \"@jsenv/core/src/internal/sourcemap_utils.js\"\n\nimport { remapCallSite } from \"./remap_call_site.js\"\n\nexport const remapStack = async ({\n  stack,\n  resolveFile,\n  fetchFile,\n  SourceMapConsumer,\n  readErrorStack,\n  onFailure,\n}) => {\n  const urlToSourcemapConsumer = memoizeByFirstArgStringValue(\n    async (stackTraceFileUrl) => {\n      if (stackTraceFileUrl.startsWith(\"node:\")) {\n        return null\n      }\n\n      try {\n        let text\n        try {\n          const fileResponse = await fetchFile(stackTraceFileUrl)\n          const { status } = fileResponse\n          if (status !== 200) {\n            if (status === 404) {\n              onFailure(`stack trace file not found at ${stackTraceFileUrl}`)\n            } else {\n              onFailure(\n                createDetailedMessage(\n                  `unexpected response fetching stack trace file.`,\n                  {\n                    [\"response status\"]: status,\n                    [\"response text\"]: fileResponse.body,\n                    [\"stack trace file\"]: stackTraceFileUrl,\n                  },\n                ),\n              )\n            }\n            return null\n          }\n          text = await fileResponse.text()\n        } catch (e) {\n          onFailure(\n            createDetailedMessage(`error while fetching stack trace file.`, {\n              [\"fetch error stack\"]: readErrorStack(e),\n              [\"stack trace file\"]: stackTraceFileUrl,\n            }),\n          )\n\n          return null\n        }\n\n        const jsSourcemapUrl = getJavaScriptSourceMappingUrl(text)\n        if (!jsSourcemapUrl) {\n          return null\n        }\n\n        let sourcemapUrl\n        let sourcemapString\n        if (jsSourcemapUrl.startsWith(\"data:\")) {\n          sourcemapUrl = stackTraceFileUrl\n          sourcemapString = DataUrl.parse(jsSourcemapUrl, { as: \"string\" })\n        } else {\n          sourcemapUrl = resolveFile(jsSourcemapUrl, stackTraceFileUrl, {\n            type: \"source-map\",\n          })\n\n          try {\n            const sourcemapResponse = await fetchFile(sourcemapUrl)\n            const { status } = sourcemapResponse\n            if (status !== 200) {\n              if (status === 404) {\n                onFailure(`sourcemap file not found at ${sourcemapUrl}`)\n              } else {\n                onFailure(\n                  createDetailedMessage(\n                    `unexpected response for sourcemap file.`,\n                    {\n                      [\"response status\"]: status,\n                      [\"response text\"]: await sourcemapResponse.text(),\n                      [\"sourcemap url\"]: sourcemapUrl,\n                    },\n                  ),\n                )\n              }\n              return null\n            }\n            sourcemapString = await sourcemapResponse.text()\n          } catch (e) {\n            onFailure(\n              createDetailedMessage(`error while fetching sourcemap.`, {\n                [\"fetch error stack\"]: readErrorStack(e),\n                [\"sourcemap url\"]: sourcemapUrl,\n              }),\n            )\n            return null\n          }\n        }\n\n        let sourceMap\n        try {\n          sourceMap = JSON.parse(sourcemapString)\n        } catch (e) {\n          onFailure(\n            createDetailedMessage(`error while parsing sourcemap.`, {\n              [\"parse error stack\"]: readErrorStack(e),\n              [\"sourcemap url\"]: sourcemapUrl,\n            }),\n          )\n          return null\n        }\n\n        let { sourcesContent } = sourceMap\n\n        if (!sourcesContent) {\n          sourcesContent = []\n          sourceMap.sourcesContent = sourcesContent\n        }\n\n        let firstSourceMapSourceFailure = null\n\n        await Promise.all(\n          sourceMap.sources.map(async (source, index) => {\n            if (index in sourcesContent) return\n\n            const sourcemapSourceUrl = resolveFile(source, sourcemapUrl, {\n              type: \"source\",\n            })\n            try {\n              const sourceResponse = await fetchFile(sourcemapSourceUrl)\n              const { status } = sourceResponse\n              if (status !== 200) {\n                if (firstSourceMapSourceFailure) return\n\n                if (status === 404) {\n                  firstSourceMapSourceFailure = createDetailedMessage(\n                    `sourcemap source not found.`,\n                    {\n                      [\"sourcemap source url\"]: sourcemapSourceUrl,\n                      [\"sourcemap url\"]: sourcemapUrl,\n                    },\n                  )\n                  return\n                }\n                firstSourceMapSourceFailure = createDetailedMessage(\n                  `unexpected response for sourcemap source.`,\n                  {\n                    [\"response status\"]: status,\n                    [\"response text\"]: await sourceResponse.text(),\n                    [\"sourcemap source url\"]: sourcemapSourceUrl,\n                    [\"sourcemap url\"]: sourcemapUrl,\n                  },\n                )\n                return\n              }\n\n              const sourceString = await sourceResponse.text()\n              sourcesContent[index] = sourceString\n            } catch (e) {\n              if (firstSourceMapSourceFailure) return\n              firstSourceMapSourceFailure = createDetailedMessage(\n                `error while fetching sourcemap source.`,\n                {\n                  [\"fetch error stack\"]: readErrorStack(e),\n                  [\"sourcemap source url\"]: sourcemapSourceUrl,\n                  [\"sourcemap url\"]: sourcemapUrl,\n                },\n              )\n            }\n          }),\n        )\n\n        if (firstSourceMapSourceFailure) {\n          onFailure(firstSourceMapSourceFailure)\n          return null\n        }\n\n        return new SourceMapConsumer(sourceMap)\n      } catch (e) {\n        onFailure(\n          createDetailedMessage(\n            `error while preparing a sourceMap consumer for a stack trace file.`,\n            {\n              [\"error stack\"]: readErrorStack(e),\n              [\"stack trace file\"]: stackTraceFileUrl,\n            },\n          ),\n        )\n        return null\n      }\n    },\n  )\n  const originalCallsites = await Promise.all(\n    stack.map((callSite) =>\n      remapCallSite(callSite, {\n        resolveFile,\n        urlToSourcemapConsumer,\n        readErrorStack,\n        onFailure,\n      }),\n    ),\n  )\n  return originalCallsites\n}\n\nconst memoizeByFirstArgStringValue = (fn) => {\n  const stringValueCache = {}\n  return (firstArgValue) => {\n    if (firstArgValue in stringValueCache)\n      return stringValueCache[firstArgValue]\n    const value = fn(firstArgValue)\n    stringValueCache[firstArgValue] = value\n    return value\n  }\n}\n",
    "export const stringifyStack = (stack, { error, indent }) => {\n  const name = error.name || \"Error\"\n  const message = error.message || \"\"\n  const stackString = stack\n    .map((callSite) => `\\n${indent}at ${callSite}`)\n    .join(\"\")\n\n  return `${name}: ${message}${stackString}`\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\n\nimport { remapStack } from \"./remap_stack.js\"\nimport { stringifyStack } from \"./stringify_stack.js\"\n\nexport const installErrorStackRemapping = ({\n  fetchFile,\n  resolveFile,\n  SourceMapConsumer,\n  indent = \"  \",\n}) => {\n  if (typeof fetchFile !== \"function\") {\n    throw new TypeError(`fetchFile must be a function, got ${fetchFile}`)\n  }\n  if (typeof SourceMapConsumer !== \"function\") {\n    throw new TypeError(\n      `sourceMapConsumer must be a function, got ${SourceMapConsumer}`,\n    )\n  }\n  if (typeof indent !== \"string\") {\n    throw new TypeError(`indent must be a string, got ${indent}`)\n  }\n\n  const errorRemappingCache = new WeakMap()\n  const errorRemapFailureCallbackMap = new WeakMap()\n\n  let installed = false\n  const previousPrepareStackTrace = Error.prepareStackTrace\n  const install = () => {\n    if (installed) return\n    installed = true\n    Error.prepareStackTrace = prepareStackTrace\n  }\n\n  const uninstall = () => {\n    if (!installed) return\n    installed = false\n    Error.prepareStackTrace = previousPrepareStackTrace\n  }\n\n  // ensure we do not use prepareStackTrace for thoose error\n  // otherwise we would recursively remap error stack\n  // and if the reason causing the failure is still here\n  // it would create an infinite loop\n  const readErrorStack = (error) => {\n    uninstall()\n    const stack = error.stack\n    install()\n    return stack\n  }\n\n  const prepareStackTrace = (error, stack) => {\n    const onFailure = (failureData) => {\n      const failureCallbackArray = errorRemapFailureCallbackMap.get(error)\n      if (failureCallbackArray) {\n        failureCallbackArray.forEach((callback) => callback(failureData))\n      }\n    }\n\n    const stackRemappingPromise = remapStack({\n      stack,\n      error,\n      resolveFile,\n      fetchFile: memoizeFetch(fetchFile),\n      SourceMapConsumer,\n      readErrorStack,\n      indent,\n      onFailure,\n    })\n    errorRemappingCache.set(error, stackRemappingPromise)\n\n    return stringifyStack(stack, { error, indent })\n  }\n\n  const getErrorOriginalStackString = async (\n    error,\n    {\n      onFailure = (message) => {\n        console.warn(message)\n      },\n    } = {},\n  ) => {\n    if (onFailure) {\n      const remapFailureCallbackArray = errorRemapFailureCallbackMap.get(error)\n      if (remapFailureCallbackArray) {\n        errorRemapFailureCallbackMap.set(error, [\n          ...remapFailureCallbackArray,\n          onFailure,\n        ])\n      } else {\n        errorRemapFailureCallbackMap.set(error, [onFailure])\n      }\n    }\n\n    // ensure Error.prepareStackTrace gets triggered by reading error.stack now\n    const { stack } = error\n    const promise = errorRemappingCache.get(error)\n\n    if (promise) {\n      try {\n        const originalCallsites = await promise\n        errorRemapFailureCallbackMap.get(error)\n\n        const firstCall = originalCallsites[0]\n        if (firstCall) {\n          Object.assign(error, {\n            filename: firstCall.getFileName(),\n            lineno: firstCall.getLineNumber(),\n            columnno: firstCall.getColumnNumber(),\n          })\n        }\n        return stringifyStack(originalCallsites, { error, indent })\n      } catch (e) {\n        onFailure(\n          createDetailedMessage(`error while computing original stack.`, {\n            [\"stack from error while computing\"]: readErrorStack(e),\n            [\"stack from error to remap\"]: stack,\n          }),\n        )\n        return stack\n      }\n    }\n\n    return stack\n  }\n\n  install()\n\n  return { getErrorOriginalStackString, uninstall }\n}\n\nconst memoizeFetch = (fetchUrl) => {\n  const urlCache = {}\n  return async (url) => {\n    if (url in urlCache) {\n      return urlCache[url]\n    }\n    const responsePromise = fetchUrl(url)\n    urlCache[url] = responsePromise\n    return responsePromise\n  }\n}\n",
    "import { installErrorStackRemapping } from \"@jsenv/core/src/internal/error_stack_remap/install_error_stack_remapping.js\"\n\nexport const installBrowserErrorStackRemapping = (options = {}) =>\n  installErrorStackRemapping({\n    fetchFile: async (url) => {\n      // browser having Error.captureStackTrace got window.fetch\n      // and this executes only when Error.captureStackTrace exists\n      // so no need for polyfill or whatever here\n      const response = await window.fetch(url, {\n        // by default a script tag is in \"no-cors\"\n        // so we also fetch url with \"no-cors\"\n        mode: \"no-cors\",\n      })\n      // we read response test before anything because once memoized fetch\n      // gets annoying preventing you to read\n      // body multiple times, even using response.clone()\n      const text = await response.text()\n      return {\n        status: response.status,\n        url: response.url,\n        statusText: response.statusText,\n        headers: responseToHeaders(response),\n        text: () => text,\n        json: response.json.bind(response),\n        blob: response.blob.bind(response),\n        arrayBuffer: response.arrayBuffer.bind(response),\n      }\n    },\n    resolveFile: (specifier, importer = window.location.href) => {\n      // browsers having Error.captureStrackTrace got window.URL\n      // and this executes only when Error.captureStackTrace exists\n      return String(new URL(specifier, importer))\n    },\n    ...options,\n  })\n\nconst responseToHeaders = (response) => {\n  const headers = {}\n  response.headers.forEach((value, name) => {\n    headers[name] = value\n  })\n  return headers\n}\n",
    "export const displayErrorInDocument = (error) => {\n  const title = \"An error occured\"\n  let theme\n  let message\n\n  if (error && error.parsingError) {\n    theme = \"light\"\n    const { parsingError } = error\n    message = errorToHTML(\n      parsingError.messageHTML || escapeHtml(parsingError.message),\n    )\n  } else {\n    theme = \"dark\"\n    message = errorToHTML(error)\n  }\n\n  const css = `\n    .jsenv-console {\n      background: rgba(0, 0, 0, 0.95);\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      z-index: 1000;\n      box-sizing: border-box;\n      padding: 1em;\n    }\n\n    .jsenv-console h1 {\n      color: red;\n      display: flex;\n      align-items: center;\n    }\n\n    #button-close-jsenv-console {\n      margin-left: 10px;\n    }\n\n    .jsenv-console pre {\n      overflow: auto;\n      max-width: 70em;\n      /* avoid scrollbar to hide the text behind it */\n      padding: 20px;\n    }\n\n    .jsenv-console pre[data-theme=\"dark\"] {\n      background: #111;\n      border: 1px solid #333;\n      color: #eee;\n    }\n\n    .jsenv-console pre[data-theme=\"light\"] {\n      background: #1E1E1E;\n      border: 1px solid white;\n      color: #EEEEEE;\n    }\n\n    .jsenv-console pre a {\n      color: inherit;\n    }\n    `\n  const html = `\n      <style type=\"text/css\">${css}></style>\n      <div class=\"jsenv-console\">\n        <h1>${title} <button id=\"button-close-jsenv-console\">X</button></h1>\n        <pre data-theme=\"${theme}\">${message}</pre>\n      </div>\n      `\n  const removeJsenvConsole = appendHMTLInside(html, document.body)\n\n  document.querySelector(\"#button-close-jsenv-console\").onclick = () => {\n    removeJsenvConsole()\n  }\n}\n\nconst escapeHtml = (string) => {\n  return string\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\")\n}\n\nconst errorToHTML = (error) => {\n  let html\n\n  if (error && error instanceof Error) {\n    //  stackTrace formatted by V8\n    if (Error.captureStackTrace) {\n      html = escapeHtml(error.stack)\n    } else {\n      // other stack trace such as firefox do not contain error.message\n      html = escapeHtml(`${error.message}\n  ${error.stack}`)\n    }\n  } else if (typeof error === \"string\") {\n    html = error\n  } else if (error === undefined) {\n    html = \"undefined\"\n  } else {\n    html = JSON.stringify(error)\n  }\n\n  const htmlWithCorrectLineBreaks = html.replace(/\\n/g, \"\\n\")\n  const htmlWithLinks = stringToStringWithLink(htmlWithCorrectLineBreaks, {\n    transform: (url) => {\n      return { href: url, text: url }\n    },\n  })\n  return htmlWithLinks\n}\n\n// `Error: yo\n// at Object.execute (http://127.0.0.1:57300/build/src/__test__/file-throw.js:9:13)\n// at doExec (http://127.0.0.1:3000/src/__test__/file-throw.js:452:38)\n// at postOrderExec (http://127.0.0.1:3000/src/__test__/file-throw.js:448:16)\n// at http://127.0.0.1:3000/src/__test__/file-throw.js:399:18`.replace(/(?:https?|ftp|file):\\/\\/(.*+)$/gm, (...args) => {\n//   debugger\n// })\nconst stringToStringWithLink = (\n  source,\n  {\n    transform = (url) => {\n      return {\n        href: url,\n        text: url,\n      }\n    },\n  } = {},\n) => {\n  return source.replace(/(?:https?|ftp|file):\\/\\/\\S+/gm, (match) => {\n    let linkHTML = \"\"\n\n    const lastChar = match[match.length - 1]\n\n    // hotfix because our url regex sucks a bit\n    const endsWithSeparationChar = lastChar === \")\" || lastChar === \":\"\n    if (endsWithSeparationChar) {\n      match = match.slice(0, -1)\n    }\n\n    const lineAndColumnPattern = /:([0-9]+):([0-9]+)$/\n    const lineAndColumMatch = match.match(lineAndColumnPattern)\n    if (lineAndColumMatch) {\n      const lineAndColumnString = lineAndColumMatch[0]\n      const lineNumber = lineAndColumMatch[1]\n      const columnNumber = lineAndColumMatch[2]\n      const url = match.slice(0, -lineAndColumnString.length)\n      const { href, text } = transform(url)\n      linkHTML = link({ href, text: `${text}:${lineNumber}:${columnNumber}` })\n    } else {\n      const linePattern = /:([0-9]+)$/\n      const lineMatch = match.match(linePattern)\n      if (lineMatch) {\n        const lineString = lineMatch[0]\n        const lineNumber = lineMatch[1]\n        const url = match.slice(0, -lineString.length)\n        const { href, text } = transform(url)\n        linkHTML = link({\n          href,\n          text: `${text}:${lineNumber}`,\n        })\n      } else {\n        const url = match\n        const { href, text } = transform(url)\n        linkHTML = link({ href, text })\n      }\n    }\n\n    if (endsWithSeparationChar) {\n      return `${linkHTML}${lastChar}`\n    }\n    return linkHTML\n  })\n}\n\nconst link = ({ href, text = href }) => `<a href=\"${href}\">${text}</a>`\n\nconst appendHMTLInside = (html, parentNode) => {\n  const temoraryParent = document.createElement(\"div\")\n  temoraryParent.innerHTML = html\n  return transferChildren(temoraryParent, parentNode)\n}\n\nconst transferChildren = (fromNode, toNode) => {\n  const childNodes = [].slice.call(fromNode.childNodes, 0)\n  let i = 0\n  while (i < childNodes.length) {\n    toNode.appendChild(childNodes[i])\n    i++\n  }\n  return () => {\n    let c = 0\n    while (c < childNodes.length) {\n      fromNode.appendChild(childNodes[c])\n      c++\n    }\n  }\n}\n",
    "const { Notification } = window\n\nconst displayErrorNotificationNotAvailable = () => {}\n\nconst displayErrorNotificationImplementation = (error, { icon } = {}) => {\n  if (Notification.permission === \"granted\") {\n    const notification = new Notification(\"An error occured\", {\n      lang: \"en\",\n      body: error ? error.stack : \"undefined\",\n      icon,\n    })\n    notification.onclick = () => {\n      window.focus()\n    }\n  }\n}\n\nexport const displayErrorNotification =\n  typeof Notification === \"function\"\n    ? displayErrorNotificationImplementation\n    : displayErrorNotificationNotAvailable\n",
    "import { fetchUrl } from \"@jsenv/core/src/internal/browser_utils/fetch_browser.js\"\nimport { fetchAndEval } from \"@jsenv/core/src/internal/browser_utils/fetch_and_eval.js\"\nimport { unevalException } from \"@jsenv/core/src/internal/runtime_client/uneval_exception.js\"\nimport { memoize } from \"@jsenv/core/src/internal/memoize.js\"\n\nimport { createBrowserClient } from \"./browser_client_factory.js\"\nimport { installBrowserErrorStackRemapping } from \"./browser_error_stack_remap.js\"\nimport { displayErrorInDocument } from \"./error_in_document.js\"\nimport { displayErrorNotification } from \"./error_in_notification.js\"\n\nconst getNavigationStartTime = () => {\n  try {\n    return window.performance.timing.navigationStart\n  } catch (e) {\n    return Date.now()\n  }\n}\n\nconst navigationStartTime = getNavigationStartTime()\n\nconst readyPromise = new Promise((resolve) => {\n  if (document.readyState === \"complete\") {\n    resolve()\n  } else {\n    const loadCallback = () => {\n      window.removeEventListener(\"load\", loadCallback)\n      resolve()\n    }\n    window.addEventListener(\"load\", loadCallback)\n  }\n})\n\nconst fileExecutionMap = {}\n\nconst executionResultPromise = readyPromise.then(async () => {\n  const fileExecutionResultMap = {}\n  const fileExecutionResultPromises = []\n  let status = \"completed\"\n  let exceptionSource = \"\"\n  Object.keys(fileExecutionMap).forEach((key) => {\n    fileExecutionResultMap[key] = null // to get always same order for Object.keys(executionResult)\n    const fileExecutionResultPromise = fileExecutionMap[key]\n    fileExecutionResultPromises.push(fileExecutionResultPromise)\n    fileExecutionResultPromise.then((fileExecutionResult) => {\n      fileExecutionResultMap[key] = fileExecutionResult\n      if (fileExecutionResult.status === \"errored\") {\n        status = \"errored\"\n        exceptionSource = fileExecutionResult.exceptionSource\n      }\n    })\n  })\n  await Promise.all(fileExecutionResultPromises)\n\n  return {\n    status,\n    ...(status === \"errored\" ? { exceptionSource } : {}),\n    startTime: navigationStartTime,\n    endTime: Date.now(),\n    fileExecutionResultMap,\n  }\n})\n\nconst executeFileUsingDynamicImport = async (\n  specifier,\n  identifier = specifier,\n) => {\n  const { currentScript } = document\n  const fileExecutionResultPromise = (async () => {\n    try {\n      const url = new URL(specifier, document.location.href).href\n      performance.mark(`jsenv_file_import_start`)\n      const namespace = await import(url)\n      performance.measure(`jsenv_file_import`, `jsenv_file_import_start`)\n      const executionResult = {\n        status: \"completed\",\n        namespace,\n        coverage: readCoverage(),\n      }\n      return executionResult\n    } catch (e) {\n      performance.measure(`jsenv_file_import`, `jsenv_file_import_start`)\n      const executionResult = {\n        status: \"errored\",\n        error: e,\n        coverage: readCoverage(),\n      }\n      onExecutionError(executionResult, { currentScript })\n      return executionResult\n    }\n  })()\n  fileExecutionMap[identifier] = fileExecutionResultPromise\n  return fileExecutionResultPromise\n}\n\nconst executeFileUsingSystemJs = (specifier) => {\n  // si on a dja importer ce fichier ??\n  // if (specifier in fileExecutionMap) {\n\n  // }\n\n  const { currentScript } = document\n\n  const fileExecutionResultPromise = (async () => {\n    const browserRuntime = await getBrowserRuntime()\n    const executionResult = await browserRuntime.executeFile(specifier, {\n      measurePerformance: true,\n      collectPerformance: true,\n    })\n    if (executionResult.status === \"errored\") {\n      onExecutionError(executionResult, { currentScript })\n    }\n    return executionResult\n  })()\n  fileExecutionMap[specifier] = fileExecutionResultPromise\n  return fileExecutionResultPromise\n}\n\nconst onExecutionError = (\n  executionResult,\n  {\n    currentScript,\n    errorExposureInConsole = true,\n    errorExposureInNotification = false,\n    errorExposureInDocument = true,\n  },\n) => {\n  const error = executionResult.error\n  if (error && error.code === \"NETWORK_FAILURE\") {\n    if (currentScript) {\n      const errorEvent = new Event(\"error\")\n      currentScript.dispatchEvent(errorEvent)\n    }\n  } else if (typeof error === \"object\") {\n    const { parsingError } = error\n    const globalErrorEvent = new Event(\"error\")\n    if (parsingError) {\n      globalErrorEvent.filename = parsingError.filename\n      globalErrorEvent.lineno = parsingError.lineNumber\n      globalErrorEvent.message = parsingError.message\n      globalErrorEvent.colno = parsingError.columnNumber\n    } else {\n      globalErrorEvent.filename = error.filename\n      globalErrorEvent.lineno = error.lineno\n      globalErrorEvent.message = error.message\n      globalErrorEvent.colno = error.columnno\n    }\n    window.dispatchEvent(globalErrorEvent)\n  }\n\n  if (errorExposureInConsole) {\n    console.error(error)\n  }\n  if (errorExposureInNotification) {\n    displayErrorNotification(error)\n  }\n  if (errorExposureInDocument) {\n    displayErrorInDocument(error)\n  }\n\n  executionResult.exceptionSource = unevalException(error)\n  delete executionResult.error\n}\n\nconst getBrowserRuntime = memoize(async () => {\n  const compileServerOrigin = document.location.origin\n  const compileServerResponse = await fetchUrl(\n    `${compileServerOrigin}/__jsenv_compile_profile__`,\n  )\n  const compileServerMeta = await compileServerResponse.json()\n  const { jsenvDirectoryRelativeUrl, errorStackRemapping } = compileServerMeta\n  const jsenvDirectoryServerUrl = `${compileServerOrigin}/${jsenvDirectoryRelativeUrl}`\n  const afterJsenvDirectory = document.location.href.slice(\n    jsenvDirectoryServerUrl.length,\n  )\n  const parts = afterJsenvDirectory.split(\"/\")\n  const compileId = parts[0]\n\n  const browserClient = await createBrowserClient({\n    compileServerOrigin,\n    jsenvDirectoryRelativeUrl,\n    compileId,\n  })\n\n  if (errorStackRemapping && Error.captureStackTrace) {\n    const { sourcemapMainFileRelativeUrl, sourcemapMappingFileRelativeUrl } =\n      compileServerMeta\n    await fetchAndEval(`${compileServerOrigin}/${sourcemapMainFileRelativeUrl}`)\n    const { SourceMapConsumer } = window.sourceMap\n    SourceMapConsumer.initialize({\n      \"lib/mappings.wasm\": `${compileServerOrigin}/${sourcemapMappingFileRelativeUrl}`,\n    })\n    const { getErrorOriginalStackString } = installBrowserErrorStackRemapping({\n      SourceMapConsumer,\n    })\n    const errorTransform = async (error) => {\n      // code can throw something else than an error\n      // in that case return it unchanged\n      if (!error || !(error instanceof Error)) return error\n      const originalStack = await getErrorOriginalStackString(error)\n      error.stack = originalStack\n      return error\n    }\n    const executeFile = browserClient.executeFile\n    browserClient.executeFile = (file, options = {}) => {\n      return executeFile(file, { errorTransform, ...options })\n    }\n  }\n  return browserClient\n})\n\nconst readCoverage = () => window.__coverage__\n\nwindow.__jsenv__ = {\n  executionResultPromise,\n  executeFileUsingDynamicImport,\n  executeFileUsingSystemJs,\n}\n"
  ],
  "names": [
    "fetchUsingXHR",
    "url",
    "signal",
    "method",
    "credentials",
    "headers",
    "body",
    "headersPromise",
    "createPromiseAndHooks",
    "bodyPromise",
    "xhr",
    "XMLHttpRequest",
    "failure",
    "error",
    "settled",
    "reject",
    "cleanup",
    "ontimeout",
    "onerror",
    "onload",
    "onreadystatechange",
    "Error",
    "createRequestError",
    "resolve",
    "addEventListener",
    "abort",
    "abortError",
    "name",
    "readyState",
    "open",
    "Object",
    "keys",
    "forEach",
    "key",
    "setRequestHeader",
    "withCredentials",
    "computeWithCredentials",
    "hasBlob",
    "responseType",
    "send",
    "responseUrl",
    "responseURL",
    "responseStatus",
    "status",
    "responseStatusText",
    "statusText",
    "responseHeaders",
    "getHeadersFromXHR",
    "readBody",
    "response",
    "responseText",
    "responseBody",
    "responseBodyType",
    "detectBodyType",
    "text",
    "blobToText",
    "arrayBufferToText",
    "buffer",
    "String",
    "json",
    "JSON",
    "parse",
    "blob",
    "Blob",
    "cloneBuffer",
    "arrayBuffer",
    "responseBlob",
    "blobToArrayBuffer",
    "formData",
    "hasFormData",
    "textToFormData",
    "canUseBlob",
    "window",
    "FileReader",
    "e",
    "FormData",
    "hasArrayBuffer",
    "ArrayBuffer",
    "hasSearchParams",
    "URLSearchParams",
    "stack",
    "promise",
    "Promise",
    "res",
    "rej",
    "value",
    "originSameAsGlobalOrigin",
    "location",
    "globalOrigin",
    "origin",
    "hrefToOrigin",
    "prototype",
    "isPrototypeOf",
    "isDataView",
    "isArrayBufferView",
    "headerMap",
    "headersString",
    "getAllResponseHeaders",
    "lines",
    "trim",
    "split",
    "line",
    "parts",
    "shift",
    "join",
    "toLowerCase",
    "href",
    "scheme",
    "hrefToScheme",
    "secondProtocolSlashIndex",
    "length",
    "pathnameSlashIndex",
    "indexOf",
    "slice",
    "colonIndex",
    "obj",
    "DataView",
    "isView",
    "viewClasses",
    "includes",
    "toString",
    "call",
    "form",
    "bytes",
    "replace",
    "append",
    "decodeURIComponent",
    "reader",
    "fileReaderReady",
    "readAsArrayBuffer",
    "readAsText",
    "view",
    "Uint8Array",
    "chars",
    "Array",
    "i",
    "fromCharCode",
    "result",
    "byteLength",
    "set",
    "fetchNative",
    "mode",
    "options",
    "fetch",
    "responseToHeaders",
    "fetchUrl",
    "AbortController",
    "createDetailedMessage",
    "message",
    "details",
    "string",
    "isArray",
    "fetchAndEval",
    "eval",
    "appendSourceURL",
    "code",
    "sourceURL",
    "isComposite",
    "type",
    "compositeWellKnownMap",
    "WeakMap",
    "primitiveWellKnownMap",
    "Map",
    "getCompositeGlobalPath",
    "get",
    "getPrimitiveGlobalPath",
    "visitGlobalObject",
    "visitValue",
    "path",
    "has",
    "visitProperty",
    "property",
    "descriptor",
    "getOwnPropertyDescriptor",
    "propertyValue",
    "getOwnPropertyNames",
    "getOwnPropertySymbols",
    "symbol",
    "global",
    "decompose",
    "mainValue",
    "functionAllowed",
    "prototypeStrict",
    "ignoreSymbols",
    "valueMap",
    "recipeArray",
    "valueToIdentifier",
    "existingIdentifier",
    "identifierForPrimitive",
    "undefined",
    "identifier",
    "identifierForNewValue",
    "primitiveToRecipe",
    "createPromiseAreNotSupportedMessage",
    "WeakSet",
    "createWeakSetAreNotSupportedMessage",
    "createWeakMapAreNotSupportedMessage",
    "createForbiddenFunctionMessage",
    "identifierForComposite",
    "compositeGlobalPath",
    "createGlobalReferenceRecipe",
    "propertyDescriptionArray",
    "propertyName",
    "propertyDescriptor",
    "propertyNameIdentifier",
    "propertyDescription",
    "computePropertyDescription",
    "push",
    "symbolDescriptionArray",
    "symbolIdentifier",
    "methodDescriptionArray",
    "computeMethodDescriptionArray",
    "extensible",
    "isExtensible",
    "createCompositeRecipe",
    "propertyNameOrSymbol",
    "createForbiddenPropertySetterMessage",
    "createForbiddenPropertyGetterMessage",
    "configurable",
    "writable",
    "enumerable",
    "getIdentifier",
    "setIdentifier",
    "valueIdentifier",
    "Set",
    "callArray",
    "entryValue",
    "index",
    "entryValueIdentifier",
    "methodNameIdentifier",
    "entryKey",
    "entryKeyIdentifier",
    "find",
    "existingValue",
    "is",
    "nextIdentifier",
    "currentIdentifier",
    "parseInt",
    "mainIdentifier",
    "prototypeValueToIdentifier",
    "prototypeValue",
    "prototypeExistingIdentifier",
    "prototypeIdentifier",
    "prototypeGlobalPath",
    "createUnknownPrototypeMessage",
    "getPrototypeOf",
    "identifierForValueOf",
    "valueOf",
    "valueOfReturnValue",
    "createUnexpectedValueOfReturnValueMessage",
    "recipe",
    "valueOfIdentifier",
    "RegExp",
    "symbolToRecipe",
    "createPimitiveRecipe",
    "globalSymbolKey",
    "Symbol",
    "keyFor",
    "createGlobalSymbolRecipe",
    "symbolGlobalPath",
    "createUnknownSymbolMessage",
    "constructor",
    "sortRecipe",
    "findInRecipePrototypeChain",
    "callback",
    "currentRecipe",
    "recipeArrayOrdered",
    "sort",
    "leftRecipe",
    "rightRecipe",
    "leftType",
    "rightType",
    "rightRecipeIsInLeftRecipePrototypeChain",
    "recipeCandidate",
    "leftRecipeIsInRightRecipePrototypeChain",
    "leftIndex",
    "rightIndex",
    "escapeString",
    "j",
    "escapedString",
    "char",
    "escapedChar",
    "uneval",
    "recipeArraySorted",
    "source",
    "variableNameMap",
    "indexSorted",
    "identifierToVariableName",
    "recipeToSetupSource",
    "primitiveRecipeToSetupSource",
    "globalSymbolRecipeToSetupSource",
    "globalReferenceRecipeToSetupSource",
    "compositeRecipeToSetupSource",
    "pathSource",
    "map",
    "part",
    "prototypeConstructor",
    "recipeVariableName",
    "recipeToMutateSource",
    "compositeRecipeToMutateSource",
    "mutateSource",
    "generateDefinePropertySource",
    "generateMethodCallSource",
    "generatePreventExtensionSource",
    "propertyNameOrSymbolIdentifier",
    "propertyOrSymbolVariableName",
    "propertyDescriptorSource",
    "generatePropertyDescriptorSource",
    "methodCallSource",
    "methodVariableName",
    "argumentIdentifiers",
    "argumentVariableNames",
    "argumentIdentifier",
    "unevalException",
    "hasOwnProperty",
    "memoize",
    "compute",
    "memoized",
    "memoizedValue",
    "fnWithMemoization",
    "args",
    "forget",
    "assertImportMap",
    "TypeError",
    "hasScheme",
    "test",
    "urlToScheme",
    "urlString",
    "urlToPathname",
    "ressourceToPathname",
    "urlToRessource",
    "afterProtocol",
    "ressource",
    "searchSeparatorIndex",
    "urlToOrigin",
    "pathnameToParentPathname",
    "pathname",
    "slashLastIndex",
    "lastIndexOf",
    "resolveUrl",
    "specifier",
    "baseUrl",
    "writeBaseUrlMustBeAString",
    "writeBaseUrlMustBeAbsolute",
    "writeBaseUrlRequired",
    "baseOrigin",
    "basePathname",
    "baseDirectoryPathname",
    "unresolvedPathname",
    "importerFolders",
    "pop",
    "resolvedPathname",
    "tryUrlResolution",
    "resolveSpecifier",
    "importer",
    "startsWith",
    "sortImports",
    "imports",
    "mappingsSorted",
    "compareLengthOrLocaleCompare",
    "sortScopes",
    "scopes",
    "scopesSorted",
    "scopeSpecifier",
    "a",
    "b",
    "localeCompare",
    "normalizeImportMap",
    "importMap",
    "isStringOrUrl",
    "formulateBaseUrlMustBeStringOrUrl",
    "normalizeMappings",
    "normalizeScopes",
    "URL",
    "mappings",
    "mappingsNormalized",
    "address",
    "console",
    "warn",
    "formulateAddressMustBeAString",
    "specifierResolved",
    "addressUrl",
    "formulateAdressResolutionFailed",
    "endsWith",
    "formulateAddressUrlRequiresTrailingSlash",
    "scopesNormalized",
    "scopeMappings",
    "scopeUrl",
    "formulateScopeResolutionFailed",
    "scope",
    "scopeValueNormalized",
    "addressURL",
    "pathnameToExtension",
    "dotLastIndex",
    "applyImportMap",
    "createBareSpecifierError",
    "onImportMapping",
    "specifierUrl",
    "specifierNormalized",
    "scopeSpecifierMatching",
    "specifierIsPrefixOf",
    "mappingFromScopes",
    "applyMappings",
    "mappingFromImports",
    "specifierCandidates",
    "specifierCandidate",
    "from",
    "to",
    "before",
    "after",
    "afterSpecifier",
    "addressFinal",
    "specifierHref",
    "resolveImport",
    "defaultExtension",
    "applyDefaultExtension",
    "extension",
    "importerPathname",
    "importerExtension",
    "getJavaScriptModuleResponseError",
    "importerUrl",
    "compileServerOrigin",
    "compileDirectoryRelativeUrl",
    "jsonContentTypeAccepted",
    "getModuleDetails",
    "notFound",
    "contentType",
    "bodyAsJson",
    "filename",
    "parsingError",
    "suggestion",
    "relativeUrl",
    "tryToFindProjectRelativeUrl",
    "importerRelativeUrl",
    "file",
    "afterOrigin",
    "afterCompileDirectory",
    "urlToExtension",
    "fakeUrl",
    "specifierExtension",
    "createImportResolverForImportmap",
    "importMapUrl",
    "importDefaultExtension",
    "onBareSpecifierError",
    "_resolveImport",
    "bareSpecifierError",
    "detailedMessage",
    "errMsg",
    "errCode",
    "msg",
    "hasSymbol",
    "hasSelf",
    "self",
    "hasDocument",
    "document",
    "envGlobal",
    "baseEl",
    "querySelector",
    "lastSepIndex",
    "backslashRegEx",
    "resolveIfNotPlainOrUrl",
    "relUrl",
    "parentUrl",
    "parentProtocol",
    "segmented",
    "output",
    "segmentIndex",
    "resolveAndComposePackages",
    "packages",
    "outPackages",
    "parentMap",
    "p",
    "resolvedLhs",
    "rhs",
    "mapped",
    "resolveImportMap",
    "targetWarning",
    "resolveAndComposeImportMap",
    "outMap",
    "u",
    "resolvedScope",
    "depcache",
    "integrity",
    "getMatch",
    "matchObj",
    "sepIndex",
    "segment",
    "applyPackages",
    "id",
    "pkgName",
    "pkg",
    "match",
    "target",
    "resolvedOrPlain",
    "packageResolution",
    "toStringTag",
    "REGISTRY",
    "SystemJS",
    "systemJSPrototype",
    "import",
    "loader",
    "prepareImport",
    "then",
    "load",
    "getOrCreateLoad",
    "C",
    "topLevelLoad",
    "createContext",
    "parentId",
    "lastRegister",
    "register",
    "deps",
    "declare",
    "getRegister",
    "_lastRegister",
    "firstParentUrl",
    "importerSetters",
    "ns",
    "create",
    "defineProperty",
    "instantiatePromise",
    "instantiate",
    "registration",
    "_export",
    "h",
    "changed",
    "__esModule",
    "setter",
    "declared",
    "importId",
    "meta",
    "execute",
    "setters",
    "err",
    "er",
    "linkPromise",
    "instantiation",
    "all",
    "dep",
    "depId",
    "depLoad",
    "I",
    "n",
    "depLoads",
    "d",
    "L",
    "E",
    "instantiateAll",
    "parent",
    "loaded",
    "catch",
    "postOrderExec",
    "nullContext",
    "freeze",
    "seen",
    "depLoadPromises",
    "depLoadPromise",
    "doExec",
    "execPromise",
    "System",
    "importMapPromise",
    "processFirst",
    "doProcessScripts",
    "processScripts",
    "querySelectorAll",
    "script",
    "sp",
    "src",
    "event",
    "createEvent",
    "initEvent",
    "dispatchEvent",
    "fetchPromise",
    "ok",
    "innerHTML",
    "extendImportMap",
    "newMapText",
    "newMapUrl",
    "newMap",
    "evt",
    "lastWindowErrorUrl",
    "lastWindowError",
    "createScript",
    "createElement",
    "async",
    "crossOrigin",
    "lastAutoImportDeps",
    "lastAutoImportTimeout",
    "autoImportCandidates",
    "systemRegister",
    "inlineScriptCount",
    "autoUrl",
    "scripts",
    "lastScript",
    "lastAutoImportUrl",
    "setTimeout",
    "autoImportRegistration",
    "head",
    "removeChild",
    "clearTimeout",
    "appendChild",
    "shouldFetch",
    "jsContentTypeRegEx",
    "apply",
    "arguments",
    "throwUnresolved",
    "systemInstantiate",
    "preloads",
    "importScripts",
    "registerRegistry",
    "define",
    "WorkerGlobalScope",
    "importMapFromParentPromise",
    "importmapMessageCallback",
    "data",
    "removeEventListener",
    "ports",
    "onmessage",
    "postMessage",
    "importmap",
    "stringify",
    "messageEvents",
    "messageCallback",
    "messageEvent",
    "WorkerConstructor",
    "Worker",
    "worker",
    "importmapChannel",
    "MessageChannel",
    "port1",
    "port2",
    "serviceWorker",
    "navigator",
    "registrationPromise",
    "installing",
    "waiting",
    "active",
    "createBrowserSystem",
    "importResolver",
    "fetchSource",
    "browserSystem",
    "importType",
    "urlWithoutImportType",
    "extractImportTypeFromUrl",
    "jsonModule",
    "instantiateAsJsonModule",
    "cssModule",
    "instantiateAsCssModule",
    "vendor",
    "jsenvError",
    "createDetailedInstantiateError",
    "instantiateError",
    "urlObject",
    "search",
    "searchParams",
    "delete",
    "contentTypeExpected",
    "reloadMetas",
    "__jsenv_event_source_client__",
    "cssText",
    "cssTextWithBaseUrl",
    "cssWithBaseUrl",
    "cssUrl",
    "sheet",
    "CSSStyleSheet",
    "replaceSync",
    "cssDirectoryUrl",
    "baseDirectoryUrl",
    "cssTextRelocated",
    "quotes",
    "relUrl1",
    "relUrl2",
    "absoluteUrl",
    "jsModuleResponseError",
    "performance",
    "measureAsyncFnPerf",
    "fn",
    "perfMarkStartName",
    "mark",
    "measure",
    "makeModuleNamespaceTransferable",
    "namespace",
    "transferableNamespace",
    "isTransferable",
    "hideNonTransferableValue",
    "seenArray",
    "visit",
    "constructorName",
    "supportedTypes",
    "maybe",
    "maybeTypes",
    "visited",
    "every",
    "values",
    "memoizedCreateBrowserSystem",
    "createBrowserClient",
    "jsenvDirectoryRelativeUrl",
    "compileId",
    "fetchJson",
    "compileServerMetaUrl",
    "importmapScript",
    "importmapRaw",
    "importmapFileResponse",
    "textContent",
    "importFile",
    "executeFile",
    "executionExposureOnWindow",
    "errorTransform",
    "measurePerformance",
    "importUsingSystemJs",
    "coverage",
    "readCoverage",
    "transformedError",
    "executionResult",
    "__executionResult__",
    "__coverage__",
    "DataUrl",
    "as",
    "afterDataProtocol",
    "commaIndex",
    "beforeComma",
    "mediaType",
    "base64Flag",
    "afterComma",
    "base64ToString",
    "dataToBase64",
    "atob",
    "Buffer",
    "btoa",
    "base64String",
    "getJavaScriptSourceMappingUrl",
    "javaScriptSource",
    "sourceMappingUrl",
    "replaceSourceMappingUrl",
    "javascriptSourceMappingUrlCommentRegexp",
    "regexp",
    "lastSourceMappingUrl",
    "matchSourceMappingUrl",
    "exec",
    "mappedAfter",
    "firstGroup",
    "startsWithWindowsDriveLetter",
    "firstChar",
    "secondChar",
    "windowsFilePathToUrl",
    "windowsFilePath",
    "replaceBackSlashesWithSlashes",
    "remapCallSite",
    "callSite",
    "urlToSourcemapConsumer",
    "resolveFile",
    "readErrorStack",
    "onFailure",
    "isNative",
    "getFileName",
    "getScriptNameOrSourceURL",
    "getLineNumber",
    "column",
    "getColumnNumber",
    "originalPosition",
    "remapSourcePosition",
    "callSiteClone",
    "cloneCallSite",
    "getFunctionName",
    "isEval",
    "getEvalOrigin",
    "originalEvalOrigin",
    "remapEvalOrigin",
    "methods",
    "callSiteToFunctionCall",
    "fileLocation",
    "callSiteToFileLocation",
    "isConstructor",
    "isMethodCall",
    "isToplevel",
    "callSiteToMethodCall",
    "functionName",
    "typeName",
    "callSiteToType",
    "methodName",
    "getMethodName",
    "generateAs",
    "getTypeName",
    "sourceFile",
    "callSiteToSourceFile",
    "lineNumber",
    "columnNumber",
    "fileName",
    "topLevelEvalMatch",
    "Number",
    "nestedEvalMatch",
    "position",
    "sourceToUrl",
    "sourceMapConsumer",
    "originalPositionFor",
    "originalSource",
    "startsWithScheme",
    "remapStack",
    "fetchFile",
    "SourceMapConsumer",
    "memoizeByFirstArgStringValue",
    "stackTraceFileUrl",
    "fileResponse",
    "jsSourcemapUrl",
    "sourcemapUrl",
    "sourcemapString",
    "sourcemapResponse",
    "sourceMap",
    "sourcesContent",
    "firstSourceMapSourceFailure",
    "sources",
    "sourcemapSourceUrl",
    "sourceResponse",
    "sourceString",
    "originalCallsites",
    "stringValueCache",
    "firstArgValue",
    "stringifyStack",
    "indent",
    "stackString",
    "installErrorStackRemapping",
    "errorRemappingCache",
    "errorRemapFailureCallbackMap",
    "installed",
    "previousPrepareStackTrace",
    "prepareStackTrace",
    "install",
    "uninstall",
    "failureData",
    "failureCallbackArray",
    "stackRemappingPromise",
    "memoizeFetch",
    "getErrorOriginalStackString",
    "remapFailureCallbackArray",
    "firstCall",
    "assign",
    "lineno",
    "columnno",
    "urlCache",
    "responsePromise",
    "installBrowserErrorStackRemapping",
    "bind",
    "displayErrorInDocument",
    "title",
    "theme",
    "errorToHTML",
    "messageHTML",
    "escapeHtml",
    "css",
    "html",
    "removeJsenvConsole",
    "appendHMTLInside",
    "onclick",
    "captureStackTrace",
    "htmlWithCorrectLineBreaks",
    "htmlWithLinks",
    "stringToStringWithLink",
    "transform",
    "linkHTML",
    "lastChar",
    "endsWithSeparationChar",
    "lineAndColumnPattern",
    "lineAndColumMatch",
    "lineAndColumnString",
    "link",
    "linePattern",
    "lineMatch",
    "lineString",
    "parentNode",
    "temoraryParent",
    "transferChildren",
    "fromNode",
    "toNode",
    "childNodes",
    "c",
    "Notification",
    "displayErrorNotificationNotAvailable",
    "displayErrorNotificationImplementation",
    "icon",
    "permission",
    "notification",
    "lang",
    "focus",
    "displayErrorNotification",
    "getNavigationStartTime",
    "timing",
    "navigationStart",
    "Date",
    "now",
    "navigationStartTime",
    "readyPromise",
    "loadCallback",
    "fileExecutionMap",
    "executionResultPromise",
    "fileExecutionResultMap",
    "fileExecutionResultPromises",
    "exceptionSource",
    "fileExecutionResultPromise",
    "fileExecutionResult",
    "startTime",
    "endTime",
    "executeFileUsingDynamicImport",
    "currentScript",
    "onExecutionError",
    "executeFileUsingSystemJs",
    "browserRuntime",
    "getBrowserRuntime",
    "collectPerformance",
    "errorExposureInConsole",
    "errorExposureInNotification",
    "errorExposureInDocument",
    "errorEvent",
    "Event",
    "globalErrorEvent",
    "colno",
    "compileServerResponse",
    "compileServerMeta",
    "errorStackRemapping",
    "jsenvDirectoryServerUrl",
    "afterJsenvDirectory",
    "browserClient",
    "sourcemapMainFileRelativeUrl",
    "sourcemapMappingFileRelativeUrl",
    "initialize",
    "originalStack",
    "__jsenv__"
  ],
  "mappings": "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"
}